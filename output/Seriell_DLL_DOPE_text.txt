

--- Page 1 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 1 of 145DoPE
Measuring and Controlling with DOLI Components
DOLI Elektronik GmbH  ß Fraunhoferstraße 23h ß D-80469 Munich/Germany ß http://www.doli.de
Tel:++49-89-20243-0  ß  Fax:++49-89-20243-243  ß  eMail:info@doli.deDoPE
Documentation
DoPE DLLApplication program
DPX safe protocol for RS232
DPX safe protocol for RS232
DOLI Sub System for Data acqusition and
closed loop control for testing instrumentsF
      Fmax
                          ½P3           Fb
       P2¾
           En erg ie
      P1¾          dL Fmax       dL Fb
ON
TESTSTOP78 9
456
1230 ,+/-
F2 F3 F1
EDC120
DDA 04 / 05 / 06power amplifier
or
„any“ power amplifier

--- Page 2 ---

Page 2 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
Contents
1 OVERVIEW ...................................................................................................................... .......................................... 7
1.1 Tasks of DoPE ............................................................................................................... ..............8
1.2 Initialising ................................................................................................................ ....................8
1.3 Supported programming languages ............................................................................................. 9
1.3.1 Special considerations for VB-Programmer .................................................................................. ................. 9
1.4 Sample programs to initialise DoPE.......................................................................................... ..9
1.4.1 „C“ Program ............................................................................................................... ................................... 9
1.4.2 „VB“ Program.............................................................................................................. .................................. 9
1.4.3 „Delphi“ Program.......................................................................................................... .............................. 10
2 COMMUNICATION  PRICIPLES....................................................................................................... ................... 11
2.1 Open a connection ........................................................................................................... ..........11
2.2 Establishing a connection w ith call-back function ....................................................................11
2.3 Establishing a connection us ing Windows message passing.....................................................12
2.4 Transaction Number.......................................................................................................... .........13
2.5 Synchronous / Asynchronous DoPE Commands.......................................................................13
2.6 Messages from DoPE to the application program .....................................................................14
3 OVERVIEW OF ALL DOPE COMMANDS ................................................................................................. ........ 15
3.1 Initialisation Commands ..................................................................................................... .......15
3.2 Setup Commands .............................................................................................................. .........15
3.3 Message and Data handling ................................................................................................... ....18
3.4 Configuration Commands...................................................................................................... ....19
3.5 Input / Output-Commands ..................................................................................................... ....24
3.6 Movement commands........................................................................................................... .....26
3.7 Complex moving commands ..................................................................................................... 31
3.8 Miscellaneous Control Commands............................................................................................33
3.9 Sensor EEPROM Handling ...................................................................................................... .34
3.10 DoPEOpenLink............................................................................................................... .......35
3.11 DoPECloseLink .............................................................................................................. .......35
3.12 DoPESetNotification ........................................................................................................ .....36
3.13 DoPEInitialize............................................................................................................. ...........37
4 SETUP COMMANDS................................................................................................................ ............................... 38
4.1 DoPEOpenSetup(Sync) ......................................................................................................... ....38
4.2 DoPECloseSetup(Sync) ........................................................................................................ .....38
4.3 DoPESetupScale .............................................................................................................. ..........38
4.4 DoPERdSetupAll(Sync) ........................................................................................................ ....39
4.5 DoPEWrSetupAll(Sync)........................................................................................................ ....39
4.6 DoPERdSetupNumber ........................................................................................................... ....40
4.7 DoPERdSensorDef ............................................................................................................. .......40
4.8 DoPEWrSensorDef(Sync) ....................................................................................................... ..40
4.9 DoPERdCtrlSensorDef ......................................................................................................... .....41
4.10 DoPEWrCtrlSensorDef(Sync) ...............................................................................................41
4.11 DoPERdOutChannelDef........................................................................................................ 42
4.12 DoPEWrOutChannelDef(Sync).............................................................................................42
4.13 DoPERdBitInDef ............................................................................................................. ......42
4.14 DoPEWrBitInDef(Sync)....................................................................................................... .43
4.15 DoPERdBitOutDef ............................................................................................................ ....43
4.16 DoPEWrBitOutDef(Sync) .....................................................................................................4 3

--- Page 3 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 3 of 145DoPE
4.17 DoPERdMachineDef ........................................................................................................... ..44
4.18 DoPEWrMachineDef(Sync) ..................................................................................................44
4.19 DoPERdLinTbl ............................................................................................................... .......45
4.20 DoPEWrLinTbl(Sync) ......................................................................................................... ..45
4.21 DoPERdGeneralData .......................................................................................................... ...46
4.22 DoPEWrGeneralData(Sync)..................................................................................................46
4.23 DoPESelSetup............................................................................................................... .........47
4.24 DoPERdSensorInfo........................................................................................................... .....47
4.25 DoPERdSysUserData .......................................................................................................... ..48
4.26 DoPEWrSysUserData(Sync) .................................................................................................48
4.27 DoPERdSenUserData .......................................................................................................... ..49
4.28 DoPEWrSenUserData(Sync) .................................................................................................49
4.29 DoPERdSensorUserData ....................................................................................................... 49
4.30 DoPEWrSensorUserData....................................................................................................... 50
5 MESSAGE AND DATA HANDLING..................................................................................................... ................ 51
5.1 DoPESendMsg(Sync) ........................................................................................................... .....51
5.2 DoPEGetMsg .................................................................................................................. ...........51
5.2.1 Command error messages.................................................................................................... ......................... 52
5.2.2 Run-time error messages................................................................................................... ............................ 53
5.2.3 Movement control messages ................................................................................................. ........................ 54
5.2.4 Sensor message (o nly serial sensors)...................................................................................... ...................... 56
5.3 DoPEGetData................................................................................................................. ............57
5.4 DoPECurrentData ............................................................................................................. .........58
5.5 DoPEClearReceiver ........................................................................................................... ........58
5.6 DoPEClearTransmitter........................................................................................................ .......58
5.7 DoPEGetState ................................................................................................................ ............58
5.8 DoPEGetErrors ............................................................................................................... ...........59
6 CONFIGURATION ................................................................................................................. ................................. 60
6.1 DoPERdVersion............................................................................................................... ..........60
6.2 Data Acquisition commands................................................................................................... ...60
6.2.1 DoPERe fr(Sync)............................................................................................................ ................................ 60
6.2.2 DoPESetTime(Sync)......................................................................................................... ............................. 60
6.2.3 DoPETransmitData(Sync) .................................................................................................... ........................ 61
6.2.4 DoPEIntgr(Sync)........................................................................................................... ................................ 61
6.2.5 DoPECtrlT estVal ues........................................................................................................ ............................. 62
6.3 Safety Shield ............................................................................................................... ...............62
6.3.1 DoPEShiel dLimit(Sync) ..................................................................................................... ........................... 65
6.3.2 DoPEShieldD isable(Sync) ................................................................................................... ......................... 65
6.3.3 DoPEShieldLock(Sync)...................................................................................................... ........................... 66
6.4 Channel supervision......................................................................................................... ..........66
6.4.1 DoPESet Check(Sync)........................................................................................................ ............................ 66
6.4.2 DoPESet CheckX(Sync) ....................................................................................................... .......................... 66
6.4.3 DoPEClr Check(Sync) ........................................................................................................ ........................... 67
6.4.4 DoPESetCh eckLimit(Sync) ................................................................................................... ........................ 68
6.4.5 DoPEClrCh eckLimit(Sync)................................................................................................... ........................ 68
6.5 Controller Parameter........................................................................................................ ..........69
6.5.1 DoPEPosPID (Sync) ......................................................................................................... ............................ 69
6.5.2 DoPESpeedPID(Sync)........................................................................................................ ........................... 69
6.5.3 DoPEPosFeedForward(Sync).................................................................................................. ..................... 70
6.5.4 DoPEDestWnd(Sync) ......................................................................................................... ........................... 71
6.5.5 DoPESft(Sync) ............................................................................................................. ................................. 72
6.5.6 DoPECtrlE rror(Sync) ....................................................................................................... ............................ 73
6.5.7 DoPESetD ither (Sync) ...................................................................................................... ............................ 73
6.5.8 DoPECtrlSpeed TimeBase(Sync) ............................................................................................... .................... 74
6.6 Calibration ................................................................................................................. ................74

--- Page 4 ---

Page 4 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
6.6.1 DoPEZeroCal(Sync) ......................................................................................................... ............................ 74
6.6.2 DoPECal(Sync)............................................................................................................. ................................ 74
6.7 Tare functions .............................................................................................................. ..............76
6.7.1 DoPESetBasicTare(Sync) .................................................................................................... ......................... 76
6.7.2 DoPESetTare ............................................................................................................... ................................. 76
6.7.3 DoPEGetBasicTare.......................................................................................................... ............................. 77
6.7.4 DoPEGetTare ............................................................................................................... ................................ 77
6.8 Calculated measuring channels............................................................................................... ...78
6.8.1 DoPEConfC McSpeed(Sync).................................................................................................... ...................... 79
6.8.2 DoPEConfCMcCom mandSpeed(Sync) ............................................................................................. ............ 79
6.8.3 DoPEConfCMcGradient(Sync)................................................................................................. .................... 80
6.8.4 DoPEClear CMc(Sync)........................................................................................................ .......................... 80
6.8.5 DoPEMc2Ou tput(S ync)....................................................................................................... .......................... 81
6.8.6 DoPEConfPeakValue(Sync)................................................................................................... ....................... 82
6.8.7 DoPEPeakValu eTime(Sync) ................................................................................................... ...................... 82
6.9 Reference signal handling of incremental sensors.....................................................................83
6.9.1 DoPESetRefSignalMode ...................................................................................................... ......................... 83
6.9.2 DoPESetRe fSignalTare...................................................................................................... ........................... 84
6.10 Serial Sensors............................................................................................................. ............84
6.10.1 DoPEWrSensorMsg (Sync) ................................................................................................... ........................ 84
7 INPUT / OUTP UT-CO MMANDS ....................................................................................................... .................... 85
7.1 Analogue output............................................................................................................. ............85
7.1.1 DoPESetOutput(Sync)....................................................................................................... ............................ 85
7.1.2 DoPESetOutChann elOffset (Sync)............................................................................................ .................... 85
7.1.3 DoPEOfflineActio nOutput (Sync) ............................................................................................ ..................... 85
7.2 Bit I/O-Commands............................................................................................................ .........87
7.2.1 DoPESetB(Sync) ............................................................................................................ ............................... 87
7.2.2 DoPECalOut(Sync).......................................................................................................... ............................. 87
7.2.3 DoPEBe ep(Sync)............................................................................................................ ............................... 88
7.2.4 DoPELed(Sync)............................................................................................................. ................................ 88
7.2.5 DoPEUniOut(Sync).......................................................................................................... ............................. 88
7.2.6 DoPEBypass(Sync) .......................................................................................................... ............................. 89
7.2.7 DoPERdBitInput ............................................................................................................ ............................... 89
7.2.8 DoPEWrBitO utput(Sync) ..................................................................................................... ......................... 89
7.2.9 DoPEOfflineActio nBitOutput (Sync)......................................................................................... .................... 90
7.3 Display Commands............................................................................................................ ........91
7.3.1 DoPEDspClear(Sync) ........................................................................................................ ........................... 91
7.3.2 DoPEDspHeadLine(Sync)..................................................................................................... ........................ 91
7.3.3 DoPEDspFKeys(Sync) ........................................................................................................ .......................... 92
7.3.4 DoPEDspMValue(Sync)....................................................................................................... ......................... 92
7.3.5 DoPEDspBeamScreen(Sync) ................................................................................................... ..................... 92
7.3.6 DoPEDspBeam Value(Sync)................................................................................................... ...................... 93
8 MOVEMENT COMMANDS ............................................................................................................. ...................... 94
8.1 Halt commands ............................................................................................................... ...........94
8.1.1 DoPEHalt(Sync)............................................................................................................ ................................ 94
8.1.2 DoPEHalt_A(Sync) .......................................................................................................... ............................. 96
8.1.3 DoPEHaltW(Sync) ........................................................................................................... ............................. 96
8.1.4 DoPEHaltW_A(Sync)......................................................................................................... ........................... 97
8.1.5 DoPESHa lt(Sync)........................................................................................................... ............................... 97
8.2 Simple position commands.................................................................................................... ....98
8.2.1 DoPEPos(Sync)............................................................................................................. ................................ 98
8.2.2 DoPEPos_A(Sync) ........................................................................................................... ............................. 99
8.3 Approach of an external  destination position ..........................................................................100
8.3.1 DoPEPosG1(Sync)........................................................................................................... ........................... 100
8.3.2 DoPEPosG1_A(Sync) ......................................................................................................... ........................ 101
8.3.3 DoPEPosD1(Sync)........................................................................................................... ........................... 102
8.3.4 DoPEPosD1_A(Sync) ......................................................................................................... ........................ 103
8.4 Positioning to an external destination position ........................................................................104

--- Page 5 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 5 of 145DoPE
8.4.1 DoPEPosG2(Sync)........................................................................................................... ........................... 104
8.4.2 DoPEPosG2_A(Sync) ......................................................................................................... ........................ 105
8.4.3 DoPEPosD2(Sync)........................................................................................................... ........................... 106
8.4.4 DoPEPosD2_A(Sync) ......................................................................................................... ........................ 107
8.5 General position command to a ex ternal destination position.................................................108
8.5.1 DoPEPosExt(Sync) .......................................................................................................... ........................... 109
8.5.2 DoPEPosExt_A(Sync)........................................................................................................ ......................... 110
8.5.3 DoPEFMove(Sync) ........................................................................................................... .......................... 111
8.5.4 DoPEXpCont(Sync) .......................................................................................................... .......................... 111
8.6 Trigger ..................................................................................................................... ................112
8.6.1 DoPETrig(Sync)............................................................................................................ .............................. 112
8.6.2 DoPETrig_A(Sync) .......................................................................................................... ........................... 113
8.7 Combined movement commands.............................................................................................114
8.7.1 DoPEStartCMD(Sync) ........................................................................................................ ........................ 114
8.7.2 DoPEEndCMD(Sync) .......................................................................................................... ....................... 114
9 COMPLEX MOVI NG CO MMANDS ....................................................................................................... ............ 115
9.1 DoPEExt2Ctrl(Sync) .......................................................................................................... .....115
9.2 DoPEFDPoti(Sync)............................................................................................................ ......116
9.3 DoPECycle(Sync)............................................................................................................. .......117
9.4 DoPECosine(Sync) ............................................................................................................ ......118
9.5 DoPECosineX(Sync) ........................................................................................................... ....119
9.6 DoPECosineV(Sync) ........................................................................................................... ....119
9.7 DoPETriangle(Sync).......................................................................................................... ......121
9.8 DoPERectangle(Sync) ......................................................................................................... ....122
9.9 DoPEOffsC(Sync) ............................................................................................................. ......123
10 SYNCHRONIZED MOVEMENT ........................................................................................................ ................. 124
10.1 DoPESynchronizeSystemMode (Sync) ...............................................................................124
10.2 DoPESynchronizeSystemStart (Sync).................................................................................126
11 MISCELLANEOUS CO NTROL CO MMANDS............................................................................................... ... 127
11.1 DoPEOn(Sync) ............................................................................................................... .....127
11.2 DoPEDefaultAcc(Sync)....................................................................................................... 127
11.3 DoPESpeedLimit(Sync)....................................................................................................... 127
11.4 DoPEStop(Sync)............................................................................................................. .....128
11.5 DoPEEmergencyMove(Sync)..............................................................................................128
11.6 DoPEEmergencyOff(Sync)..................................................................................................128
11.7 DoPESetOpenLoopCommand(Sync) ..................................................................................129
12 SENSOR EEPROM HANDLING....................................................................................................... ................... 130
12.1 DoPERdSensorConKey .......................................................................................................13 0
12.2 DoPERdSensorHeaderData .................................................................................................131
12.3 DoPERdSensorAnalogueData .............................................................................................132
12.4 DoPEWrSensorAnalogueData.............................................................................................132
12.5 DoPERdSensorIncData........................................................................................................ 133
12.6 DoPEWrSensorIncData .......................................................................................................1 33
12.7 DoPERdSensorAbsData ......................................................................................................13 4
12.8 DoPEWrSensorAbsData......................................................................................................13 4
13 DEFAULT MEASURING DADA RECORD ................................................................................................ ....... 135
13.1 Logical input signals...................................................................................................... ......136
13.2 Logical output signals..................................................................................................... .....137
13.3 Controller status WORD 1................................................................................................... 138
13.4 Controller status WORD 2................................................................................................... 139

--- Page 6 ---

Page 6 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
13.5 Definitions of EDC-front panel keys ...................................................................................140
14 DOPE ERROR CONSTANTS ......................................................................................................... ...................... 141
15 CHANGES VERSION 1 Æ 2 ............................................................................................................................. .... 142
16 IMPORTANT CHANGES TO VERSION 2.21, 2.22...................................................................................... ..... 144
17 IMPORTANT CHANGES TO VERSION 2.23, 2.24...................................................................................... ..... 145

--- Page 7 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 7 of 145DoPE
1 Overview
DOLI has a very powerful software for data acquisiti on and closed loop control for testing instruments
like tensile testers. This software runs on a hardware platform from DOLI like EDC5/25, EDC100,
EDC60, EDC120 and others. It is conf igurable within a wide range to  satisfy all tasks at a testing
instrument. Normally the system communicates wi th a PC via a serial RS232 connection. We use a
safe protocol called DPX on this serial line to  transmit commands and data in both directions.
DoPE represents the interface to access all EDC-functions from  any standard PC under Windows .
DoPE enables a PC-Programmer to receive measured values from a testing instrument and control it
after a few hours.
DoPE DLLApplication program
DPX safe protocol for RS232
DPX safe protocol for RS232
DOLI Sub System for Data acqusition and
closed loop control for testing instrumentsF
      Fmax
                          ½P3           Fb
       P2¾
           En erg ie
      P1¾          dL Fmax       dL Fb
ON
TESTSTOP78 9
456
1230 ,+/-
F2 F3 F1
EDC120
DDA 04 / 05 / 06power amplifier
or
„any“ power amplifier

--- Page 8 ---

Page 8 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
1.1 Tasks of DoPE
• DoPE will initialise the Subsystem according to predefined set-up data.
• DoPE gives the application program meas uring data in SI-units (N, m etc.)
• DoPE offers a wide range of machine control commands
Simple commands like:
„move Up in position control with 0.01 m/sec“Complex commands like:„move in position control with 0.02 m/sec to 500 N and keep 500 N in load control“Cycling commands like:„do 100 sinusoidal load cycles with an amplitude of 100N with 3 Hz“
• DoPE reports events like limit switch etc.
DoPE is available as a 32 Bit DLL for Windows 95/98/2000 and Windows NT.
DoPE uses the „DOLI Subsystem for test machine control“. Please use th e documentation of this
software for more detailed information’s
1.2 Initialising
The Subsystem software is able to handle up to:
• sixteen logical measuring channels
• sixteen logical anal ogue output channels
• ten logical Bit input devices
• ten logical Bit output devices
The above logical channels and de vices must be assigned to physical interfaces. For assignment you
just have to specify the connector number, the logi cal measuring channel and some transducer specific
data. Our Windows Program “DoSE” (Doli Set-up Edit or) helps to edit all necessary set-up data.
logical mesuring
channels
0 = Xhead position1 = Load2 = Extension3 = Temperature4 = xxxEDC100 connectors
X4
X7X21X22X23
All Set-up data will be stored in an EEPROM inside the EDC.

--- Page 9 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 9 of 145DoPE
1.3 Supported programming languages
DoPE is delivered as a DLL running under Windows  operating system. Each programming
language that supports the us e of DLL’s can be used fo r the application program.
However DOLI supplies only header files for “C”, “Delphi/Pascal” and Visual Basic.
Two DLL’s are needed to use DoPE: DoPE32.DLL and NTDPX.DLL.
1.3.1 Special considerations for VB-Programmer
• All DoPE function names use “DoPEVB” instead  of “DoPE”. For instance the name of the
function “DoPEOpenLink” is in Visual Basic “DoPEVBOpenLink”.
• Do not use the DoPE call-back mechanism while debugging VB program. Only use it for
executable versions. Microsoft’ s VB- developing system has obviously problems debugging call-
back mechanism.
• Use “DoPEVB32.DLL” additi onal to the “DoPE32.DLL”.
1.4 Sample programs to initialise DoPE
1.4.1 „C“ Program
#include "dope.h"
// First step open DoPE connection, de fine Port number, Baudrate, number of  buffers for receive, transmit and data 
DoPEErr = DoPEOpenLink ( Port, Baudrate, 10,  10, 10, DoPEAPIVERSION, NULL, &DoPEHdl);
if(DoPEErr != DoPERR_NOERROR)
{
// do error handling
}
// Here DoPEOpenLink was successful and communication to the EDC is online.
DoPEErr=DoPESetNotificatio n (DoPEHdl, DoPEEVT_ALL, NULL, hWnd, WM_DoPEEvent );
if(DoPEErr != DoPERR_NOERROR)
{
// do error handling
}
// Select one of the up to four possibile Setups
DoPEErr=DoPESelSetup ( DoPEHdl, 1, Us cale, &lpusTANFirst,  &lpusTANLast );
if(DoPEErr != DoPERR_NOERROR)
{
// do error handling
}
// Here the initialisation sequence for DoPE is done.
// Now you can move the machin e e.g. Up with 0.01 m/sec
DoPEErr = DoPEFMove (DoPEHdl, MOVE_UP, 0.01);
// Or you can position Xhead to 0.1m with 0.02 m/sec
DoPEErr = DoPEPos (DoPEHdl, CTRL_POS, 0.02, 0.1);
1.4.2 „VB“ Program
' open connection to EDC
e = DoPEVBOpenLink(ComPort, ComBaudRate, 10, 10, 50, DoPEAPIVERSION, ByVal 0&, DoPEHdl)
If e <> DoPERR_NOERROR Then
do error handling
‘ set DoPE notification for DoPE callback
e = DoPEVBSetNotification(DoPEHdl, DoPEEventMask,  AddressOf DoPECallBack, hMsgWnd, WM_DoPEEvent)
If e <> DoPERR_NOERROR Then
do error handling
' select Setup No. 1 and initialize EDC
e = DoPEVBSelSetup(DoPEHdl, 1, UserScale(0), ByVal 0&, ByVal 0&)

--- Page 10 ---

Page 10 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
1.4.3 „Delphi“ Program
uses
  DoPE;
const
 CM_CbMessage = WM_USER  // for DoPECallback
// Open Connection to the EDC
   DoPEErr := DoPEOpenLink(Port, Baud, 10, 10, 10, DoPEAPIVERSION, NIL, DoPEHdl);
   If (DoPEErr <> DoPEErr_NOERROR)
   begin
     do Error handling;
   end;
// OpenLink was successful; Communi cation to the EDC is online   
// SetNotification for DoPECallBack
   DoPEErr := DoPESetNotification(DoPEHdl, DoPEEVT_ALL, DoPECallBack-Function, handle, CM_CbMessage);
   If (DoPEErr <> DoPEErr_NOERROR)
   begin
     do Error handling;
   end;
// Select one of the up to four possible Setups
   DoPEErr := DoPESelSetup(DoPEHdl , 1, UsScale, @TanFirst, @TanLast);
   If (DoPEErr <> DoPEErr_NOERROR)
   begin
     do Error handling;
   end;
// Now the initialisation sequence for DoPE is done and you can move the machine...
end;

--- Page 11 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 11 of 145DoPE
2 Communication Priciples
DoPE represents a library that a ddresses functions inside the remote  EDC-controller. Physically the
EDC is connected via a standard COM-Port with the PC. A safe serial protocol is used for
communications. This protocol, named DPX, det ects ON/OFF-line transitions, transmits messages
and measured data packets with ACK/NAC mechanism.
The user of DoPE must always be aware of th e remote controller and due to this a asynchronous
behaviour of DoPE.
2.1 Open a connection
The application program estab lishes a connection by calling the DoPEOpenLink  function. This
function creates a thread with a priority depending on the priori ty of the application thread.
If the application thread has the priority TH READ_PRIORITY_NORMAL, DoPE thread will use the
priority THREAD_PRIORITY_ABOVE_NORMAL.
If the application thread has the priority  THREAD_PRIORITY_ABOVE_NORMAL, DoPE thread
will use the priority THRE AD_PRIORITY_TIME_CRITICAL.
The application thread should not st art another thread with a higher priority than its own. Otherwise
the communication with the EDC might be dela yed. This will cause unpredictable problems.
By this mechanism it is safeguarded that DoPE and hence the communication with the EDC has
always a higher priority th an the application program.
2.2 Establishing a connection with call-back function
Application Thread
DoPEOpenConnection
DoPESetNotificationDoPE – Thread
Call-back-FunctionExchange of data
Call according to EvtMask
Parameter to Call-back  
NotifyWnd
NotifyMsg (ID)
DoPEHandle
EvtMaskParameter :  
DoPEHandle
EventMask
NotifyProc (Callback)
NotifyWnd (for Postmessage)
NotifyMsg (for Postmessage)create Thread
DoPE - Handle
After the connection was successfully opened by the DoPEOpenLink command, the communication
between DoPE and the application pr ogram has to be established by the DoPESetNotification
command. Here are the parameters for DoPESetNotif ication if a call-back mechanism is used for
communications:
• EventMask specifies events after which the call-back is activated.

--- Page 12 ---

Page 12 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
• NotifyProc Specifies the addre ss of the call-back function.
• NotifyWnd This parameter is not used by DoPE, it may be used to pass information between 
the application program and call-back.
• NotifyMsg This parameter is not used by DoPE, it may be used to pass information between 
the application program and call-back.
This call-back mechanism enables the application program to do some “real time” work independent
from Windows message passing. The appl ication programmer must be awar e of the fact that this call-
back function can interrupt the application pr ogram at any point. Care must be taken of
communication between application program and call-back function. The application programmer
must use a Windows mechanism like MUTEX to s ynchronise communication between application
program and call-back.
The application programme should not call lengthy func tions like graphics, file handling etc. Due to
the high priority of the cal l-back function, only absolutely necessa ry tasks should be done inside the
call-back function.
Tasks like:
• Analysing data record and react on it by sending command to the EDC.
• Copy the data record to a circul ar buffer. (The application thr ead reads this data for further
analysis, update the online graphic etc.)
may be done inside the call-back function.
2.3 Establishing a connection using Windows message passing
Alternatively to the above cal l-back mechanism, a simple message passing may be used to
communicate from DoPE with the application prog ram. After the connection was successfully opened
by the DoPEOpenLink command, the communication between DoPE and the application program has
to be established by DoPESetNotification  command. Here are the parameters for
DoPESetNotification if a Windows message pa ssing mechanism is used for communications:
• EventMask specifies events that causes a message to be send.
• NotifyProc NULL
• NotifyWnd the window handle of the application program window
• NotifyMsg the ID for the message passed by Windows post message mechanism.
DoPE will use the standard Windows “ PostMessag e” function to pass messages to the application
program. This method is quite easy to handle, but a deterministic time behavi our is not predictable.
Messages from DoPE are passed to the Windows message  handler and then they are delivered to the
application program. The time needed for th e Windows message handling depends on the system
load. Under normal conditions (only one active application program), this method is also sufficient.
But there is one big disadvantage. If a Window on screen is touched by a mouse click and e.g. moved
on the screen, no messages can be passed during th is period. This makes a “real time” behaviour
impossible.
DoPEWindows
Mess age
Handl er
Application
ProgramMess age
according to
EvtMask

--- Page 13 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 13 of 145DoPE
2.4 Transaction Number
Some of the following commands have pointers to a transaction number (lpusTAN) as a parameter.
This TAN may be used to identify messages, which are received asynchronously, to the command.
Example: A positioning command is send to the EDC. After 30 seconds the desired position is
reached and a message “position reached” is received. This message comes with the TAN
of the positioning command.
The TAN is generated by DoPE for all commands, that may cause a message later on.
Some DoPE commands will send more than one comm and to the EDC. In this cases two pointers to
transaction numbers are needed (lpusTANFirst, lpus TANLast). In this case all messages with TAN’s
between lpusTANFirst and lpusTANLast belong to this single DoPE command.
Of course to analyse the TAN is optional. If NULL-Pointers are passed, no TAN’s are returned.
Application program
DoPE
EDC1. Call of a DoPE
function
2. Return of TAN
as a reference
numbe r
3. DoPE sends
command to
EDC with TAN4. EDC reports
completion ofcommand with
TAN5. DoPE passes
EDC message toapplicationprogram with
TAN
2.5 Synchronous / Asynchronous DoPE Commands
Most of the DoPE command will be passed from DoPE to the connected EDC. 
There are synchronous and asynchronous commands.
Synchronous commands wait until the EDC has check ed the parameter and returned the result.
Asynchronous commands are just transmitted to the EDC and return to the caller immediately. The
result of parameter check inside the EDC is tr ansmitted later if enabled by DoPESetNotification
command.
In both cases positioning commands will report completion of the command after destination positionis reached.

--- Page 14 ---

Page 14 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
2.6 Messages from DoPE to the application program
Besides measured values, messages are send from the EDC via DoPE to the application program.
If enabled by DoPESetNotification, a incoming message will create a DoPEEVT_RXAVAIL event
which is send to the application program via call-back or PostMessage mechanism. 
In both cases the real message must be read by DoPEGetMsg function.
There are three major types of messages possible: 
1. COMMAND_ERROR
This message is send after a DoPE command was called and the parameter check has been
finished.
2. RUNTIME_ERROR
Errors that occur during the system is running like limit switch, power off and so on.
3. MOVE_CTRL_MSG
Move control messages report normally the completion of a positioning command.

--- Page 15 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 15 of 145DoPE
3 Overview of all DoPE Commands
3.1 Initialisation Commands
Command
DLL-Ordination No.Page Parameter Name
DoPEOpenLink 15 Establish Communication to a EDC
@8 Port Communication Port No.
BaudRate Baudrate for communication
RcvBuffers Number of buffers for received messages
XmitBuffers Number of buffers for messages to transmit
DataBuffers Number of buffers for received data records
APIVersion Version of application interface
Reserved Reserved parameter
DoPEHdl DoPE Handle
DoPECloseLink 35 Close Communication with a EDC
@9 DoPEHdl DoPE Handle
DoPESetNotification 36 Set Notification parameter
@12 DoPEHdl DoPE Handle
EventMask Mask of events that  cause a notification
NotifyProc Address of Call-back function or NULL
NotifyWnd Window Handle of application program
NotifyMsg ID for message passed from DoPE to application
DoPEInitialize 37 Initialise EDC with active Set-up
@14 DoPE Handle DoPE Handle
lpusTANFirst Pointer to memory for first Transaction Number
lpusTANLast Pointer to memory for last Transaction Number
3.2 Setup Commands
Command
DLL-Ordination No.Page Parameter Name
DoPEOpenSetup(Sync) 38 Open Set-up inside EDC for Read / Write operations
@113  (@1113) DoPEHdl DoPE Handle
SetupNo Number of Set-up
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPECloseSetup(Sync) 38 Close previously opened Set-up
@114  (@1114) DoPEHdl DoPE Handle
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPESetupScale 38 Define User scale for Set-up sensor data
@148 DoPEHdl DoPE Handle
SetupNo Number of Set-up
US User scale for all set-up sensor data (except DoPESenDef)
DoPERdSetupAll (Sync) 39 Read total Set-up data of opened Set-up
@111  (@1111) DoPEHdl DoPE Handle
SetupNo Number of Set-up
DoPESetup Pointer to memory for Set-up data
not required for Sync version lpusTANFirst Pointer to memory for first Transaction Number
not required for Sync version lpusTANLast Pointer to memory for last Transaction Number

--- Page 16 ---

Page 16 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
Command
DLL-Ordination No.Page Parameter Name
DoPEWrSetupAll (Sync) 39 Write total set-up
@112  (@1112) DoPEHdl DoPE Handle
SetupNo Number of Set-up
DoPESetup Pointer to memory with Set-up data
not required for Sync version lpusTANFirst Pointer to memory for first Transaction Number
not required for Sync version lpusTANLast Pointer to memory for last Transaction Number
DoPERdSetupNumber 40 Read active set-up number
@110 DoPEHdl DoPE Handle
SetupNo Pointer to memory for Setup number
DoPERdSensorDef 40 Read definition data of a sensor
@92 DoPEHdl DoPE Handle
SensorNo Sensor Number
SensorDef Pointer to memory for Sensor definition data
DoPEWrSensorDef (Sync) 40 Write definition data of a sensor
@101  (@1101) DoPEHdl DoPE Handle
SensorNo Sensor Number
SensorDef Pointer to memory with Sensor definition data
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPERdCtrlSensorDef 41 Read definition data for clos ed loop control of a sensor
@93 DoPEHdl DoPE Handle
SensorNo Sensor Number
CtrlSensorDef Pointer to memory for closed loop control data for Sensor
DoPEWrCtrlSensorDef (Sync) 41 Write definition data for closed loop control of a sensor
@102  (@1102) DoPEHdl DoPE Handle
SensorNo Sensor Number
CtrlSensorDef Pointer to memory with closed loop control data for
Sensor
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPERdOutChannelDef 42 Read definition data of an  analogue output channel
@94 DoPEHdl DoPE Handle
OutChNo Number of analogue output channel
OutChDef Pointer to memory for output channel definition data
DoPEWrOutChannelDef (Sync) 42 Write definition data of an analogue output channel
@103  (@1103) DoPEHdl DoPE Handle
OutChNo Number of analogue output channel
OutChDef Pointer to memory with output channel definition data
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPERdBitInDef 42 Read definition data of Bit input channel
@96 DoPEHdl DoPE Handle
BitInNo Number of Bit input channel
BitInDef Pointer to memory for Bit input channel definition data
DoPEWrBitInDef (Sync) 43 Write definition data of Bit input channel
@105  (@1105) DoPEHdl DoPE Handle
BitInNo Number of Bit input channel
BitInDef Pointer to memory with Bit input channel definition data
not required for Sync version lpusTAN Pointer to memory for Transaction Number

--- Page 17 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 17 of 145DoPE
Command
DLL-Ordination No.Page Parameter Name
DoPERdBitOutDef 43 Read definition data of Bit output channel
@95 DoPEHdl DoPE Handle
BitOutNo Number of Bit input channel
BitOutDef Pointer to memory for Bit output channel definition data
DoPEWrBitOutDef (Sync) 43 Write definition data of Bit output channel
@104  (@1104) DoPEHdl DoPE Handle
BitOutNo Number of Bit output channel
BitOutDef Pointer to memory with Bit output channel definition data
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPERdMachineDef 44 Read definition data of machine
@97 DoPEHdl DoPE Handle
MachineDef Pointer to memory for machine definition data
DoPEWrMachineDef (Sync) 44 Write definition data of machine
@106  (@1106) DoPEHdl DoPE Handle
MachineDef Pointer to memory with machine definition data
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPERdLinTbl 45 Read machine load linearisation table
@96 DoPEHdl DoPE Handle
LinTblFalse Pointer to memory for FALSE values
LinTblTrue Pointer to memory for TRUE values
DoPEWrLinTbl (Sync) 45 Write machine load linearisation table
@105  (@1105) DoPEHdl DoPE Handle
LinTblFalse Pointer to memory with FALSE values
LinTblTrue Pointer to memory with TRUE values
not required for Sync version lpusTANFirst Pointer to memory for first Transaction Number
not required for Sync version lpusTANLast Pointer to memory for last Transaction Number
DoPERdGeneralData 46 Read general data
@100 DoPEHdl DoPE Handle
GeneralData Pointer to memory for general data
DoPEWrGeneralData (Sync) 46 Write general data
@109  (@1109) DoPEHdl DoPE Handle
GeneralData Pointer to memory with general data
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPESelSetup 47 Select machine Set-up
@13 DoPEHdl DoPE Handle
SetupNo Machine Set-up number
US User scale for all measuring channels
lpusTANFirst Pointer to memory for first Transaction Number
lpusTANLast Pointer to memory for last Transaction Number
DoPERdSensorInfo 47 Read Sensor information
@91 DoPEHdl DoPE Handle
SensorNo Sensor Number
Info Pointer to memory for information data of this sensor
DoPERdSysUserData 48 Read system user data
@99 DoPEHdl DoPE Handle
SysUsrData Pointer to memory for system user data
Length Length of system user data in bytes

--- Page 18 ---

Page 18 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
Command
DLL-Ordination No.Page Parameter Name
DoPEWrSysUserData (Sync) 48 Write system user data
@108  (@1108) DoPEHdl DoPE Handle
SysUsrData Pointer to memory for system user data
Length Length of system user data in bytes
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPERdSenUserData 49 Read sensor user data
@140 DoPEHdl DoPE Handle
SensorNo Sensor number
SenUsrData Pointer to memory for sensor user data
Length Length of system user data in bytes
DoPEWrSenUserData (Sync) 49 Write sensor user data
@141  (@1141) DoPEHdl DoPE Handle
SensorNo Sensor number
SenUsrData Pointer to memory with sensor user data
Length Length of sensor user data in bytes
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPERdSensorUserData 49 Read sensor user data (max 128 Byte).
@168 DoPEHdl DoPE Handle
Connector Connector number of sensor
*SenUsrData Pointer for sensor user data
Length User data buffer length in BYTE’s
DoPEWrSensorUserData 50 Write sensor user data (max 128 Byte).
@169 DoPEHdl DoPE Handle
Connector Connector number of sensor
*SenUsrData Pointer for sensor user data
Length User data buffer length in BYTE’s
3.3 Message and Data handling
Command
DLL-Ordination No.Page Parameter Name
DoPESendMsg (Sync) 51 Send a message to EDC-subsystem
@17  (@1017) DoPEHdl DoPE Handle
Buffer Pointer to memory with the message
Length Length of sensor user data in bytes
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEGetMsg 51 Get message from receive buffer
@18 DoPEHdl DoPE Handle
Buffer Pointer to memory for the message
BufSize Length of Buffer in bytes
Length Length of received message
DoPEGetData 57 Get data record
@19 DoPEHdl DoPE Handle
Buffer Pointer to memory for data record
DoPECurrentData 58 Get current data record
@146 DoPEHdl DoPE Handle
Buffer Pointer to memory for data record
DoPEClearReceiver 57 Clear (discard) all received messages
@20 DoPEHdl DoPE Handle

--- Page 19 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 19 of 145DoPE
Command
DLL-Ordination No.Page Parameter Name
DoPEClearTransmitter 58 Clear (discard) all messages to be sent
@21 DoPEHdl DoPE Handle
DoPEGetState 58 Read DoPE state (Co mmunication state, Nu mber of received messages,
Number of messages to be transmitted)
@16 DoPEHdl DoPE Handle
Status Pointer to memory for state record
DoPEGetErrors 59 Read current error counter values
@15 DoPEHdl DoPE Handle
Error Pointer to memory for error record
3.4 Configuration Commands
Command
DLL-Ordination No.Page Parameter Name
DoPERdVersion 60 Read Version strings
@80 DoPEHdl DoPE Handle
Version Pointer to memory for Version strings
DoPERefr (Sync) 60 Set time base for data acquisition
@22  (@1022) DoPEHdl DoPE Handle
Refresh Time base
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPESetTime (Sync) 60 Set time
@23  (@1023) DoPEHdl DoPE Handle
Time Time value
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPETransmitData (Sync) 61 Enable / Disable transmission of data record
@24  (@1024) DoPEHdl DoPE Handle
Enable TRUE = Enable transmission , FALSE = Disable transmission
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEIntgr (Sync) 61 Set Integration time for an analogue sensor
@30  (@1030) DoPEHdl DoPE Handle
SensorNo Sensor number
Intgr Integration time for the sensor
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPECtrlTestValues 62 Enable/Disable controller test values in the DoPEData record
@180 DoPEHdl DoPE Handle
State TRUE   = EnableFALSE = Disable
controller test values in the DoPEData record

--- Page 20 ---

Page 20 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
Command
DLL-Ordination No.Page Parameter Name
DoPEShieldLimit (Sync) 65 Activate safety shield (screen)
@127  (@1127) DoPEHdl DoPE Handle
SensorNo Sensor number (normally load)
UprLock Above this value shield must be closed
UprUnLock Below this value shield is unlocked
LwrUnLock Above this value shield is unlocked
LwrLock Below this value shield must be closed
CtrlLimit Control mode for SpeedLimit (normally position)
SpeedLimit Maximum allowed speed if shield is opened
CtrlAction Control mode for Action
Action Action to be activated if the limits are reached
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEShieldDisable (Sync) 65 Deactivate safety shield (screen)
@128  (@1128) DoPEHdl DoPE Handle
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEShieldLock (Sync) 66 Lock or unlock the shield (screen)
@129  (@1129) DoPEHdl DoPE Handle
State TRUE = Lock, FALSE = UNLOCK shield
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPESetCheck (Sync)
DoPESetCheckX (Sync)66 Activate measuring channel supervision
@40  (@1040) DoPEHdl DoPE Handle
@144  (@1144) CheckId ID of this check, use the CheckId constants
SensorNo Sensor to be supervised
Limit Limit to be supervised
only for DoPESetCheckX Tare Tare value needed for PercentMin and PercentMax
Mode Below, Above, PercentMin, PercentMax, AbsMax, AbsMin
Action Action to be activated if the check hits
(parameter for action are listed below)
Ctrl Control mode for selected action
Acc Acceleration
Speed Maximum speed
Dec Deceleration
Destination Final destination
lpusTAN Pointer to memory for Transaction Number
DoPEClrCheck (Sync) 67 Clear measuring channel supervision
@41  (@1041) DoPEHdl DoPE Handle
CheckId ID of the supervision to be  cleared, use the CheckId
constants
lpusTAN Pointer to memory for Transaction Number
DoPESetCheckLimit (Sync) 68 Activate measuring channel supervision and set digital output
@125  (@1125) DoPEHdl DoPE Handle
SensorNo Sensor to be supervised
UprLimitSet Set digital output above this value
UprLimitReset Reset digital output below this value
LwrLimitReset Reset digital output above this value
LwrLimitSet Set digital output below this value
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEClrCheckLimit (Sync) 68 Deactivate measuring channel su pervision with digital output
@126  (@1126) DoPEHdl DoPE Handle
not required for Sync version lpusTAN Pointer to memory for Transaction Number

--- Page 21 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 21 of 145DoPE
Command
DLL-Ordination No.Page Parameter Name
DoPEPosPID (Sync) 69 Set parameter for closed loop position  controller
@176  (@1176) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
P Proportional gain of the position controller
I Integration time constant (normally ZERO!!!)
D Derivative time constant (for future use)
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPESpeedPID (Sync) 69 Set parameter for closed loop speed  controller
@177  (@1177) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
P Proportional gain of the position controller
I Integration time
D Derivative time constant
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEPosFeedForward (Sync) 70 Set feed forward gain of closed loop controller.
@178  (@1178) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
P Gain for feed forward control
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEDestWnd (Sync) 71 Definitions for destination window
@75  (@1075) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
WndSize Size of destination window
WndTime Time for destination window
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPESft (Sync) 72 Definitions of limits supervised by software (softend)
@76  (@1076) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
UpperSft Upper soft limit
LowerSft lower soft limit
Reaction Action to be activated after softend is reached
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPECtrlError (Sync) 73 Define maximum error signal for closed loop controller
@77  (@1077) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Error Maximum difference between command and signal
Reaction Action to be activated after error is reached
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPESetDither (Sync) 74 Set Parameter for dither
@151  (@1151) DoPEHdl DoPE Handle
Output Number of analogue output channel
Frequency Dither frequency
Amplitude Dither aplitude
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPECtrlSpeedTimeBase (Sync) 74 Define Time Base for Speed detection (for calculated channels !)
@134  (@1134) DoPEHdl DoPE Handle
Time Time base for speed detection
not required for Sync version lpusTAN Pointer to memory for Transaction Number

--- Page 22 ---

Page 22 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
Command
DLL-Ordination No.Page Parameter Name
DoPECal (Sync) 74 Calibrate (offset and gain) analogue measuring channel(s)
@31  (@1031) DoPEHdl DoPE Handle
SensorBits Bit 0 = 1 Calibrate Sensor 0  and so on
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEZeroCal (Sync) 74 Calibrate (only offset) analogue measuring channel(s)
@32  (@1032) DoPEHdl DoPE Handle
SensorBits Bit 0 = 1 Calibrate Sensor 0  and so on
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPESetBasicTare (Sync) 76 Set basic tare of the measuring channel
@25  (@1025) DoPEHdl DoPE Handle
SensorNo Sensor Number
Mode Mode = 0 -> BasicTare represents the value at this pointMode = 1 -> BasicTare will be subtracted
BasicTare Basic tare value
not required for Sync version lpusTANFirst Pointer to memory for first Transaction Number
not required for Sync version lpusTANFirst Pointer to memory for last Transaction Number
DoPEGetBasicTare 77 Read basic tare of the measuring channel
@27 DoPEHdl DoPE Handle
SensorNo Sensor Number
BasicTare Pointer to memory for basic tare value
DoPESetTare 76 Set tare of the measuring channel
@26 DoPEHdl DoPE Handle
SensorNo Sensor Number
Tare Tare value
DoPEGetTare 77 Read tare of the measuring channel
@28 DoPEHdl DoPE Handle
SensorNo Sensor Number
Tare Pointer to memory for tare value
DoPEConfPeakValue  (Sync) 82 Configure peak values to  measuring data record.
@131  (@1131) DoPEHdl DoPE Handle
PositionMin Position of Minimum value of XHead Position
PositionMax Position of Maximum value of XHead Position
LoadMin Position of Minimum value of Load
LoadMax Position of Maximum value of Load
ExtensionMin Position of Minimum value of Extension
ExtensionMax Position of Maximum value of Extension
not required for Sync version lpusTANFirst Pointer to memory for first Transaction Number
not required for Sync version lpusTANLast Pointer to memory for last Transaction Number
DoPEPeakValueTime  (Sync) 82 Set reset time for peak value detection.
@132  (@1132) DoPEHdl DoPE Handle
Time Reset time for peak value detection
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEConfCMcSpeed  (Sync) 79 Configure calculated speed to measuring data record.
@135  (@1135) DoPEHdl DoPE Handle
CalculatedSensorNo Position in measuring data record for the calculated speed value
SensorNo SensorNo to calculate speed of
IntegrationTime Integration time for data acquis ition (only for analogue channels)
Timebase Time base for speed calculation (maximum 2.56 sec.)
not required for Sync version lpusTANFirst Pointer to memory for first Transaction Number
not required for Sync version lpusTANLast Pointer to memory for last Transaction Number

--- Page 23 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 23 of 145DoPE
Command
DLL-Ordination No.Page Parameter Name
DoPEConfCMcCommandSpeed (Sync) 79 Configure calculated speed of command output to data record.
@136  (@1136) DoPEHdl DoPE Handle
CalculatedSensorNo Position in measuring data record  for the calculated command speed
Timebase Time base for speed calculation (maximum 2.56 sec.)
not required for Sync version lpusTANFirst Pointer to memory for first Transaction Number
not required for Sync version lpusTANLast Pointer to memory for last Transaction Number
DoPEConfCMcGradient (Sync) 80 Configure calculated gradient between  two measured values to measuring
data record.
@137  (@1137) DoPEHdl DoPE Handle
CalculatedSensorNo Position in measuring data record for the calculated gradient.
DividentSensorNo Sensor No. for Dividend
DivisorSensorNo Sensor No. for Divisor
IntegrationTime Integration time for data acquis ition (only for analogue channels)
Timebase Time base for gradient calculation (maximum 2.56 sec.)
not required for Sync version lpusTANFirst Pointer to memory for first Transaction Number
not required for Sync version lpusTANLast Pointer to memory for last Transaction Number
DoPEClearCMc (Sync) 80 Clear calculated measuring channel.
@138  (@1138) DoPEHdl DoPE Handle
CalculatedSensorNo Position in measuring data record for the calculated value
not required for Sync version lpusTANFirst Pointer to memory for first Transaction Number
not required for Sync version lpusTANLast Pointer to memory for last Transaction Number
DoPEMc2Output (Sync) 81 Output of a measured value to a analogue output channel
@142  (@1142) DoPEHdl DoPE Handle
Mode Mode (OFF, HIGH_PRIORITY, LOW_PRIORITY)
SensorNo Sensor number 
OffsetSensor Offset value to be subtracted from measured value
Output Output channel number
OffsetOutput Offset to be subtracted 
Scale Scale
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPESetRefSignalMode 83 Set Reference signal mode for incremental sensors (only EDC60/120)
@154 DoPEHdl DoPE Handle
SensorNo Sensor number 
Mode REFSIG_NON: never,
REFSIG_ON: always,REFSIG_ONCE: only once
lpusTAN Pointer to memory for Transaction Number
DoPESetRefSignalTare 83 Set Reference signal mode for incremental sensors (only EDC60/120)
@155 DoPEHdl DoPE Handle
SensorNo Sensor number 
Mode 1 = At the next reference signal the measuring channel,
will be set to the tare value
0 = Reference signals don't affect the measuring channel
Tare Value for the measuring channel
lpusTAN Pointer to memory for Transaction Number
DoPEWrSensorMsg(Synch) 84 This function can be used to send a message to a serial sensor.(only EDC60/120)
@159 (@1159) DoPEHdl DoPE Handle
SensorNo Sensor number 
*Buffer Pointer to message to transmit
Length Message length in Byte’s
lpusTAN Pointer to memory for Transaction Number

--- Page 24 ---

Page 24 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
3.5 Input / Output-Commands
Command
DLL-Ordination No.Page Parameter Name
DoPESetOutput (Sync) 85 Set an analogue output channel
@33  (@1033) DoPEHdl DoPE Handle
Output Output channel number
Value New value of output channel in % of max. value
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPESetOutChannelOffset(Synch) 85 Set an analogue output channel offset (only EDC60/120)
@156 (@1156) DoPEHdl DoPE Handle
Output Number of analogue output channel
Offset New offset value of output channel
lpusTAN Pointer to memory for Transaction Number
DoPEOfflineActionOutput(Synch) 85 Definition of an action for an initialised analogue output channel afterEDC has detected offline (only EDC60/120)
@ 180 (@1180) DoPEHdl DoPE Handle
OutputNo Number of analogue output channel
Mode DO_NOTHING (0): Don't modify this digital output
USE_INIT_VALUE (1): Use Initial va lue from set-up after offline
USE_VALUE (2): Use defined value after offline
Value Output value used in USE_VALUE  mode in % of max. value
lpusTAN Pointer to memory for Transaction Number
DoPESetB (Sync) 87 Set an bit output channel
@29  (@1029) DoPEHdl DoPE Handle
BitOutputNo Digital output channel number
SetB These bits will be set
ResB These bits will be reset
FlashB These bits will flash
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPECalOut (Sync) 87 Activate (Deactivate) digital calibration contact
@82  (@1082) DoPEHdl DoPE Handle
Cal TRUE = Activate,   FALSE = Deactivate
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEBeep (Sync) 88 Activate (Deactivate) beeper
@83  (@1083) DoPEHdl DoPE Handle
Beep TRUE = Activate,   FALSE = Deactivate
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPELed (Sync) 88 Switch On/Off/Flash LED's at EDC frontpanel
@84  (@1084) DoPEHdl DoPE Handle
LedOn These LED's will be set
LedOff These LED's will be reset
LedFlash These LED's 'flash'
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEUniOut (Sync) 88 Activate/Deactivate universal digital output bits at EDC100, EDC60,
ECC120
@85  (@1085) DoPEHdl DoPE Handle
Output Bit 0 .. 3 represent the four digital outputs
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEBypass (Sync) 89 Activate/Deactivate bypass output
@33  (@1033) DoPEHdl DoPE Handle
Bypass TRUE = Activate,   FALSE = Deactivate
not required for Sync version lpusTAN Pointer to memory for Transaction Number

--- Page 25 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 25 of 145DoPE
Command
DLL-Ordination No.Page Parameter Name
DoPERdBitInput 89 Directly read digital input device
@115 DoPEHdl DoPE Handle
Connector Connector Number
Value Pointer to memory for digital input value
DoPEWrBitOutput (Sync) 89 Directly write digital output device
@116  (@1116) DoPEHdl DoPE Handle
Connector Connector Number
Value Digital output value
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEOfflineActionB itOutput (Synch) 90 Definition of an action for an initialised digital output after EDC has
detected offline (only EDC60/120)
@ 179 (@1179) DoPEHdl DoPE Handle
BitOutputNo Number of bit output device
Mode DO_NOTHING (0): Don't modify this digital output
USE_INIT_VALUE (1): Use Initial va lue from set-up after offline
USE_VALUE (2): Use defined value after offline
Value Output value used in USE_VALUE mode
lpusTAN Pointer to memory for Transaction Number
DoPEDspClear (Sync) 91 Clear LCD-display at EDC frontpanel
@87  (@1087) DoPEHdl DoPE Handle
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEDspHeadLine (Sync) 91 Display headline on LCD-display at EDC frontpanel
@88  (@1088) DoPEHdl DoPE Handle
HeadLine Pointer to headline text
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEDspFKeys (Sync) 92 Display function keys on LCD-display at EDC frontpanel
@89  (@1089) DoPEHdl DoPE Handle
FKeys Pointer to text for function keys
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEDspMValue (Sync) 92 Display data and dimensions on LCD-display at EDC frontpanel
@90  (@1090) DoPEHdl DoPE Handle
Value1 Pointer to character string for first value
Value2 Pointer to character string for second value
Dim1 Pointer to character string for first dimension
Dim2 Pointer to character string for second dimension
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEDspBeamScreen (Sync) 92 Display frame & beam on LCD-display at EDC frontpanel
@122  (@1122) DoPEHdl DoPE Handle
Value Value of the beam in %
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEDspBeamValue (Sync) 93 Display beam on LCD-display at EDC frontpanel
@122  (@1122) DoPEHdl DoPE Handle
Value Value of the beam in %
not required for Sync version lpusTAN Pointer to memory for Transaction Number

--- Page 26 ---

Page 26 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
3.6 Movement commands
Command
DLL-Ordination No.Page Parameter Name
DoPEHalt (Sync) 94 Halt movement of cross-head in the specified control mode
@46  (@1046) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
lpusTAN Pointer to memory for Transaction Number
DoPESHalt (Sync) 96 Instantly halt movement of cross-head in position control mode
@139  (@1139) DoPEHdl DoPE Handle
lpusTAN Pointer to memory for Transaction Number
DoPEHalt_A (Sync) 95 Halt movement of cross-head in the specified control mode and deceleration
@51  (@1051) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Dec Deceleration
lpusTAN Pointer to memory for Transaction Number
DoPEHaltW  (Sync) 95 Halt movement of cross-head in the specified control mode with delay time
@67  (@1067) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Delay Delay time (used in combined commands)
lpusTAN Pointer to memory for Transaction Number
DoPEHaltW_A  (Sync) 96 Halt movement of cross-head in the specified  control mode and deceleration with delay time
@68  (@1068) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOAD, CTRL_EXTENSION)
Dec Deceleration
Delay Delay time (used in combined commands)
lpusTAN Pointer to memory for Transaction Number
DoPEPos  (Sync) 97 Move cross-head in the specified control mode and speed to the given destination
@42  (@1042) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Speed Maximum speed for positioning
Destination Destination position
lpusTAN Pointer to memory for Transaction Number
DoPEPos_A  (Sync) 98 Move cross-head in the specified control mode and speed to the given destination.
Use specified acceleration and deceleration
@50  (@1050) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Acc Acceleration
Speed Maximum speed for positioning
Dec Deceleration
Destination Destination position
lpusTAN Pointer to memory for Transaction Number

--- Page 27 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 27 of 145DoPE
Command
DLL-Ordination No.Page Parameter Name
DoPEPosG1  (Sync) 99 Move cross-head in the specified control mode and speed to the given destination.
Do not change control mode. Destination must be different to move control mode!
@57  (@1057) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Speed Maximum speed for positioning
Limit Absolute  Limit position if Destination is not reached.
DestCtrl Control mode for Destination
Destination Destination position
lpusTAN Pointer to memory for Transaction Number
DoPEPosG1_A  (Sync) 100 Move cross-head in the specified control mode and speed to the given destination.
Use specified acceleration and deceleration .
Do not change control mode. Destination must be different to move control mode!
@58  (@1058) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Acc Acceleration
Speed Maximum speed for positioning
DecLimit Deceleration for limit position
Limit Absolute  Limit position if Destination is not reached.
DecDest Deceleration for destination
DestCtrl Control mode for Destination
Destination Destination position
lpusTAN Pointer to memory for Transaction Number
DoPEPosD1  (Sync) 101 Move cross-head in the specified control mode and speed to the given destination.
Do not change control mode. Destination must be different to move control mode!
@59  (@1059) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Speed Maximum speed for positioning
Limit Relative  Limit position if Destination is not reached.
DestCtrl Control mode for Destination
Destination Destination position
lpusTAN Pointer to memory for Transaction Number
DoPEPosD1_A  (Sync) 102 Move cross-head in the specified control mode and speed to the given destination.
Use specified acceleration and deceleration .
Do not change control mode. Destination must be different to move control mode!
@60  (@1060) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Acc Acceleration
Speed Maximum speed for positioning
DecLimit Deceleration for limit position
Limit Relative  Limit position if Destination is not reached.
DecDest Deceleration for destination
DestCtrl Control mode for Destination
Destination Destination position
lpusTAN Pointer to memory for Transaction Number

--- Page 28 ---

Page 28 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
Command
DLL-Ordination No.Page Parameter Name
DoPEPosG2  (Sync) 103 Move cross-head in the specified control mode and speed to the given destination.
Change control mode. Destination must be different to move control mode!
@61  (@1061) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Speed Maximum speed for positioning
Limit Absolute  Limit position if Destination is not reached.
DestCtrl Control mode for Destination
Destination Destination position
lpusTAN Pointer to memory for Transaction Number
DoPEPosG2_A  (Sync) 104 Move cross-head in the specified control mode and speed to the given destination.
Use specified acceleration and deceleration .
Change control mode. Destination must be different to move control mode!
@62  (@1062) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Acc Acceleration
Speed Maximum speed for positioning
DecLimit Deceleration for limit position
Limit Absolute  Limit position if Destination is not reached.
DecDest Deceleration for destination
DestCtrl Control mode for Destination
Destination Destination position
lpusTAN Pointer to memory for Transaction Number
DoPEPosD2  (Sync) 105 Move cross-head in the specified control mode and speed to the given destination.
Change control mode. Destination must be different to move control mode!
@63  (@1063) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Speed Maximum speed for positioning
Limit Relative  Limit position if Destination is not reached.
DestCtrl Control mode for Destination
Destination Destination position
lpusTAN Pointer to memory for Transaction Number
DoPEPosD2_A  (Sync) 106 Move cross-head in the specified control mode and speed to the given destination.
Use specified acceleration and deceleration .
Change control mode. Destination must be different to move control mode!
@64  (@1064) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Acc Acceleration
Speed Maximum speed for positioning
DecLimit Deceleration for limit position
Limit Relative  Limit position if Destination is not reached.
DecDest Deceleration for destination
DestCtrl Control mode for Destination
Destination Destination position
lpusTAN Pointer to memory for Transaction Number

--- Page 29 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 29 of 145DoPE
Command
DLL-Ordination No.Page Parameter Name
DoPEPosExt  (Sync) 108 General positioning command to a external destination.
Use this command instead of DoPEPosG1, DoPEPosD 1, DoPEPosG2 and
DoPEPosD2.
This command is not available for EDC5/20 and EDC100!!!
@149  (@1149) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Speed Maximum speed for positioning
LimitMode Limit position is Absolute or relative 
Limit Limit position if Destination is not reached.
DestCtrl Control mode for Destination
Destination Destination position
DestinationMode Control mode at destination
lpusTAN Pointer to memory for Transaction Number
DoPEPosExt_A  (Sync) 109 General positioning command to a extern al destination. Acceleration and
deceleration  are specified.
Use this command instead of DoPEPosG1_A, DoPEPosD1_A, DoPEPosG2_A
and DoPEPosD2_A.
This command is not available for EDC5/20 and EDC100!!!
@150  (@1150) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Acc Acceleration
Speed Maximum speed for positioning
DecLimit Deceleration for limit position
LimitMode Limit position is Absolute or relative
Limit Limit position if Destination is not reached.
DecDest Deceleration for destination
DestCtrl Control mode for Destination
Destination Destination position
DestinationMode Control mode at destination
lpusTAN Pointer to memory for Transaction Number

--- Page 30 ---

Page 30 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
Command
DLL-Ordination No.Page Parameter Name
DoPEFMove (Sync) 107 Move cross-head in the specified control mode and speed UP or DOWN
@45  (@1045) DoPEHdl DoPE Handle
Direction MOVE_HALT, MOVE_UP or MOVE_DOWN
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Speed Maximum speed for movement
lpusTAN Pointer to memory for Transaction Number
DoPEXpCont (Sync) 110 Change control mode and continue movement in the new control mode
with the actual speed
@69  (@1069) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Limit Limit position
lpusTAN Pointer to memory for Transaction Number
DoPETrig (Sync) 111 Move cross-head with the specifi ed speed to the limit position.
If the trigger position is reach ed a message will be transmitted.
@65  (@1065) DoPEHdl DoPE Handle
Speed Maximum speed for movement
Limit Limit position
TriggerCtrl Control mode for trigger channel
Trigger Trigger position
lpusTAN Pointer to memory for Transaction Number
DoPETrig_A (Sync) 112 Move cross-head with the specifi ed speed to the limit position.
Use specified acceleration and deceleration .
If the trigger position is reach ed a message will be transmitted.
@66  (@1066) DoPEHdl DoPE Handle
Acc Acceleration
Speed Maximum speed for movement
Dec Deceleration
Limit Limit position
TriggerCtrl Control mode for trigger channel
Trigger Trigger position
lpusTAN Pointer to memory for Transaction Number
DoPEStartCMD (Sync) 113 Start definition of a combined movement command
@70  (@1070) DoPEHdl DoPE Handle
Cycles Repeat combined moving comm and this number of cycles
ModeFlags Flags definition
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEEndCMD (Sync) 113 End of combined moving command and start it.
@70  (@1070) DoPEHdl DoPE Handle
Operation CMD_DISCARD or CMD_START
not required for Sync version lpusTAN Pointer to memory for Transaction Number

--- Page 31 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 31 of 145DoPE
3.7 Complex moving commands
Command
DLL-Ordination No.Page Parameter Name
DoPEExt2Ctrl (Sync) 114 Move cross-head according to an external command signal.
@43  (@1043) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
OffsetCtrl Offset for position, load or extension
SensorNo Sensor number for the external command signal
OffsetSensor Offset for external command signal
Mode Various position or speed control modes
Scale Scaling factor for external command signal
lpusTAN Pointer to memory for Transaction Number
DoPEFDPoti (Sync) 115 Move cross-head according to an external command signal generated by a
digital encoder (DigiPoti).
@44  (@1044) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
MaxSpeed Starting speed for speed controlled modes
SensorNo Sensor number for the external command signal
DxTrigger Dead area of encoder
Mode Various position or speed control modes
Scale Scaling factor for external command signal
lpusTAN Pointer to memory for Transaction Number
DoPECycle (Sync) 116 Cycle movement command
@52  (@1052) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Speed1 Maximum speed to reach destination 1
Dest1 Destination 1
Halt1 Halt time at destination 1
Speed2 Maximum speed to reach destination 2
Dest2 Destination 2
Halt2 Halt time at destination 2
Cycles Number of cycles
Speed Speed to final destination
Destination Final destination
lpusTAN Pointer to memory for Transaction Number
DoPECosine (Sync) 117 Cosine movement command
@54  (@1054) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Speed1 Maximum speed to reach destination 1
Dest1 Destination 1
Dest2 Destination 2
Frequency Frequency for cosine
HalfCycles Number of half cycles
Speed Speed to final destination
Destination Final destination
lpusTAN Pointer to memory for Transaction Number

--- Page 32 ---

Page 32 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
Command
DLL-Ordination No.Page Parameter Name
DoPECosineX (Sync) 118 Cosine movement with halt time at Destination 1 and 2
@117  (@1117) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Speed1 Maximum speed to reach destination 1
Dest1 Destination 1
Halt1 Halt time at destination 1
Dest2 Destination 2
Halt2 Halt time at destination 2
Frequency Frequency for cosine
HalfCycles Number of half cycles
Speed Speed to final destination
Destination Final destination
lpusTAN Pointer to memory for Transaction Number
DoPECosineV (Sync) 118 Activate peak value control for Cosine Command
@118  (@1118) DoPEHdl DoPE Handle
Mode Various operational mode (see definition)
Dest1 Destination 1
Dest2 Destination 2
Cycles Peak value control is active every xx Cycles
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPETriangle (Sync) 120 Triangular movement command
@55  (@1055) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Speed1 Maximum speed to reach destination 1
Dest1 Destination 1
Dest2 Destination 2
Frequency Frequency for triangle
HalfCycles Number of half cycles
Speed Speed to final destination
Destination Final destination
lpusTAN Pointer to memory for Transaction Number
DoPERectangle (Sync) 121 Rectangular movement command
@56  (@1056) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Speed1 Maximum speed to reach destination 1
Dest1 Destination 1
Dest2 Destination 2
Frequency Frequency for rectangle
HalfCycles Number of half cycles
Speed Speed to final destination
Destination Final destination
lpusTAN Pointer to memory for Transaction Number
DoPEOffsC (Sync) 122 Special moving command to measure the offset of an external, analogue
speed controller
@72  (@1072) DoPEHdl DoPE Handle
Speed Maximum speed
PosDiff Distance to move cross-head
lpusTAN Pointer to memory for Transaction Number

--- Page 33 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 33 of 145DoPE
3.8 Miscellaneous Control Commands
Command
DLL-Ordination No.Page Parameter Name
DoPEOn (Sync) 125 Activate drive (only for EDC5/25 and new EDC60/120)
@81  (@1081) DoPEHdl DoPE Handle
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEDefaultAcc (Sync) 125 Set default acceleration (and decel eration) for all moving commands.
@47  (@1047) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Acc Default acceleration
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPESpeedLimit (Sync) 125 Set speed limit for all moving commands.
@130  (@1130) DoPEHdl DoPE Handle
MoveCtrl Control mode (CTRL_POS, CTRL_LOA D, CTRL_EXTENSION)
Speed Maximum speed
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEStop (Sync) 126 Enable / disable drive
@48  (@1048) DoPEHdl DoPE Handle
State TRUE: Stop state -> drive disabled
FALSE: drive enabled
lpusTAN Pointer to memory for Transaction Number
DoPEEmergencyMove (Sync) 126 Activate / deactivate emergency movement.
@49  (@1049) DoPEHdl DoPE Handle
State TRUE: OnFALSE: OFF
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPEEmergencyOff (Sync) 126 Activate / deactivate  EmergencyOff state.
@53  (@1053) DoPEHdl DoPE Handle
State TRUE: On
FALSE: OFF
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPESetOpenLoopCommand (Sync) 127 Set command output in open loop structure
@133  (@1133) DoPEHdl DoPE Handle
Command Command value in % of nominal output value
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPESynchronizeSystemMode  (Sync) 123 Set mode for synchronized movements. (only EDC60/120)
@157 (@1157) DoPEHdl DoPE Handle
Mode SSM_SYNCMOVE
SSM_ SYSTEMTIMESSM_ DISCARD
Time Delay or system time to set with the nextDoPESynchronizeSystemMode commands
not required for Sync version lpusTAN Pointer to memory for Transaction Number
DoPESynchronizeSystemStart (Sync) 124 Activate syncronisation. (only EDC60/120)
@158 (@1158) DoPEHdl DoPE Handle
not required for Sync version lpusTAN Pointer to memory for Transaction Number

--- Page 34 ---

Page 34 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
3.9 Sensor EEPROM Handling
Command
DLL-Ordination No.Page Parameter Name
DoPERdSensorConKey 128 Read sensor plug connected and key state.
@170 DoPEHdl DoPE Handle
Connector Connector number of sensor
*Connected Pointer to the sensor plug connected state(0=not connected, 1=connected)
*KeyPressed Pointer to the sensor plug key state(0=not pressed, 1=pressed)
DoPERdSensorHeaderData 129 Read sensor EEPROM data header.
@160 DoPEHdl DoPE Handle
Connector Connector number of sensor
*SenHdrData Pointer to sensor data header structure
DoPERdSensorAnalogueData 130 Read analogue sensor data.
@162 DoPEHdl DoPE Handle
Connector Connector number of sensor
*SenAnalogueData Pointer to analogue sensor data structure
DoPEWrSensorAnalogueData 130 Write analogue sensor data.
@163 DoPEHdl DoPE Handle
Connector Connector number of sensor
*SenAnalogueData Pointer to analogue sensor data structure
DoPERdSensorIncData 131 Read incremental sensor data.
@164 DoPEHdl DoPE Handle
Connector Connector number of sensor
*SenIncData Pointer to incremental sensor data structure
DoPEWrSensorIncData 131 Write incremental sensor data.
@165 DoPEHdl DoPE Handle
Connector Connector number of sensor
*SenIncData Pointer to incremental sensor data structure
DoPERdSensorAbsData 132 Read absolute sensor data.
@166 DoPEHdl DoPE Handle
Connector Connector number of sensor
*SenAbsData Pointer to absolute value sensor data structure
DoPEWrSensorAbsData 132 Write absolute sensor data.
@167 DoPEHdl DoPE Handle
Connector Connector number of sensor
*SenAbsData Pointer to absolute value sensor data structure

--- Page 35 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 35 of 145DoPE
3.10 DoPEOpenLink
unsigned Port
unsigned BaudRate
unsigned RcvBuffers
unsigned XmitBuffers
unsigned DataBuffers
unsigned APIVersion
void FAR *Reserved
DoPE_HANDLE FAR *DoPEHdl
This must be the first call to start communications with DoPE.
All needed memory is allocated, link parame ters are set and the link is established.
In: Port Port number 0 = COM1,  1 = COM2 etc.
BaudRate Baud rate for serial lines, as supported by Windows
RcvBuffers Number of requested receiver buffers for messages.
This number of received messages can be stored inside DoPE until
they are read with DoPEGetMsg function.
XmitBuffers Number of requested transmitter buffers for messages.
This number of transmit messages can be stored inside DoPE.
They will be transmitted by DoPE to the EDC.
DataBuffers Number of requested data buffers.
The measuring data record will be stored inside DoPE in acircular buffer. If data are not read with DoPEGetData the
oldest record be overwritten!
APIVersion Version number of app lication program interface (API).
Use DoPEAPIVERSION defined in dope.h.
Reserved Reserved parameter.
DoPEHdl Pointer to memory for DoPE link handle
Out: *DoPEHdl DoPE link handle. This handle has to be used for all further
DoPE commands as a reference for this link.
Returns: Error constant (DoPERR_xxxx)
If DoPEOpenLink returns DoPERR_TIMEOUT, connection to the EDC did not go online. EDCmust be connected to the defined communication port. It must be switched on, PC-Control must be
active and either automatic baud rate detection or the correct baud rate must be selected.
3.11 DoPECloseLink
DoPE_HANDLE DoPEHdl
Close the link and free all allocated memory. After this call DoPEHdl is invalid and all further calls
with this DoPEHdl will return with an error. After DoPECloseLink was called.
In: DoPEHdl DoPE link handle
Returns: Error constant (DoPERR_xxxx)

--- Page 36 ---

Page 36 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
3.12 DoPESetNotification
DoPE_HANDLE DoPEHdl
unsigned EventMask
NPROC *NotifyProc
HWND NotifyWnd
UINT NotifyMsg
Select the events you are interested in. 
There are two mechanism to notify your program if events occur:
1. Call-back mechanism
The parameter NotifyProc contains the address of the user call-back-f unction. This function is
called from DoPE after one or more active even t(s) occurred. The call-b ack function is running
at a higher priority than the application.
Be aware the call-back can interrupt your application program at any time!
The application programmer must use a Wi ndows mechanism like MUTEX to synchronize
communication between application program and call-back.
Only time critical, short actions should be programme d in call-back function!
The call-back function is called with the parameter:
HWND NotifyWndUINT NotifyMsgWPARAM DoPEHdlLPARAM Event
Return Event mask. All processed events must be  reset. The next call-back has all unprocessed
events set. Thus unprocessed events ar e not lost, but stored inside DoPE.
2. PostMessage mechanism
DoPE sends the active events using the window s function PostMessage to the application
program (NotifyWnd). LPARAM contains th e active events. WPARAM is not used.
Both, the application program or call-back must process the events by cal ling DoPE functions like
DoPEGetMsg (see below)
In: DoPEHdl DoPE link handle
EventMask Events for Notification. (DoPEEVT_xx see below)
NotifyProc Notification call-back.
NotifyWnd Window handle of the applicati on program. This handle is used in
PostMessage function as an addre ss (LPARAM) and it is to pass to
call-back as a parameter.
NotifyMsg Message-Number used in Post Message function as an identifier
(WPARAM ) and it is to pass to  call-back as a parameter.
Returns: Error constant (DoPERR_xxxx)

--- Page 37 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 37 of 145DoPE
Possible events for EventMask:
Event Description Action
DoPEEVT_RXAVAIL New message received. Read message by DoPEGetMsg
DoPEEVT_DATAVAIL New measured data
record available.Read data by DoPEGetData
DoPEEVT_DATAOVERFLOW Overflow of data record.The oldest record wasoverwritten. Read all old data by repetitivelycalling DoPEGetData until nomore data are available.
DoPEEVT_ACK For all commands sent tothe EDC this event isgenerated after the EDChas checked the commandand no error was found.Just information, no DoPEfunction has to be called.
DoPEEVT_NAK If the parameter checkinside EDC found anerror, this event will begenerated. Just information, no DoPEfunction has to be called.
DoPEEVT_OVERFLOW Receiver queue overflow,the latest message waslost! Read all old messages byrepetitively callingDoPEGetMsg until no moredata are available.
DoPEEVT_OFFLINE State transition to offline.(EDC was switched off,cable disconnected ...) Just information, no DoPEfunction has to be called.
DoPEEVT_ONLINE State transition to online.Communication is OK. Just information, no DoPEfunction has to be called.
DoPEEVT_ALL All valid event bits.
All needed events may be comb ined with an OR operation.
3.13 DoPEInitialize
DoPE_HANDLE DP
WORD  FAR *lpusTANFirst
WORD  FAR *lpusTANLast
Initialise System with selected set-up data. This  command must be called after a change of set-up
data was made without selecting a new set-up.
In: DoPEHdl DoPE link handle
lpusTANFirst Pointer to first transaction number.
lpusTANLast Pointer to last transaction number.
Returns: Error constant (DoPERR_xxxx)

--- Page 38 ---

Page 38 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
4 Setup Commands
You can read or write machine set-up data. Ther e are maximal four plus one machine set-up’s
possible. Set-up data from number one to four are stored inside EDC in a EEPROM. Set-up number
zero is the working set-up. All data written to set-up zero are not stored, but ca n be used to initialise
EDC. Thus handling more than four different  set-up's by writing set-up data to set-up No. 0.
Before any set-up operation (read  or write) can be done, the se t-up must be opened. After the
operations on the opened set-up are finish ed, you have to close the opened set-up.
4.1 DoPEOpenSetup(Sync)
DoPE_HANDLE DoPEHdl
unsigned short SetupNo
WORD FAR                            *lpusTAN          (not for Sync. version)
Open set-up 'SetupNo' fo r read/write operations.
In: DoPEHdl DoPE link handle
SetupNo Set-up Number
lpusTAN Pointer to transaction number.
Returns: Error constant (DoPERR_xxxx)
4.2 DoPECloseSetup(Sync)
DoPE_HANDLE DoPEHdl
WORD FAR                            *lpusTAN          (not for Sync. version)
Closes previously opened set-up.
In: DoPEHdl DoPE link handle
lpusTAN Pointer to transaction number.
Returns: Error constant (DoPERR_xxxx)
4.3 DoPESetupScale
DoPE_HANDLE DoPEHdl
unsigned short SetupNo
UserScale US
Sets the set-up user scale.
In: DoPEHdl DoPE link handle
SetupNo Set-up Number
US User scale for all set-up sensor data (except DoPESenDef). 
The sensor data will be multiplied with the value in US. 
e.g. use this to convert the SI unit meter into mm
by setting the UserScale to 1000 for the position sensor
Default values 1.0 will be used if US is NULL. 
Returns: Error constant (DoPERR_xxxx) 

--- Page 39 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 39 of 145DoPE
4.4 DoPERdSetupAll(Sync)
DoPERdSetupAll(Sync)
DoPE_HANDLE DoPEHdl
unsigned short SetupNo
DoPESetup FAR *Setup
WORD FAR                            * lpusTANFirst      (not for Sync. version)
WORD FAR                            * lpusTANLast       (not for Sync. version)
Read the total set-up structure.
In: DoPEHdl DoPE link handle
SetupNo Set-up Number
DoPESetup FAR Pointer to set-up data
lpusTANFirst Pointer to first transaction number.
lpusTANLast Pointer to last transaction number.
Returns: Error constant (DoPERR_xxxx)
4.5 DoPEWrSetupAll(Sync)
DoPE_HANDLE DoPEHdl
unsigned short SetupNo
DoPESetup FAR *Set-up
WORD FAR                            * lpusTANFirst      (not for Sync. version)
WORD FAR                            * lpusTANLast       (not for Sync. version)
Write the set-up structure.
In: DoPEHdl DoPE link handle
SetupNo Set-up Number
DoPESetup FAR Pointer to set-up data
lpusTANFirst Pointer to first transaction number.
lpusTANLast Pointer to last transaction number.
Returns: Error constant (DoPERR_xxxx)
DoPESetup structure:
typedef struct                         /* EDC Setup Data                    */
  {                                    /* ---------------------------------- */
  DoPESenDef      SDef[MAX_MC];        /* Sensor definition data             */
  DoPECtrlSenDef  CSDef[MAX_CTRL];     /* Control-Sensor definition data     */
  DoPEOutChaDef   ODef[MAX_OC];        /* Analogue output definition data    */
  DoPEBitOutDef   BODef[MAX_BOUT];     /* Digital bit output definition data */
  DoPEBitInDef    BIDef[MAX_BIN];      /* Digital bit input definition data  */
  DoPEMachineDef  MDef;                /* Machine definition data            */
  DoPELinTblFalse LinTblFalse;         /* Linearisation table FALSE values   */
  DoPELinTblTrue  LinTblTrue;          /* Linearisation table TRUE values    */
  } DoPESetup;

--- Page 40 ---

Page 40 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
4.6 DoPERdSetupNumber
DoPE_HANDLE DoPEHdl
unsigned short *SetupNo
Read currently selected set-up number.
In: DoPEHdl DoPE link handle
SetupNo Pointer to store set-up number
Returns: Error constant (DoPERR_xxxx)
4.7 DoPERdSensorDef
DoPE_HANDLE DP
unsigned short SensorNo
DoPESenDef FAR *SensorDef
Read sensor definitions of opened set-up.
In: DoPEHdl DoPE link handle
SensorNo Sensor Number
*SensorDef Pointer for DoPESenDef structure
Returns: Error constant (DoPERR_xxxx)
4.8 DoPEWrSensorDef(Sync)
DoPE_HANDLE DP
Unsigned short SensorNo
DoPESenDef  FAR *SensorDef
WORD FAR                            *lpusTAN          (not for Sync. version)
Write Sensor definitions to opened set-up.
In: DoPEHdl DoPE link handle
SensorNo Sensor Number
*SensorDef Pointer for Sensor Definition structure
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
DoPESenDef structure:
typedef struct                         /* Sensor definition data             */
  {                                    /* ---------------------------------- */
  WORD   Connector;                    /* Connector number of sensor     [No]*/
  WORD   Sign;                         /* Invert sign of sensor         [1/0]*/
  WORD   CtrlChannel;                  /* Activate control channel      [1/0]*/
  WORD   LimitCtrl;                    /* Stop if limit exceeded        [1/0]*/
  WORD   ConnectedCtrl;                /* Stop if disconnected          [1/0]*/
  WORD   UseEeprom;                    /* Use sensor EEPROM data        [1/0]*/
                                       /* Only for analogue sensors:         */
  double Integr;                       /* Time of integration             [s]*/
                                       /* Only for sensors without EEPROM:   */
  WORD   Init;                         /* Sensor init                    [No]*/
  double NominalValue;                 /* Nominal value of sensor      [Unit]*/
  WORD   Unit;                         /* Unit of sensor UNIT_xxx        [No]*/
  double Offset;                       /* Offset of sensor             [Unit]*/
  double UpperLimit;                   /* Upper range limit of sensor     [%]*/
  double LowerLimit;                   /* Lower range limit of sensor     [%]*/

--- Page 41 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 41 of 145DoPE
                                       /* Only for incremental sensors:      */
  double Scale;                        /* Scale of sensor    [inc/revolution]*/
                                       /*                or [Unit/revolution]*/
  double Correction;                   /* Correction value of sensor     [No]*/
  } DoPESenDef;
4.9 DoPERdCtrlSensorDef
DoPE_HANDLE DP
unsigned short SensorNo
DoPECtrlSenDef FAR *CtrlSensorDef
Read definitions of control sensor of opened set-up.
In: DP DoPE link handle
SensorNo Sensor Number
*CtrlSensorDef Pointer for DoPECtrlSenDef structure
Returns: Error constant (DoPERR_xxxx)
4.10 DoPEWrCtrlSensorDef(Sync)
DoPE_HANDLE DP
Unsigned short SensorNo
DoPECtrlSenDef  FAR *CtrlSensorDef
WORD FAR                            *lpusTAN          (not for Sync. version)
Write control sensor definitions to opened set-up.
In: DoPEHdl DoPE link handle
SensorNo Sensor Number
*CtrlSensorDef Pointer for Control-Sensor Definition structure
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
DoPECtrlSenDef structure:
typedef struct                         /* Control Sensor definition data     */
  {                                    /* ---------------------------------- */
  double Acceleration;                 /* Nominal acceleration      [Unit/s²]*/
  double Speed;                        /* Nominal speed              [Unit/s]*/
  double WndSize;                      /* Target window size           [Unit]*/
  double WndTime;                      /* Time for target window          [s]*/
  double Deviation;                    /* Max. deviation of controller [Unit]*/
  WORD   DevReaction;                  /* Reaction if deviation exceeded [No]*/
  DWORD  PosK;                         /* Pos.  contr. P: gain           [No]*/
  WORD   PosTi;                        /* Pos.  contr. I: time constant  [No]*/
  WORD   PosTd;                        /* Pos.  contr. D: time constant  [No]*/
  DWORD  PosGenTd;                     /* Pos.  generator D              [No]*/
  DWORD  SpeedK;                       /* Speed contr. P: gain           [No]*/
  WORD   SpeedTi;                      /* Speed contr. I: time constant  [No]*/
  WORD   SpeedTd;                      /* Speed contr. D: time constant  [No]*/
  DWORD  SpeedGenTd;                   /* Speed generator D              [No]*/
  DWORD  AccK;                         /* Acceleration contrl. P: gain   [No]*/
                                       /* Only for analogue sensors:         */
  double Integr;                       /* Time of integration for control.[s]*/
  } DoPECtrlSenDef;

--- Page 42 ---

Page 42 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
4.11 DoPERdOutChannelDef
DoPE_HANDLE DP
unsigned short OutChNo
DoPEOutChaDef FAR *OutChDef
Read analogue output channel definitions of opened set-up.
In: DoPEHdl DoPE link handle
OutChNo Output channel no. 
*OutChDef Pointer for DoPEOutChaDef structure
Returns: Error constant (DoPERR_xxxx)
4.12 DoPEWrOutChannelDef(Sync)
DoPE_HANDLE DP
Unsigned short OutChNo
DoPEOutChaDef FAR *CtrlSensorDef
WORD FAR                            *lpusTAN          (not for Sync. version)
Write analogue output channel definitions to opened set-up.
In: DoPEHdl DoPE link handle
OutChNo Analogue Output channel no
*DoPEOutChaDef Pointer for DoPEOutChaDef structure
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
DoPEOutChaDef structure:
typedef struct                         /* Definition of output channel       */
  {                                    /* ---------------------------------- */
  WORD   Connector;                    /* Connector number of channel    [No]*/
  WORD   Sign;                         /* Invert sign of channel        [1/0]*/
  double MaxValue;                     /* Maximum output value            [%]*/
  double MinValue;                     /* Minimum output value            [%]*/
  double InitValue;                    /* Initial output value            [%]*/
                                       /* Only if adjustable (DDAxx):        */
  double PaVoltage;                    /* Max. voltage of power amplifier [V]*/
  double PaCurrent;                    /* Max. current of power amplifier [A]*/
  double MaxCurrTime;                  /* Max. time for max. current (I²t)[s]*/
  double DitherFrequency;              /* Dither frequency               [Hz]*/
  double DitherAmplitude;              /* Dither amplitude                [%]*/
  WORD   CurrentControllerGain;        /* Current controller gain set    [No]*/
  WORD   Signal;                       /* Digital command output signal  [No]*/
  WORD   SignalFrequency;              /* Digital command output signal  [No]*/
  WORD   ChangeDirection;              /* Dir.Outp.for synchronous motor[1/0]*/
  WORD   ChangeDirectionLevel;         /* Diriction Output level        [1/0]*/
  double Offset;                       /* Offset of channel               [%]*/
 } DoPEOutChaDef;
4.13 DoPERdBitInDef
DoPE_HANDLE DP
unsigned short BitInNo
DoPEBitInDef FAR *BitInDef
Read Bit input definitions of opened set-up.

--- Page 43 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 43 of 145DoPE
In: DP DoPE link handle
BitInNo Output channel no. 
*BitInDef Pointer for DoPEBitInDef structure
Returns: Error constant (DoPERR_xxxx)
4.14 DoPEWrBitInDef(Sync)
DoPE_HANDLE DP
Unsigned short BitInNo
DoPEBitInDef FAR * BitInDef
WORD FAR                            *lpusTAN          (not for Sync. version)
Write Bit input definitions to opened set-up.
In: DoPEHdl DoPE link handle
BitInNo Bit Input channel no
*DoPEBitInDef Pointer for DoPEBitInDef structure
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
DoPEBitInDef structure:
typedef struct                         /* Definition of bit output           */
  {                                    /* ---------------------------------- */
  WORD Connector;                      /* Connector number of device     [No]*/
  WORD InitValue;                      /* Initial value of device        [No]*/
  } DoPEBitOutDef;
4.15 DoPERdBitOutDef
DoPE_HANDLE DP
unsigned short BitOutNo
DoPEBitOutDef FAR *BitOutDef
Read Bit output definitions of opened set-up.
In: DoPEHdl DoPE link handle
BitOutNo Output channel no. 
*BitOutDef Pointer for DoPEBitOutDef structure
Returns: Error constant (DoPERR_xxxx)
4.16 DoPEWrBitOutDef(Sync)
DoPE_HANDLE DP
Unsigned short BitOutNo
DoPEBitOutDef FAR *BitOutDef
WORD FAR                            *lpusTAN          (not for Sync. version)
Write Bit output definitions to opened set-up.
In: DoPEHdl DoPE link handle
BitOutNo Bit Output channel no
*DoPEBitOutDef Pointer for DoPEBitOutDef structure
lpusTAN Pointer to Transaction-Number

--- Page 44 ---

Page 44 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
Returns: Error constant (DoPERR_xxxx)
DoPEBitOutDef structure:
typedef struct                         /* Definition of bit input            */
  {                                    /* ---------------------------------- */
  WORD Connector;                      /* Connector number of device     [No]*/
  WORD StopMask;                       /* Set bits stop the machine      [No]*/
  WORD StopLevel;                      /* Active level mask of StopMask  [No]*/
  } DoPEBitInDef;
4.17 DoPERdMachineDef
DoPE_HANDLE DP
DoPEMachineDef FAR *MachineDef
Read definitions of active machine of opened set-up.
In: DoPEHdl DoPE link handle
*MachineDef Pointer for DoPEMachineDef structure
Returns: Error constant (DoPERR_xxxx)
4.18 DoPEWrMachineDef(Sync)
DoPE_HANDLE DP
DoPEMachineDef FAR *MachineDef
WORD FAR                            *lpusTAN          (not for Sync. version)
Write definitions of active machine to opened set-up.
In: DoPEHdl DoPE link handle
*MachineDef Pointer for DoPEMachineDef structure
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
DoPEMachineDef structure:
typedef struct                         /* Definition of machine data         */
  {                                    /* ---------------------------------- */
  double SpeedCtrlTime;                /* Speed controller cycle time     [s]*/
                                       /*                    [0.5ms .. 2.5ms]*/
  double PosCtrlTime;                  /* Position controller cycle time  [s]*/
  WORD   CtrlStructure;                /* Closed loop control structure  [No]*/
  double DataAqTime;                   /* Data acquisition cycle time     [s]*/
  WORD   Mode;                         /* Data acquisition or control   [1/0]*/
  WORD   Bypass;                       /* Bypass for hydraulic          [1/0]*/
  WORD   XheadDir;                     /* Machine moves up/down         [1/0]*/
                                       /* with positive output signal        */
  double MotorEncRatio;                /* Transmis. ratio motor-encoder [No] */
  double EncXheadRatio;                /* Ratio encoder-Xhead     [Rev/Unit] */
  double BrakeOpen;                    /* Delay time to open brake after  [s]*/
                                       /* closed loop control is active      */
  double BrakeClose;                   /* Delay time to close brake before[s]*/
                                       /* closed loop control is deactivated */
  double PistonArea;                   /* Area of piston for hydraulic   [m²]*/
  double LoadMax;                      /* Max. load capacity of machine   [N]*/
  double Load100;                      /* Nominal load of machine         [N]*/
  double Stiffness;                    /* Over all stiffness of machine [N/m]*/
  short  UnUsed1;                      /* Unused                             */
  short  UnUsed2;                      /* Unused                             */
  WORD   ClampConnector;               /* Clamp: connector number        [No]*/
  WORD   ClampChannel;                 /* Clamp: channel                 [No]*/
  WORD   ClampActive;                  /* Clamp: active Low/High         [No]*/

--- Page 45 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 45 of 145DoPE
  WORD   ShieldConnector;              /* Shield: connector number       [No]*/
  WORD   ShieldType;                   /* Shield: type simple/locked     [No]*/
  double ShieldTimeout;                /* Shield: timeout                 [s]*/
  } DoPEMachineDef;
4.19 DoPERdLinTbl
DoPE_HANDLE DP
DoPELinTblFalse FAR *LinTblFalse
DoPELinTblTrue FAR *LinTblTrue
Read linearisation table of opened set-up.
In: DoPEHdl DoPE link handle
*LinTblFalse Pointer to measured values structure
*LinTblTrue Pointer to reference values structure
Returns: Error constant (DoPERR_xxxx)
4.20 DoPEWrLinTbl(Sync)
DoPE_HANDLE DP
DoPELinTblFalse FAR *LinTblFalse
DoPELinTblTrue FAR *LinTblTrue
WORD FAR                            * lpusTANFirst      (not for Sync. version)
WORD FAR                            * lpusTANLast       (not for Sync. version)
Write linearisation table to opened set-up.
In: DoPEHdl DoPE link handle
*LinTblFalse Pointer to measured values structure
*LinTblTrue Pointer to reference values structure
*lpusTANFirst Pointer to first Transaction-Number
*lpusTANLast Pointer to last Transaction-Number
Returns: Error constant (DoPERR_xxxx)
DoPELinTblFalse and DoPELinTblTrue structure:
typedef struct                         /* Definition of linearisation table  */
  {                                    /* ---------------------------------- */
  WORD     LinNo;                      /* Number of points for mode lin. [No]*/
  double   FalseValue[LIN_DATA_MAX];   /* Measured value by the EDC       [N]*/
  } DoPELinTblFalse;
typedef struct                         /* Definition of linearisation table  */
  {                                    /* ---------------------------------- */
  WORD     LinNo;                      /* Number of points for mode lin. [No]*/
  double   TrueValue[LIN_DATA_MAX];    /* True value measured by the      [N]*/
                                       /* reference system                   */
  } DoPELinTblTrue;

--- Page 46 ---

Page 46 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
4.21 DoPERdGeneralData
DoPE_HANDLE DP
DoPEGeneralData FAR *GeneralData
Read general data of opened set-up.
In: DoPEHdl DoPE link handle
*GeneralData Pointer for DoPEGeneralData structure
Returns: Error constant (DoPERR_xxxx)
4.22 DoPEWrGeneralData(Sync)
DoPE_HANDLE DP
DoPEGeneralData FAR *GeneralData
WORD FAR                            *lpusTAN          (not for Sync. version)
Write general data to opened set-up.
In: DoPEHdl DoPE link handle
*GeneralData Pointer for DoPEGeneralData structure
*lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
DoPEGeneralData structure:
typedef struct                         /* General data                       */
  {                                    /* ---------------------------------- */
  WORD   MachineNo;                    /* Number of active machines      [No]*/
  WORD   MachineNoIo;                  /* Use IO's to select machine    [1/0]*/
                                       /* number (only EDC100, EDC60 and EDC120*/
  WORD   Supervisor;                   /* Supervisor mode                [No]*/
  WORD   SuperPassword;                /* Supervisor Password(0=inactive)[No]*/
  WORD   UserPassword;                 /* User       Password(0=inactive)[No]*/
  WORD   Logo;                         /* DOLI Logo (0 = inactive)       [No]*/
  } DoPEGeneralData;

--- Page 47 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 47 of 145DoPE
4.23 DoPESelSetup
DoPE_HANDLE DP
unsigned short SetupNo
UserScale FAR US
WORD  FAR *lpusTANFirst
WORD  FAR *lpusTANLast
Select a machine set-up and initialise.
Set-up number 1 to 4 are stored inside EDC in a EEPROM. Set-up number 0 is the working set-up.
If set-up 1 to 4 is selected, set-up data and basi c tare values are copied from the EEPROM to the
working set-up 0.
If set-up 0 is selected, set-up da ta in the working set-up 0 are not altered. Basic tare  values cannot
be stored permanently inside EDC. Thus if set- up 0 was written completely by PC, this data are
used to initialise the system.
The DoPESelSetup function calls DoPEInitialize to do system initialisation.
In: DoPEHdl DoPE link handle
SetupNo Set-up No.
US User scale for all measuring channels.
The measured data will be multiplied with the value in US.e.g. use this to convert the SI unit meter into mm
by setting the UserScale to 1000 for the position channel.
lpusTANFirst Pointer to first transaction number.
lpusTANLast Pointer to last transaction number.
Returns: Error constant (DoPERR_xxxx)
4.24 DoPERdSensorInfo
DoPE_HANDLE DP
unsigned short SensorNo
DoPESumSenInfo FAR *Info
Read summary sensor information’s.
In: DoPEHdl DoPE link handle
SensorNo Sensor Number
*Info Pointer for SumSenInfo structure
Returns: Error constant (DoPERR_xxxx)
DoPESumSenInfo structure:
typedef struct                         /* Summary Sensor Information         */
  {                                    /* ---------------------------------- */
  WORD   Connector;                    /* Connector number of sensor     [No]*/
  double NominalValue;                 /* Nominal value of sensor      [Unit]*/
  WORD   Unit;                         /* Unit of sensor UNIT_xxx        [No]*/
  double Offset;                       /* Offset of sensor             [Unit]*/
  double UpperLimit;                   /* Upper range limit of sensor  [Unit]*/
  double LowerLimit;                   /* Lower range limit of sensor  [Unit]*/
  WORD   SensorState;                  /* Sensor state SEN_STATE_xxx     [No]*/
  WORD   McType;                       /* Measuring channel type         [No]*/
  double UpperSoftLimit;               /* Upper soft limit             [Unit]*/
  double LowerSoftLimit;               /* Lower soft limit             [Unit]*/

--- Page 48 ---

Page 48 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
  WORD   SoftLimitReaction;            /* reaction if soft limit         [No]*/
  double BasicTare;                    /* Basic   tare                 [Unit]*/
  } DoPESumSenInfo;
4.25 DoPERdSysUserData
DoPE_HANDLE DP
BYTE FAR *SysUsrData
unsigned Length
Read system user data (16 Byte). The applicat ion program may use this 16 bytes EEPROM to store
information permanently outside PC. It may be  used for software protection or similar.
In: DoPEHdl DoPE link handle
*SysUsrData Pointer for SYSEEPROM user data
Length* User data buffer length in BYTE's
Returns: Error constant (DoPERR_xxxx)
4.26 DoPEWrSysUserData(Sync)
DoPE_HANDLE DP
BYTE FAR *SysUsrData
unsigned Length
WORD FAR                            *lpusTAN          (not for Sync. version)
Write system user data (16 Byte).
In: DoPEHdl DoPE link handle
*SysUsrData Pointer for SYSEEPROM user data
Length* User data buffer length in BYTE's
*lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 49 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 49 of 145DoPE
4.27 DoPERdSenUserData
DoPE_HANDLE DP
BYTE FAR *SenUsrData
unsigned Length
Read sensor user data (128 Byte). The applic ation program may use this 128 bytes EEPROM data
to store information about the sensor. The EEPROM is located insi de the sensor plug!
In: DoPEHdl DoPE link handle
*SenUsrData Pointer for Sensor-EEPROM user data
Length* User data buffer length in BYTE's
Returns: Error constant (DoPERR_xxxx)
4.28 DoPEWrSenUserData(Sync)
DoPE_HANDLE DP
BYTE FAR *SenUsrData
unsigned Length
WORD FAR                            *lpusTAN          (not for Sync. version)
Write sensor user data (128 Byte).
In: DoPEHdl DoPE link handle
*SenUsrData Pointer for Sensor-EEPROM user data
Length* User data buffer length in BYTE's
*lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
4.29 DoPERdSensorUserData
DoPE_HANDLE DoPEHdl
WORD Connector
BYTE *SenUsrData
unsigned Length
This function has the same effect as DoPERd SenUserData. But use here a connector number
instead of a sensor number. It may also  be used for not initialized sensors.
Read sensor user data (128 Byte). The applic ation program may use this 128 bytes EEPROM data
to store information about the sensor. The EEPROM is located inside the sensor plug!
In: DoPEHdl DoPE link handle
Connector Connector number of sensor
*SenUsrData Pointer for sensor user data
Length User data buffer length in BYTE’s
Returns: Error constant (DoPERR_xxxx)

--- Page 50 ---

Page 50 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
4.30 DoPEWrSensorUserData
DoPE_HANDLE DoPEHdl
WORD Connector
BYTE *SenUsrData
unsigned Length
This function has the same effect as DoPEWr SenUserData. But use here a connector number
instead of a sensor number. It may also  be used for not initialized sensors.
Write sensor user data (128 Byte).
In: DoPEHdl DoPE link handle
Connector Connector number of sensor
*SenUsrData Pointer for sensor user data
Length User data buffer length in BYTE’s
Returns: Error constant (DoPERR_xxxx)

--- Page 51 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 51 of 145DoPE
5 Message and Data handling
5.1 DoPESendMsg(Sync)
DoPE_HANDLE DoPEHdl
void FAR *Buffer
unsigned Length
WORD FAR *lpusTAN
Send a message to EDC. This function is only needed if you have to communicate directly to
EDC's Subsystem. The message must be a command to the subsystem (see struct below).
Refer Documentation Subsystem for Test Machine Control.
Attention: This function is not av ailable for Visual Basic program's!
In: DoPEHdl DoPE link handle
Buffer Pointer to message to transmit
Length Message length in bytes
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
struct
  {
    unsigned short    Typ;    /* command number see pmx.h subsystem header */
    unsigned short    usTAN;  /* space for TAN                             */
    aPSxxxx           Usr;    /* command specific data see pmx.h           */
  } Buf;
5.2 DoPEGetMsg
DoPE_HANDLE DoPEHdl
void FAR *Buffer
unsigned BufSize
unsigned FAR *Length
Get a message from receive buffer. Incoming me ssages (from EDC) are stored inside DoPE. If
enabled by DoPESetNotification, DoPE  will signal the incoming message by
"DoPEEVT_RXAVAIL" event. You can read a stored message with this command.
Messages may be error messages, end of positioni ng message, run time errors or sensor messages
(see below).
In: DoPEHdl DoPE link handle
Buffer Pointer to message buffer
BufSize Buffer size in bytes
Length Pointer to store received message length
Out: *Buffer Message
*Length Message length in bytes
Returns: Error constant (DoPERR_xxxx)

--- Page 52 ---

Page 52 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
5.2.1 Command error messages
The parameter of all DoPE commands are checked and if not correct a erro r message is generated.
Due to the remote state of EDC this error messa ge is received from the PC some few milliseconds
after the command has been transmitted. Synchr onous DoPE command wait util the result of the
parameter check is received and pas the result as the function return value.
Asynchronous DoPE commands do not wait. The error message must be read by DoPEGetMsg
function.
Structure of command error messages:
  typedef  struct  DoPECommandError   /* Command error                        */
    {                                 /* ------------------------------------ */
    unsigned short     CommandNumber; /* Number of command                    */
    unsigned short     ErrorNumber;   /* Number of error                      */
    } DoPECE;
List of command errors:
CMD_ERROR_NOERROR (0)
No error with this command, the command was executed.
CMD_ERROR_PARCORR (1001)
Parameter error:One or more of the parameters exceeds the allo wable limits. These parameters were corrected to
the associated limiting value. The command was executed.
CMD_ERROR_PAR (1003)
Parameter error:One or more of the parameters exceeds the allowable limits. Therefore the command was not
clearly interpretabl e and not executed.
CMD_ERROR_XMOVE (1004)
Cross-head is not halted. Command not executed.
CMD_ERROR_INITSEQ (1005)
Sequence during the initialisa tion of the controller not observed. Command not executed.
CMD_ERROR_NOTINIT (1006)
Controller part not ini tialised. Command not executed.
CMD_ERROR_DIR (1007)
Required direction of movement is not perm issible at the moment, because a corresponding
error exists. Command not executed.
CMD_ERROR_TMP (1008)
Required resource is used at the moment. Command not executed.
CMD_ERROR_RUNTIME (1009)
Active runtime error. Command not executed.
CMD_ERROR_INTERN (1010)
Internal controller fault. Command not executed.
CMD_ERROR_MEM (1011)
Insufficient memory capacity for the execution of the order. Command not executed. 
CMD_ERROR_CST (1012)
Wrong controller Structure for this command. 
CMD_ERROR_NIM (1013)
Command not implemented. 

--- Page 53 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 53 of 145DoPE
CMD_ERROR_MSGNO (2001)
Unknown message ID.
CMD_ERROR_VERSION (2003)
Wrong PE interface version.
CMD_ERROR_OPEN (2004)
Set-up not opened.
CMD_ERROR_MEMORY (2005)
Not enough memory.
5.2.2 Run-time error messages
Errors or events that happen during the system is  running, are reported to the application program as
run-time errors.
Structure of run-time error message:
  typedef  struct  DoPERunTimeError   /* Run time error (old style)               */
    {                                 /* -----------------------------------------*/
    unsigned short     ErrorNumber;   /* Number of run time error                 */
    double             Time;          /* System time the error occurred           */
    unsigned short     Device;        /* Device Number responsible for the error  */
    unsigned short     Bits;          /* Responsible bits if digital input device */
    } DoPERTE;
Currently a DoPE user cannot (or only with deep inside knowledge)  interpret the parameters device
and bits. But in most cases it is not necessary to us e this two parameter. The error number is sufficient
to display helpful error messages on screen.
In later DoPE versions there wi ll be more detailed error messages.
List of run-time errors:
RTE_ERROR_S (101)
X-Head position contro ller deviation error.
The difference between command and measured  value is too big. Increase “deviation”
parameter in “DoPECtrlSenDef” set- up structure or optimise control loop.
RTE_ERROR_F (102)
Load controller deviation error.
RTE_ERROR_E (103)
Extension controller deviation error.
RTE_EMOVE_END (104)
Emergency movement is finished but run-time error is still active.
RTE_DRIVE_OFF (201)
Drive was switched off.
RTE_E_MOVE_RQ (202)
Drive was switched off. A emergency driv e is possible to clear this situation.
RTE_UPPER_LIMIT_SWITCH (203)
Drive was switched off due to an active upper limit switch.
RTE_LOWER_LIMIT_SWITCH (204)
Drive was switched off due to an active lower limit switch.

--- Page 54 ---

Page 54 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
RTE_STOP (205)
Drive not ready.
RTE_DF_KEY (206)
“Drive enable” output signal was withdraw n due to an inactive  input signal “Drive
enable”.
RTE_SHALT (207)
Machine was halted in position control due to a active input signal. This normally happens
after “STOP” key at EDC front panel was pressed.
RTE_UPPER_LIMIT (301)
Upper range limit exceeded.
RTE_LOWER_LIMIT (302)
Lower range limit exceeded.
RTE_ERROR_UNHANDLED (999)
Unknown runtime error.
5.2.3 Movement control messages
Positioning, or in general movement commands, re port their regular or irregular completion with
movement control messages. There are four different  structures to access di fferent parameter. Please
refer to the list of movement control messages below.
  typedef  struct  DoPEMoveCtrlMsg    /* Messages of movement control         */
    {                                 /* ------------------------------------ */
    unsigned short     MsgId;         /* ID of message                        */
    double             Time;          /* System time for the message          */
    unsigned short     Control;       /* Control mode of position             */
    double             Position;      /* Position                             */
    unsigned short     DControl;      /* Control mode of destination position */
    double             Destination;   /* Destination position                 */
    } DoPEMCM;
  typedef  struct  DoPESftMsg         /* 'Softend' Message                    */
    {                                 /* ------------------------------------ */
    unsigned short     MsgId;         /* ID of message                        */
    double             Time;          /* System time for the message          */
    unsigned short     Control;       /* Control mode of position             */
    double             Position;      /* Position                             */
    } DoPESftM;
  typedef  struct  DoPEOffsCMsg       /* 'Offset-Correction' Message          */
    {                                 /* ------------------------------------ */
    unsigned short     MsgId;         /* ID of message                        */
    double             Time;          /* System time for the message          */
    double             Offset;        /* Power Amplifier Offset               */
    } DoPEOffsCM;
  typedef  struct  DoPECheckMsg       /* 'Measuring Channel Supervision' Msg. */
    {                                 /* ------------------------------------ */
    unsigned short     MsgId;         /* ID of message                        */
    double             Time;          /* System time for the message          */
    unsigned short     CheckId;       /* ID of Measuring Channel Check        */
    double             Position;      /* Position                             */
    } DoPECheckM;
typedef  struct  DoPERefSignalMsg     /* 'Reference Signal' Message           */
  {                                   /* ------------------------------------ */
    unsigned short     MsgId;         /* ID of message                        */
    double             Time;          /* System time for the message          */
    unsigned short     SensorNo;      /* Control mode of position             */
    double             Position;      /* Position                             */
  } DoPERefSignalM;

--- Page 55 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 55 of 145DoPE
List of movement control messages:
CMSG_POS (1) use DoPEMCM
A positioning command has been successfully competed and the machine reached the
destination window within th e specified time. The parameter “Control” and “Position”
represent the position genera tor values after the command has been completed. The
Parameter “Dcontrol” and “Destination” re present the destination position of the
positioning command. For positioning commands without an explicit destination, these
values are identical with “Control” and “Position”.
CMSG_UPPER_SFT (2) use DoPESftM
CMSG_ LOWER _SFT (3) use DoPESftM
During the positioning process,  a configured softend for the supervision of movement
sequences was overrun. The parameters “Cont rol” and “Position” provide information
concerning the control type of the overrun soft end, as well as the actual position in this
control channel at the time of recognition of the softend fault. 
CMSG_POS_ERR (4) use DoPEMCM
A positioning command has been competed and the machine did not reach  the destination
window within the specified time. The paramete rs “Control” and “Pos ition” represent the
actually reached machine position after . the command has been completed. The Parameter
“Dcontrol” and “Destination” represent the destination posi tion of the movement
command. For positioning commands without an explicit destination, these values are
identical with “Control” and “Position”.
CMSG_TPOS (6) use DoPEMCM
A triggering position of the movement seque nces has been reached. The parameters
“Control” and “Position” suppl y the position in the triggeri ng channel actual at time of
triggering. At intermediate destinations  of combined movement sequences with
destination window supervision, this is the actual command value, otherwise it is the
actual value of the triggeri ng channel. The parameters “Dcontrol” and “Destination”
supply the destination-respectively triggeri ng position, given in the movement command. 
CMSG_TPOS_ERR (7) use DoPEMCM
The destination window around the destination position of the movement command, was
not reached within the specified time. The pa rameters “Control” and “Position” specify
the position actually reached at the time of  recognition of this positioning fault. The
parameters “Dcontrol” and “Destination” represent the destina tion position of the
movement command. For positioning commands without an explicit destination, these
values are current values of the position generator. 
CMSG_LPOS (8) use DoPEMCM
The destination window around the limit pos ition of the movement command, was
reached within the specified time. The para meters “Control” and “Position” supply the
position, reached by the position generator. Th e parameters “Dcontrol” and “Destination”
supply the specified destination position of the movement command. For positioning
commands without an explicit destination, these values are identical with “Control” and
“Position”.
CMSG_LPOS_ERR (9) use DoPEMCM
The destination window around the limit position of the movement command, was notreached within the specified time. The parame ters “Control” and “Position” specify the
position actually reached at the time of r ecognition of this positioning fault. The
parameters “Dcontrol” and “Destination” repr esent the destination respectively triggering
position of the movement command. For pos itioning commands without an explicit
destination, these values are current values of the position generator. 

--- Page 56 ---

Page 56 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
CMSG_OFFSET (49) use DoPEOffsCM
The offset correction run has been termin ated successfully. The parameter “Offset”
contains the determined offs et of the power amplifier. 
CMSG_CHECK (51) use DoPECheckM
One of the active measurement channel superv isions has triggered. The action defined for
this supervision was started. The parameter “CheckId” contains the identification of thesupervision, and the parameter “Position” th e position of the supervised measurement
channel, which has led to the triggering. 
CMSG_CHECK_ERR (52) use DoPECheckM
One of the active measurement channel superv isions has triggered. The action defined for
this supervision was not started, because th e direction of movement defined through the
action was not possible due to an active soft end. The parameter “CheckId” contains the
identification of the supervision, and the parameter “Position” the position of the
supervised measurement channel, which has led to the triggering. 
CMSG_SHIELD (53) use DoPECheckM
The protective screen superv ision has triggered. The acti on defined was started. The
parameter “CheckId” contains the identification of the s upervision, and the parameter
“Position” the position of the supervised m easurement channel, which has led to the
triggering.
CMSG_SHIELD_ERR (54) use DoPECheckM
The protective screen supervision has trigge red. The action defined was not started. The
parameter “CheckId” contains the identification of the s upervision, and the parameter
“Position” the position of the supervised m easurement channel, which has led to the
triggering.
CMSG_ REFSIGNAL (55) use DoPERefSignalM
Reference Signal of a incremental sensor occurred.
5.2.4 Sensor message (only serial sensors)
A serial “sensor” may be connected  via RS232 (X62A – X62D) to EDC60/120.
If it is specified with “NoProtocol”, it’s data ar e not interpreted by EDC or  Dope, but send to the
application program. Following message will be given to the application program:
typedef  struct  DoPESensorMsg        /* Sensor Message                       */
  {                                   /* ------------------------------------ */
    double         Time;              /* System time for the message          */
    unsigned short SensorNo;          /* Sensor Number 0 .. 15                */
    unsigned short Length;            /* Number of bytes in the message       */
    BYTE           Data[SENSOR_MSG_LEN]; /* Message                           */
  } DoPESensorM;

--- Page 57 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 57 of 145DoPE
5.3 DoPEGetData
DoPE_HANDLE DoPEHdl
void FAR *Buffer
Get samples from receiver buffer. DoPE receives m easuring data in a adjustable time scale. The
data record is stored inside Do PE in a circular buffer. You can read one data record with this
function. This data record will be deleted in the circular buffer. For definition of DoPEData
record refer to Page 128.
In: DoPEHdl DoPE link handle
Buffer Pointer to buffer for data record.
Buffer must be big enough to store the DoPEData structure
Out: *Buffer DoPEData record
Returns: Error constant (DoPERR_xxxx)

--- Page 58 ---

Page 58 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
5.4 DoPECurrentData
DoPE_HANDLE DoPEHdl
void FAR *Buffer
Get current samples from receiver buffer. This f unction reads the latest data record. This data
record will not be deleted in the circular buffer. For definition of DoPEData record refer to Page
128.
In: DoPEHdl DoPE link handle
Buffer Pointer to buffer for data record.
Buffer must be big enough to store the DoPEData structure
Out: *Buffer DoPEData record
Returns: Error constant (DoPERR_xxxx)
5.5 DoPEClearReceiver
DoPE_HANDLE DoPEHdl
Discard all received messages. If you want to get rid of old messages, that are of no interest any
more, use this command.
In: DoPEHdl DoPE link handle
Returns: Error constant (DoPERR_xxxx)
5.6 DoPEClearTransmitter
DoPE_HANDLE DoPEHdl
Discard all unsent transmitter buffers.
In: DoPEHdl DoPE link handle
Returns: Error constant (DoPERR_xxxx)
5.7 DoPEGetState
DoPE_HANDLE DoPEHdl
DoPEState FAR *Status
Get state information structure.
In: DoPEHdl DoPE link handle
Status Pointer to buffer for state information
Out: *Status State information (see below) 
Returns: Error constant (DoPERR_xxxx)
State information structure:
  typedef struct
    {
    unsigned  ComState;                /* Communication state                  */
    unsigned  RcvBuffer;               /* Number messages in receive queue     */
    unsigned  XmitBuffer;              /* Number of messages to be transmitted */
    } DoPEState;
Constants for ComState:
  #define COM_STATE_OFF        0         /* Link is disabled                  */

--- Page 59 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 59 of 145DoPE
  #define COM_STATE_OFFLINE    1         /* Link is offline                   */
  #define COM_STATE_INITCYCLE  2         /* Link is initialising              */
  #define COM_STATE_ONLINE     3         /* Link is established and OnLine    */
5.8 DoPEGetErrors
DoPE_HANDLE DoPEHdl
DoPEError FAR *Error
Get current error counter values. DoPE counts all sort of communi cation errors. You may read this
errors by using this command.
In: DoPEHdl DoPE link handle
Error Pointer to buffer for error counters
Out: *Error Current error counter values (see below) 
Returns: Error constant (DoPERR_xxxx)
The DoPEError-structure contains several comm unication error counters. Whenever an error is
detected, the appropriate counter is increased by one. This error c ounters are useful to annualise
communication problems.
typedef  struct                        /* Error counters                */
    {
    unsigned   Parity;                 /* Parity errors                 */
    unsigned   Overrun;                /* Overrun errors                */
    unsigned   Frame;                  /* Framing errors                */
    unsigned   InvACK;                 /* Invalid ACKs received         */
    unsigned   NoBuffer;               /* No receiver buffer available  */
    unsigned   DLESeq;                 /* Invalid DLE sequence          */
    unsigned   BufOFlow;               /* Receiver buffer overflow      */
    unsigned   BccErr;                 /* Checksum error                */
    unsigned   MwError;                /* Invalid sample encoding       */
    } DoPEError;

--- Page 60 ---

Page 60 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
6 Configuration
6.1 DoPERdVersion
DoPE_HANDLE DP
DoPEVersion FAR *Version
Read Version strings.
In: DoPEHdl DoPE link handle
Version Version strings
Returns: Error constant (DoPERR_xxxx)
6.2 Data Acquisition commands
6.2.1 DoPERefr(Sync)
DoPE_HANDLE DP
double Refresh
WORD FAR                            *lpusTAN          (not for Sync. version)
Set time base for data acquisition. The default re fresh time is defined in the set-up data and is
normally 0.02 sec. You may change it according to your needs.
In: DoPEHdl DoPE link handle
Refresh Time in s
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
6.2.2 DoPESetTime(Sync)
DoPE_HANDLE DP
double Time
WORD FAR                            *lpusTAN          (not for Sync. version)
Set time counter to a desired value.
In: DoPEHdl DoPE link handle
Time New value for Time in s
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 61 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 61 of 145DoPE
6.2.3 DoPETransmitData(Sync)
DoPE_HANDLE DP
unsigned short Enable
WORD FAR                            *lpusTAN          (not for Sync. version)
Activate / Deactivate transmission of data. If de activated no measuring data will be transmitted to
the PC! 
In: DoPEHdl DoPE link handle
Enable TRUE  = Activate transmission
FALSE = Deactivate transmission
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
6.2.4 DoPEIntgr(Sync)
DoPE_HANDLE DP
unsigned short SensorNo
double Intgr
WORD FAR                            *lpusTAN          (not for Sync. version)
Set time of integration for an analogue measuri ng channel. Normally in tegration time is set to
20 ms. If this time is increased to a higher valu e e.g. 250 ms, resolution is  increased and noise is
decreased. For example you have a 100 kN load cel l and you display 1 N as the smallest value.
You reach this resolution at about 20 ms. Now you increase the time to 250 ms and you still displayonly 1 N steps, your signal noise will be reduced. You may use this effect for a stable load display
while no test is running. Set integration time alwa ys to 250 ms while no test is running and just
before starting a test reduce it to e.g. 20 ms.
Note: The integration time is independent from the re fresh time (DoPERefr). It is possible to set the
refresh time to 20 ms and th e integration time to 250 ms.
In: DoPEHdl DoPE link handle
SensorNo Sensor Number 0 .. 9
Intgr Integration time for analogue measuring channels in sec. The 
limits of integration time depend on the selected time base
for the speed control loop cycle time. 
(see machine set-up data) The minimum time is 
1 x (time base for the speed control) The maximum time
is 100 x (time base for the speed control) 
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 62 ---

Page 62 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
6.2.5 DoPECtrlTestValues
DoPE_HANDLE DP
unsigned short State
Enable or disable the controller Te st values in the DoPEData record.
The three Test values are configured to:
Test1: Command
Test2: Feedback
Test3: Output
In: DoPEHdl DoPE link handle
State TRUE:  enables
FALSE: disables the controller test  values in the DoPEData record.
Returns: Error constant (DoPERR_xxxx)
6.3 Safety Shield
In order to protect the user from injures, the EDC c ontains a shield control. Two different shield types
will be supported, simple and lockable shields. Th e allocations of the digital in- and outputs depend
on the device selected in EDC-Set-up:
EDC100 Pin X2: (only simple shield)
Bit 10 Pin 10 Shield closed
Bit 11 Pin 3 Shield exists
4INC/4IO Pin B: (simple and locked shield)
Bit 0 Pin 27 Shield exists
Bit 1 Pin 8 Shield closedBit 2 Pin 26 Shield is lockedBit 3 Pin 7 Shield Test (key-switch)
Bit 6 Lock Shield
Pin 29 Relay common contactPin 10 Relay open contactPin 28 Relay close contact
EDC60/120 shield option connector X10:
Bit 8 Pin 4 Shield exists
Bit 9 Pin 5 Shield closedBit 10 Pin 9 Shield is lockedBit 11 Pin 10 Shield SETUP (key switch)Bit 14 Lock shield
Pin 3 Relays CommonPin 8 Relays OpenPin 2 Relays Close
Simple Shield operation:

--- Page 63 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 63 of 145DoPE
The following picture illustrates the input si gnals of the simple shield control. 
Shield exists
Shield closedInput SignalsLimit loads
S-HaltSimple Shield
Control
Meaning of the Signals:
1. Shield exists
indicates the existence of the necessary hardware for the shield control.
2. Shield closed
indicates that the shield is closed  (has been closed by the user). 
Simple Shield Control:
As long as the shield does not re port 'closed', the loads limit LwrLock and UprLock will be checked
permanently and the speed of X-head will be limite d to SpeedLimit. If one load limit is exceeded, the
X-head will be stopped position controlled. In this case, the user has to close the shield. When the
shield reports 'closed', the X-head can be driven  within the given nominal speed. The shield can be
opened when the load remain under the limit loads.  But if the shield gets  opened despite the limit
loads being exceeded, the X-head will stop position controlled. 

--- Page 64 ---

Page 64 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
Lockable Shield:
The following picture illustrates the input- and output  signals of the lockable shield control. 
S hield exists
S hield closed
S hield locked
L ock shieldS hield T E S T
(key-sw itch)Input signals
Out put si gnalsL im it loads
S-Hal tL ockable Shield
Cont r ol
Meaning of the Signals:
1. Shield exists
indicates the existence of the necessary hardware for the shield control.
2. Shield closed
indicates that the shield is closed  (has been closed by the user). 
3. Shield locked
The shield has been locked via the fitting output.
4. Shield TEST
Key-switch at the shield enables the authorised user  to drive the instrument even if the shield is
not locked. 
5. Lock shield
Activates the locking mechanism at the shield.
Lockable Shield Control:
1. Key-switch is not in position TEST:
As long as the shield does not report 'closed' , the load limits LwrLock and UprLock will be
checked permanently and the X-head speed will be limited to SpeedLimit. If one of the load limitsis exceeded, the X-head will be stopped position cont rolled. In this case, the user has to close the
shield. The shield will be locked automatically. When the shield reports 'closed', the X-head canbe driven within the given nominal speed. The shield will be unlocked automatically and can be
opened when the loads rema in under the load limits.
2. Key-switch is in position TEST:
All shield detection's are off. The X-head can  be driven within the given nominal speed.
This is an example in order to illustrate the shield control:
ShMax = 1 kN
ShMin = -1 kN0 NLoad
No limitation if the shield is
closed and lockedKey switch is in
position TESTKey switch is in
position SETUP
Shield can be open. X-head
speed is limited to vMax
No limitation if the shield is
closed and lockedNo limitation

--- Page 65 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 65 of 145DoPE
6.3.1 DoPEShieldLimit(Sync)
DoPE_HANDLE DP
unsigned short SensorNo
double UprLock
double UprUnLock
double LwrUnLock
double LwrLock
unsigned short CtrlLimit
double SpeedLimit
unsigned short CtrlAction
unsigned short Action
WORD FAR                            *lpusTAN          (not for Sync. version)
Activate the shield supervision.
Attention: The values for UprLock, UprUnLock, LwrU nLock and LwrLock are calculated with
the current Tare and BasicTare.If BasicTare is changed, while shield supervision is still active, these values arerecalculated with the new BasicTare.A new Tare does not effect these vales!
In: DoPEHdl DoPE link handle
SensorNo Sensor Number 0 .. 15
UprLock For all load values higher than this the shield must be closed and will
be locked.
UprUnLock Upper limit for unlock the shield. (e.g. 10 % lower than UprLock)
LwrUnLock Lower limit for unlock the sh ield (e.g. 10 % highe r than LwrLock).
LwrLock For all load values lower than th is the shield must be closed and will
be locked.
CtrlLimit Control mode for speed limit (normally X-head)
SpeedLimit Maximum allowed speed if shield is open.
CtrlAction Control mode for selected action
Action This action will be activat ed if the limits are reached
FB_HALT: Halt machine in ‘CtrlAction’ control mode.FB_STOP: Switch off close loop control.
(Use this action for machin es without position sensor)
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
6.3.2 DoPEShieldDisable(Sync)
DoPE_HANDLE DP
WORD FAR                            *lpusTAN          (not for Sync. version)
Deactivate the shield supervision.
In: DoPEHdl DoPE link handle
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 66 ---

Page 66 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
6.3.3 DoPEShieldLock(Sync)
DoPE_HANDLE DP
WORD State
WORD FAR                            *lpusTAN          (not for Sync. version)
Lock or unlock the shield.
In: DoPEHdl DoPE link handle
State State of Shield lock. (TRUE = Lock, FALSE = UNLOCK)
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
6.4 Channel supervision
6.4.1 DoPESetCheck(Sync)
6.4.2 DoPESetCheckX(Sync)
DoPE_HANDLE DP
unsigned short CheckId
unsigned short SensorNo
double Limit
double                                     Tare                   (only for DoPESetCheckX)
unsigned short Mode
unsigned short Action
unsigned short Ctrl
double Acc
double Speed
double Dec
double Destination
WORD FAR *lpusTAN
Activate measuring channel supervision.
As support for special condition movement sequen ces, up to ten measurement channel supervisions
are provided, all may be simulta neously active. Each supervisi on consists of the condition to
supervise and the associated ac tion. Supervisions are applicable to all configured measuring
channels also for calculated ch annels if configured. All possibl e conditions and actions are listed
below.
The condition of all active supervisi ons will be checked every 20 ms.
If a supervision condition hits, the associated action will be executed, an appropriate message
transmitted and all supervisions which are not marked with the CHK_NOCLEAR bit are
deactivated.
In: DP DoPE link handle
CheckId ID of this check, use the Ch eckId constants (C HK_ID0 ... CHK_ID9)
If the check should no be clea red after an other check hits,
or the CheckId with CHK_NOCLEAR.
SensorNo Sensor to be supervised
Limit Limit to be supervised
Tare Tare to be subtracted  for CHK_PERCENT_MAX/MIN mode

--- Page 67 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 67 of 145DoPE
Mode Mode, how the limit is detected. (see below)
Action This action will be activated  if the check hits. (see below)
Ctrl Control mode for selected action
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Acc Acceleration
Speed maximum speed
Dec Deceleration
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
Possible modes:
CHK_BELOW Action if Limit value<
CHK_ABOVE Action if Limit value>
The following mode are only valid for DoPESetCheckX command:
CHK_PERCENT_MAX Action if100* .max. .maxLimit valuevalue actual value > −
CHK_PERCENT_MIN Action if100* .min.min .Limit valuevalue value actual > −
CHK_ABS_MAX Action if Limit value actual value > − . .max
CHK_ABS_MIN Action if Limit value value actual > − .min .
Possible actions:
ACTION_HALT HALT with default deceleration
ACTION_HALT_A HALT with specified deceleration
ACTION_POS Position with default deceleration
ACTION_POS_A Position with specified deceleration
ACTION_XPCONT Change control mode, go on with current speed
ACTION_STOP STOP (switch off drive)
ACTION_NOACTION No action, only message to host
ACTION_SETOL Set command output (only in open loop structure)
ACTION_SHAL Immediate Halt in X-head position control
ACTION_UP Move Up with specified speed
ACTION_DOWN Move Down with specified speed
6.4.3 DoPEClrCheck(Sync)
DoPE_HANDLE DP
unsigned short CheckId
WORD FAR                            *lpusTAN          (not for Sync. version)
Deactivate a measuring channel supervision
In: DoPEHdl DoPE link handle
CheckId ID of this check, (CHK_ ID0 ... CHK_ID9 or CHK_ID_ALL)
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 68 ---

Page 68 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
6.4.4 DoPESetCheckLimit(Sync)
DoPE_HANDLE DP
unsigned short SensorNo
double UprLimitSet
double UprLimitReset
double LwrLimitReset
double LwrLimitSet
WORD FAR                            *lpusTAN          (not for Sync. version)
Activate a limit supervision for a measuring channe l. If the measured value is outside UprLimitSet
or LwrLimitSet a digital output wi ll be set. This function may be us ed to prevent opening of clamps
under load. The allocation of th e digital output depend on the de vice selected in EDC-Set-up. 
EDC100 X2 Bit 14, Pin 6
EDC60/120 X2 Bit 3, Pin 84INC/4IO Xxx Bit 0, Pin 32
Attention: The values for UprLimitSet, UprLimitRes et, LwrLimitReset and LwrLimitSet are
calculated with the current Tare and BasicTare.If BasicTare is changed, while limit check is still active, these va lues are recalculated
with the new BasicTare.A new Tare does not effect these vales!
In: DoPEHdl DoPE link handle
SensorNo Defines the sensor to be supervised.
UprLimitSet For all values above, the digital output will be set.
UprLimitReset For all values below, the digital output will be reset
LwrLimitReset For all values above, the digital output will be reset
LwrLimitSet For all values below, the digital output will be set.
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
6.4.5 DoPEClrCheckLimit(Sync)
DoPE_HANDLE DP
WORD FAR                            *lpusTAN          (not for Sync. version)
Deactivate check limit function. The digital output will be set inactive.
In: DoPEHdl DoPE link handle
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 69 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 69 of 145DoPE
6.5 Controller Parameter
6.5.1 DoPEPosPID (Sync)
DoPE_HANDLE DoPEHdl
unsigned short MoveCtrl
unsigned long P
unsigned short I
unsigned short D
WORD FAR                            *lpusTAN          (not for Sync. version)
This function replaces the older function “DoPEC trlP”. The current DoPE version supports both
functions, but in future versions  the old function may be removed.
Set parameter for closed loop position controller.
In: DoPEHdl DoPE link handle
MoveCtrl Control mode
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
P Proportional gain of the position controller
I Integration time constant
Attention: Normally there is a speed control loop with an 
integration part. In such cases set I here to ZERO. Otherwise we 
have a control loop with two integration parts and this will never 
be stable!!
D Derivative time constant
Attention: For future use only
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
6.5.2 DoPESpeedPID(Sync)
DoPE_HANDLE DoPEHdl
unsigned short MoveCtrl
unsigned long P
unsigned short I
unsigned short D
WORD FAR                            *lpusTAN          (not for Sync. version)
This function replaces the older function “ DoPE CtrlP_Xp ”. The current DoPE version supports
both functions, but in future versi ons the old function may be removed.
Set parameter for closed loop speed controller. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
P Proportional gain of the speed controller

--- Page 70 ---

Page 70 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
I Integration time constant
D Derivative time constant
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
6.5.3 DoPEPosFeedForward(Sync)
DoPE_HANDLE DoPEHdl
unsigned short MoveCtrl
unsigned long P
WORD FAR                            *lpusTAN          (not for Sync. version)
This function replaces the older function “ DoPE CtrlPGKTd ”. The current DoPE version supports
both functions, but in future versi ons the old function may be removed.
Set feed forward gain of closed loop controller.
In: DoPEHdl DoPE link handle
MoveCtrl Control mode
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
P Gain for feed forward control.
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 71 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 71 of 145DoPE
6.5.4 DoPEDestWnd(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double WndSize
double WndTime
WORD FAR                            *lpusTAN          (not for Sync. version)
Definitions for destination window.
The closed loop controller supervises the controll ed channel. After the command value reaches the
final destination, the controlled ch annel has to reach this position with in in the specif ied destination
window. If the actual value reac hes the destination window w ithin the specified time the
positioning sequence if successfully finished. The message “CMSG_POS” is send to theapplication program. If it does not reach it, the message “CMSG_POS_ERR” is send. 
s
tCommand val ue
actual valuetimesize
In: DoPEHdl DoPE link handle
MoveCtrl Control mode
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
WndSize Size of destination window
WndTime Time for destination window
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 72 ---

Page 72 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
6.5.5 DoPESft(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double UpperSft
double LowerSft
unsigned short Reaction
WORD FAR                            *lpusTAN          (not for Sync. version)
Definitions of limits supervised by software (softend). All moving commands will limit
destinations to this softend’s.
The software limit switches, also called softend’s, fulfil several functions. They are used as limits,
the movement sequence control should not exceed under normal circumstances. However, incontrast to the range limits of the measuremen t channels, they are working limits that can be
changed during the operation of the machine in  some defined conditions. Additionally, the
softend’s can be used for the s upervision of movement sequences.
The softend’s provide the limits for the destination positions for movement instructions and are
implicitly used as destination positions for movement instructions. The state of the softend’s is
maintained in CtrlState2 (see default measuring dada record).
Attention: The values for UpperSft and LowerSft ar e calculated with the current Tare and
BasicTare.If BasicTare is changed, these values are recalculated with the new BasicTare.
A new Tare does not effect these vales!
In: DoPEHdl DoPE link handle
MoveCtrl Control mode
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
UpperSft Upper soft limit
LowerSft Lower soft limit
Reaction Action to be activat ed after softend is reached
Note: for the active control mode, the reaction is always
REACT_ACTION
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
REACT_STATUS only status bits are set
REACT_ACTION Halt in X-head position control

--- Page 73 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 73 of 145DoPE
6.5.6 DoPECtrlError(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Error
unsigned short Reaction
WORD FAR                            *lpusTAN          (not for Sync. version)
Define maximum error signal for cl osed loop controller. The closed  loop controller supervises the
error signal (command - measured value). If the error exceeds th e specified range, the desired
action will be activated.
In: DoPEHdl DoPE link handle
MoveCtrl Control mode
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Error Maximum error signal
Reaction Action to be activat ed after error is reached
REACT_ACTION is for:
CTRL_POS Emergency off
CTRL_LOAD Halt in Xhead control
CTRL_EXTENSION Halt in Xhead control
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
6.5.7 DoPESetDither  (Sync)
DoPE_HANDLE DP
unsigned short Output
double Frequency
double Amplitude
WORD FAR                            *lpusTAN          (not for Sync. version)
Set Parameter for dither. Some DOLI output amplif ier like D03I, D16I, D32I  have a digital dither
generator function. The dither amplitute and frequency can be set by this command.
In: DoPEHdl DoPE link handle
Output Number of analogue output channel
Frequency Dither frequency in Hz
Amplitude Dither aplitude in % of nominal output current.
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 74 ---

Page 74 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
6.5.8 DoPECtrlSpeedTimeBase(Sync)
DoPE_HANDLE DP
double Time
WORD FAR                            *lpusTAN          (not for Sync. version)
Define maximum time base for speed calculation.
When changing control mode, the current speed of the new control channel is used as the start
speed after control mode was changed. Normally this speed is determined by differentiation by two
following position values. In case of  a small resolution of the transducer for the new control mode,
the speed values are very small and thus also inaccurate. Using this command the time base can be
increased and thus a higher accuracy for speed ca lculation can be archived. Use this command only
if speed is not changing too fast ot herwise with a big time base the calculated speed is incorrect. .
This time base exclusively works for the determination of the start speed when control mode is
changed. It has no effect for speed cal culation for the digital speed controller.
In: DoPEHdl DoPE link handle
Time Time base in seconds.
internally only 1, 2, 4, 8, 16, 32, 64, 128 x position controller time 
base will be used!
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
6.6 Calibration
6.6.1 DoPEZeroCal(Sync)
DoPE_HANDLE DP
unsigned short SensorBits
WORD FAR                            *lpusTAN          (not for Sync. version)
Compensate only zero offset drift. It takes abou t 0.2 s to compensate zero offset drift. During
compensation the sensor is not measured!!! 
In: DoPEHdl DoPE link handle
SensorBits Bit 0 .. 15 define the se nsor Number to be calibrated. 
Bit 0 = 1 Calibrate zero offset of Sensor 0
Bit 1 = 1 Calibrate zero offset of Sensor 1 ... 
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
6.6.2 DoPECal(Sync)
DoPE_HANDLE DP
unsigned short SensorBits
WORD FAR                            *lpusTAN          (not for Sync. version)
Compensate drifts (zero and amplification) of the measuring channel. It takes about 0.5 s to
compensate drifts. During compensati on the sensor is not measured!!! 

--- Page 75 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 75 of 145DoPE
In: DoPEHdl DoPE link handle
SensorBits Bit 0 .. 15 define the se nsor Number to be calibrated. 
Bit 0 = 1 Calibrate Sensor 0
Bit 1 = 1 Calibrate Sensor 1 ... 
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 76 ---

Page 76 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
6.7 Tare functions
DoPE offers two different tare  functions, Tare and BasicTare.
The DoPESetBasicTare  function should be used for set-up th e machine configuration like changing
clamps. The Basic-Tare value is stored in the active machine set-up inside EDC. After switching
mains power off / on, the Basic-Tare value is still valid.
The simple DoPESetTare function can be used at any time. This  tare value will be lost after reset.
6.7.1 DoPESetBasicTare(Sync)
DoPE_HANDLE DP
unsigned short SensorNo
unsigned short Mode
double BasicTare
WORD FAR                            * lpusTANFirst      (not for Sync. version)
WORD FAR                            * lpusTANLast       (not for Sync. version)
Set basic tare of the measuring channel. Basi cTare value will be stored in EDC's non volatile
memory. This function clears  the ordinary tare value
In: DP DoPE link handle
SensorNo Sensor Number
Mode = 0 BasicTare represents  the desired measuring value.
This is useful to set cross-head position for systems with
encoder. 
Mode = 1 BasicTare will be subtracted.
This is useful to compensate the weight of clamps. 
BasicTare Value for BasicTare
lpusTANFirst Pointer to first transaction number.
lpusTANLast Pointer to last transaction number.
Returns: Error constant (DoPERR_xxxx)
6.7.2 DoPESetTare
DoPE_HANDLE DP
unsigned short SensorNo
double Tare
Set tare of the measuring channel. This ta re function may be used as a working tare.
In: DP DoPE link handle
SensorNo Sensor Number Mode
Tare Value to be subtracted. 
Returns: Error constant (DoPERR_xxxx)

--- Page 77 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 77 of 145DoPE
6.7.3 DoPEGetBasicTare
DoPE_HANDLE DP
unsigned short SensorNo
double  FAR *BasicTare
Read tare value of the measuring channel.
In: DP DoPE link handle
SensorNo Sensor Number
*BasicTare Pointer for BasicTare
Out: BasicTare Active value for BasicTare
Returns: Error constant (DoPERR_xxxx)
6.7.4 DoPEGetTare
DoPE_HANDLE DP
unsigned short SensorNo
double  FAR *Tare
Read tare value of the measuring channel
In: DP DoPE link handle
SensorNo Sensor Number
*Tare Pointer for tare
Out: Tare Active value for tare.
Returns: Error constant (DoPERR_xxxx)

--- Page 78 ---

Page 78 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
6.8 Calculated measuring channels
Additional to the measured values determined by sensors, the system provides some formulas for
calculated measuring channels. The calculated values are basically calculated from physical measured
values. All physical measured valu es are transferred into a circular buffer at a fixed time base of
20 ms. This circular buffer has 128 entries. Fo r analogue channels, the integration time may be
defined.
lmc16 lmc1 lmc2 lmc3
.......Circular buffer 1 for physically measured values
cmc8 cmc1 cmc2 cmc3
.......
Data recordTransferred every 20 ms
Adjustable time base
normally 20 ms Formula1
Formula2Circular buffer for calculated valuesHardware
Transferred with System time base (e.g.. 2,5 ms)
The input values for the calculation are read from  this circular buffer, calculated by the desired
formula and transferred to the meas uring data record. This  calculation is done ev ery data refresh time,
normally 20 ms. Maximum eight calculated measuring channels are possible. They must be assigned
to one of the sixteen logical measuring channe ls. The allocation can ta ke place also after the
initialisation at run-time. A calculated measur ing channel can be deleted at any time again.
Calculated measuring channels may be  especially used for supervisions. 
At present three formulas are implemented:
1. Calculated Speed
2. Calculated speed of command signal
3. Gradient between two measure values

--- Page 79 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 79 of 145DoPE
6.8.1 DoPEConfCMcSpeed(Sync)
DoPE_HANDLE DP
unsigned short CalculatedSensorNo
unsigned short SensorNo
double IntegrationTime
double Timebase
WORD FAR                            * lpusTANFirst      (not for Sync. version)
WORD FAR                            * lpusTANLast       (not for Sync. version)
Configure calculated speed to measuring data record.
From any measuring channel spee d (the first differentiation) ma y be calculated and configured
to the data record. After it is configured, it ma y be used as the supervised channel in the
command "DoPESetCheck".
This calculated channel is not allowed as th e command channel in DoPEExts2 or DoPEFDPoti
command!
In: DP DoPE link handle
CalculatedSensorNo Sensor number for the calculated speed value
(SENSOR_4 to SENSOR_15)
SensorNo Sensor Number of the phys ical channel for speed calculation
IntegrationTime Integration time (only for analogue channels)
Timebase Time base for speed calculation (maximum 2.56 sec)
lpusTANFirst Pointer to first transaction number.
lpusTANLast Pointer to last transaction number.
Returns: Error constant (DoPERR_xxxx)
6.8.2 DoPEConfCMcCo mmandSpeed(Sync)
DoPE_HANDLE DP
unsigned short CalculatedSensorNo
double Timebase
WORD FAR                            * lpusTANFirst      (not for Sync. version)
WORD FAR                            * lpusTANLast       (not for Sync. version)
Configure calculated speed of co mmand output to data record.
Speed of command output (the first differentiation)  may be calculated and configured to the data
record. After it is configured, it may be used as the superv ised channel in the command
"DoPESetCheck".
This calculated channel is not allowed as th e command channel in DoPEExts2 or DoPEFDPoti
command!
In: DP DoPE link handle
CalculatedSensorNo Sensor number for the calculated command speed
(SENSOR_4 to SENSOR_15)
Timebase Time base for command speed calculation (maximum 2.56 sec)
lpusTANFirst Pointer to first transaction number.
lpusTANLast Pointer to last transaction number.
Returns: Error constant (DoPERR_xxxx)

--- Page 80 ---

Page 80 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
6.8.3 DoPEConfCMcGradient(Sync)
DoPE_HANDLE DP
unsigned short CalculatedSensorNo
unsigned short DividentSensorNo
unsigned short DivisorSensorNo
double IntegrationTime
double Timebase
WORD FAR                            * lpusTANFirst      (not for Sync. version)
WORD FAR                            * lpusTANLast       (not for Sync. version)
Configure calculated gradient between two measured values to measuring data record.
A gradient between two measured values may be calculated and configured to the data record.
After it is configured, it may be used as  the supervised channel in the command
"DoPESetCheck".
This calculated channel is not allowed as th e command channel in DoPEExts2 or DoPEFDPoti
command!
In: DP DoPE link handle
CalculatedSensorNo Sensor numbe r for the calculated gradient
(SENSOR_4 to SENSOR_15)
DividentSensorNo Sensor Number of the dividend
DivisorSensorNo Sensor Number of the divisor
IntegrationTime
Timebase Integration time for both dividend and divisor
(only for analogue channels)
lpusTANFirst Pointer to first transaction number.
lpusTANLast Pointer to last transaction number.
Returns: Error constant (DoPERR_xxxx)
6.8.4 DoPEClearCMc(Sync)
DoPE_HANDLE DP
unsigned short CalculatedSensorNo
WORD FAR                            * lpusTANFirst      (not for Sync. version)
WORD FAR                            * lpusTANLast       (not for Sync. version)
Clear calculated measuring channel.
In: DP DoPE link handle
CalculatedSensorNo Clear  this Sensor number
(SENSOR_4 to SENSOR_15)
lpusTANFirst Pointer to first transaction number.
lpusTANLast Pointer to last transaction number.
Returns: Error constant (DoPERR_xxxx)

--- Page 81 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 81 of 145DoPE
6.8.5 DoPEMc2Output(Sync)
DoPE_HANDLE DP
unsigned short Mode
unsigned short SensorNo
double OffsetSensor
unsigned short Output
double OffsetOutput
double Scale
WORD FAR                            *lpusTAN          (not for Sync. version)
Output of a measured value to a analogue output  channel. Any measured channel may be scaled
and via a DAC converted to a anal ogue signal. If active, the anal ogue output is calculated every
20 ms. With the Mode parameter the calc ulation of the outpu t is controlled:
MC2OUT_OFF Stop output to this analogue output channel.
MC2OUT_HIGH_PRIORITY Output of this channel every 20 ms.
MC2OUT_LOW_PRIORITY Every 20 ms only one of  the channels with this priority is 
calculated and given output.
ut OffsetOutp Scale or OffsetSens lue MeasuredVa tput AnalougeOu + − = ) *) ((
In: DP DoPE link handle
Mode Mode flag (see above)
SensorNo Sensor number
OffsetSensor Offset of Sensor
Output Number of analogue output channel
OffsetOutput Offset of output channel
Scale Scale
lpusTAN Pointer to transaction number.
Returns: Error constant (DoPERR_xxxx)

--- Page 82 ---

Page 82 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
6.8.6 DoPEConfPeakValue(Sync)
DoPE_HANDLE DP
unsigned short PositionMin
unsigned short PositionMax
unsigned short LoadMin
unsigned short LoadMax
unsigned short ExtensionMin
unsigned short ExtensionMax
WORD FAR                            * lpusTANFirst      (not for Sync. version)
WORD FAR                            * lpusTANLast       (not for Sync. version)
Configure peak values to measuring data record.
The peak values are detected by the EDC. They  may be transmitted to PC instead of an unused
measuring channel. With this command the peak values for X-head position, load and extension
may be configured to measuring channels in  the data record. SENSOR4 to SENSOR15 are
allowed to be configured as peak values. E. g. use the constant SENSOR4 for PositionMin to
configure the minimum value of X-head posit ion to SENSOR4 within the measuring data
record. Any number outside SENSOR4 to SENSOR 15 will reset the measuring channels to the
original values. Use this featur e to cancel Peak Values configur ation. This calculated channels
are not allowed as the command channe l in DoPEExts2 or DoPEFDPoti command!
In: DP DoPE link handle
PositionMin Position of Minimum value of XHead Position
PositionMax Position of Maximum value of XHead Position
LoadMin Position of Minimum value of Load
LoadMax Position of Maximum value of Load
ExtensionMin Position of Minimum value of Extension
ExtensionMax Position of Maximum value of Extension
lpusTANFirst Pointer to first transaction number.
lpusTANLast Pointer to last transaction number.
Returns: Error constant (DoPERR_xxxx)
6.8.7 DoPEPeakValueTime(Sync)
DoPE_HANDLE DP
double Time
WORD FAR                            *lpusTAN          (not for Sync. version)
Set reset time for peak value detection.
The maximum and minimum values within th is time are considered as peak values. 
In: DP DoPE link handle
Time Reset time for peak value detection
lpusTAN Pointer to transaction number.
Returns: Error constant (DoPERR_xxxx)

--- Page 83 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 83 of 145DoPE
6.9 Reference signal handling of incremental sensors
Incremental sensors like encoder or linear gauges ma y use the build in reference to set the counter-
value. Encoder have one reference pulse per revolu tion. Linear gauges have either one pulse at a
certain position, or so called distance coded references. 
Currently, DoPE supports the reference pulse  to set the counter to a certain value.
ATTENTION: The hardware interfaces mu st support this function as well!
The two channels of a 4INC-interface support this function, the X-head ch annel (X7) of EDC not.
ATTENTION: This functions are only supported by EDC60/120 systems!
6.9.1 DoPESetRefSignalMode
DoPE_HANDLE DoPEHdl
unsigned short SensorNo
unsigned short Mode
WORD FAR *lpusTAN
After the reference pulse occurred, the counte r value is stored in a Hardware register.
This command defines what to do with this value:
1. Ignore it, don’t send any message. (REFSIG_NON)
2. Send a message after every occurrence of the reference pulse. (REFSIG_ON)
3. Send a message after the next occurrence of the reference pulse. (REFSIG_ONCE)
With the message (DoPERefSignalMsg) you get the exact position of the reference pulse.
In: DoPEHdl DoPE link handle
SensorNo Sensor Number
Mode reference signal messages will be reported:
REFSIG_NON:  neverREFSIG_ON:   always
REFSIG_ONCE: only once
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
typedef  struct  DoPERefSignalMsg     /* 'Reference Signal' Message           */
  {                                   /* ------------------------------------ */
    unsigned short     MsgId;         /* ID of message                        */
    double             Time;          /* System time for the message          */
    unsigned short     SensorNo;      /* Control mode of position             */
    double             Position;      /* Position                             */
  } DoPERefSignalM;

--- Page 84 ---

Page 84 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
6.9.2 DoPESetRefSignalTare
DoPE_HANDLE DoPEHdl
unsigned short SensorNo
unsigned short Mode
double Tare
WORD FAR *lpusTAN
With this function, the processing of the next reference pulse is done in side DoPE. The reference
pulse is used to set the BasicTare-value to a certain value. The function DoPESetRefSignalMode is
not necessary. 
In: DoPEHdl DoPE link handle
SensorNo Sensor Number
Mode 1 = At the next reference signal the measuring channel
will be set to the tare value. Tare  value will be stored in EDC's
non volatile BasicTare memory.One DoPERefSignalMsg will be send.This function clears the current ba sic tare and ordinary tare value
at the next occurrence of the reference signal.
0 = Reference signals don't aff ect the measuring channel.
At the next reference signal, one DoPERefSignalMsg will be
send.
Tare Value for the measuring channel
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
6.10 Serial Sensors
6.10.1  DoPEWrSensorMsg (Sync)
DoPE_HANDLE DoPEHdl
unsigned short SensorNo
void *Buffer
unsigned Length
WORD FAR                            *lpusTAN          (not for Sync. version)
This function can be used to send a message to a serial sensor . (only EDC60/120)
The message is not interpreted by DoPE!
Maximum message length is 80 Bytes. 
In: DoPEHdl DoPE link handle
SensorNo Sensor Number 0 .. 15
*Buffer Pointer to message to transmit
Length Message length in Byte’s
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 85 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 85 of 145DoPE
7 Input / Output-Commands
7.1 Analogue output
7.1.1 DoPESetOutput(Sync)
DoPE_HANDLE DP
unsigned short Output
double Value
WORD FAR                            *lpusTAN          (not for Sync. version)
Set an analogue output channel. The output channel must be assigned in EDC set-up.
In: DoPEHdl DoPE link handle
Output Number of analogue output channel
Value New value of output channel
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
7.1.2 DoPESetOutChannelOffset (Sync)
DoPE_HANDLE DoPEHdl
unsigned short Output
double Offset
WORD FAR                            *lpusTAN          (not for Sync. version)
Set an analogue output channel offset. (only EDC60/120)
In: DoPEHdl DoPE link handle
Output Number of analogue output channel
Offset New offset value of output channel
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
7.1.3 DoPEOfflineActionOutput (Sync)
DoPE_HANDLE DP
unsigned short OutputNo
unsigned short Mode
double Value
WORD FAR                            *lpusTAN          (not for Sync. version)
Definition of an action for an in itialised analogue output channel after EDC has detected offline.
With this command, the PC-Softw are can specify the state of a ny analogue output channel, after
the communication between PC and EDC wa s disturbed or interrupted. (OFFLINE)
EDC-Software checks automatically communication with PC, and if PC does not answer for a
period of 2 Seconds, EDC regards PC to be offlin e. This may happen if the line between PC and
EDC was disconnected, or PC-Program has crashed.

--- Page 86 ---

Page 86 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
If PC-Program terminates regularly by using Do PECloseLink command, EDC will reinitialise, and
DoPEOfflineActionBitOutput  command has no effect.
In: DoPEHdl DoPE link handle
OutputNo Number of analogue output channel
If closed loop control, Output  channel 0 cannot be selected!
Mode DO_NOTHING (0): Don't m odify this digital output
USE_INIT_VALUE (1): Use Initial value from set-up after offline
USE_VALUE (2): Use defined value after offline
Value Output value used in USE_VALUE mode in % of max. value
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 87 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 87 of 145DoPE
7.2 Bit I/O-Commands
These commands can be uses to read or write digital I/O’s. 
Reading digital inputs is normally  not necessary, since all configur ed inputs are automatically read
and transferred in the measuring data record.
General digital bit outputs are set with the comm and DoPESetB. You have to assign the outputs you
use in EDC set-up. Please refer to the document “D rive of Hardware-Modules of the EDC-Family” for
definition of output devices and bits.
For dedicated output bits, DoPE s upplies dedicated functions like DoPE Beep to activate/deactivate the
beep at a EDC.
For Digital input/output bi ts that are not often used, DoPE provi des functions to read or write this
devises without having initialised it (not assigned in EDC set-up).
7.2.1 DoPESetB(Sync)
DoPE_HANDLE DP
unsigned short BitOutputNo
unsigned short SetB
unsigned short ResB
unsigned short FlashB
WORD FAR                            *lpusTAN          (not for Sync. version)
Set, Reset, Flash Bits. This command is used to  set any output bit on a di gital output device. The
devices are specified in the set-up data.
In: DoPEHdl DoPE link handle
BitOutputNo Number of bit output device
SetB These bits will be set
ResB These bits will be reset
FlashB These bits 'flash'
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
The three data words will be processed in the fo llowing sequence (important with conflicting data): 
1.) Flashing bits. 
2.) Resetting of the bits. 
3.) Setting of the bits. 
7.2.2 DoPECalOut(Sync)
DoPE_HANDLE DP
unsigned short Cal
WORD FAR                            *lpusTAN          (not for Sync. version)
Activate / deactivate calibration output on EDC. Th e calibration contact may be used to trigger a
reference measuring system during load calibration. 
In: DoPEHdl DoPE  link handle
Cal TRUE  activate Calibration output
FALSE deactivate Calibration output

--- Page 88 ---

Page 88 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
7.2.3 DoPEBeep(Sync)
DoPE_HANDLE DP
unsigned short Beep
WORD FAR                            *lpusTAN          (not for Sync. version)
Activate / deactivate beep on EDC.
In: DoPEHdl DoPE  link handle
Beep TRUE  activate Beep
FALSE deactivate Beep
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
7.2.4 DoPELed(Sync)
DoPE_HANDLE DP
unsigned short LedOn
unsigned short LedOff
unsigned short LedFlash
WORD FAR                            *lpusTAN          (not for Sync. version)
Switch On/Off LED's at EDC front panel. There are LED’s for Up, Down and Test at the
frontpanel.
In: DoPEHdl DoPE link handle
LedOn These LED's will be set
LedOff These LED's will be reset
LedFlash These LED's 'flash'
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
Constants for LED’s at frontpanel:
PE_LED_UP Bit mask for LED 'UP'
PE_LED_DOWN Bit mask for LED 'DOWN'
PE_LED_TEST Bit mask for LED 'TEST'
7.2.5 DoPEUniOut(Sync)
DoPE_HANDLE DP
unsigned short Output
WORD FAR                            *lpusTAN          (not for Sync. version)
Activate/Deactivate universal digi tal output bits at EDC100/EDC120.  The universal digital output
bits are located at X2.EDC100 offers 
four output bits, EDC120 has eight !
This digital outputs may be used for general purposes.
Attention:  If the parameter “MaIo” in EDC set-up (gener al data -> MaIo) is set to “YES”, bit 0
and 1 are not accessible by this command. In this cas e the EDC uses this two output bits to give out
the active machine set-up number.

--- Page 89 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 89 of 145DoPE
In: DoPEHdl DoPE link handle
Output Bit 0 .. 15 represen t the digital outputs.
0x0000 will reset all bits, 0x000F will set bit 0 to 3,
0x000C will reset bit 0 and 1and set bit 2 and 3)
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
7.2.6 DoPEBypass(Sync)
DoPE_HANDLE DP
unsigned short Bypass
WORD FAR                            *lpusTAN          (not for Sync. version)
Activate/Deactivate bypass output. 
In: DoPEHdl DoPE  link handle
Bypass TRUE  activates bypass output
FALSE deactivates bypass output
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
7.2.7 DoPERdBitInput
DoPE_HANDLE DP
WORD Connector
WORD  FAR *Value
Read an digital input device. This command will also work on not in itialised I/O-devices.
In: DoPEHdl DoPE  link handle
Connector Connector number, for the I/O device.
Use connector constants from header file like “CON_X1”
Value Data pointer to store result.
Returns: Error constant (DoPERR_xxxx)
7.2.8 DoPEWrBitOutput(Sync)
DoPE_HANDLE DP
WORD Connector
WORD Value
WORD FAR                            *lpusTAN          (not for Sync. version)
Write to a digital output device. This comma nd will also work on not initialised I/O-devices.
In: DoPEHdl DoPE  link handle
Connector Connector number, for the I/O device.
Use connector constants from header file like “CON_X1”
Value Data to be written to the output device.
Returns: Error constant (DoPERR_xxxx)

--- Page 90 ---

Page 90 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
7.2.9 DoPEOfflineActionBitOutput (Sync)
DoPE_HANDLE DP
unsigned short BitOutputNo
unsigned short Mode
unsigned short Value
WORD FAR                            *lpusTAN          (not for Sync. version)
Definition of an action for an initialised digita l output device after ED C has detected offline.
With this command, the PC-Software can specif y the state of any dig ital output, after the
communication between PC and EDC was disturbed or interrupted. (OFFLINE)
EDC-Software checks automatically communication with PC, and if PC does not answer for a
period of 2 Seconds, EDC regards PC to be offlin e. This may happen if the line between PC and
EDC was disconnected, or PC-Program has crashed.
If PC-Program terminates regularly by using Do PECloseLink command, EDC will reinitialise, and
DoPEOfflineActionBitOutput  command has no effect.
In: DoPEHdl DoPE link handle
BitOutputNo Number of bit output device
Mode DO_NOTHING (0): Don't m odify this digital output
USE_INIT_VALUE (1): Use Initial value from set-up after offline
USE_VALUE (2): Use defined value after offline
Value Output value used in USE_VALUE mode
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 91 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 91 of 145DoPE
7.3 Display Commands
7.3.1 DoPEDspClear(Sync)
DoPE_HANDLE DP
WORD FAR                            *lpusTAN          (not for Sync. version)
Clear LCD-display at EDC front panel
In: DoPEHdl DoPE link handle
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
7.3.2 DoPEDspHeadLine(Sync)
DoPE_HANDLE DP
char FAR *HeadLine
WORD FAR                            *lpusTAN          (not for Sync. version)
Display HeadLine on LCD-di splay at EDC front panel
In: DoPEHdl DoPE link handle
HeadLine Character string
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 92 ---

Page 92 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
7.3.3 DoPEDspFKeys(Sync)
DoPE_HANDLE DP
char FAR *FKeys
WORD FAR                            *lpusTAN          (not for Sync. version)
Display function keys on LCD- display at EDC front panel
In: DoPEHdl DoPE link handle
FKeys Character string
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
7.3.4 DoPEDspMValue(Sync)
DoPE_HANDLE DP
char FAR *Value1
char FAR *Value2
char FAR *Dim1
char FAR *Dim2
WORD FAR                            *lpusTAN          (not for Sync. version)
Display data and dimensions on LCD-display at EDC front panel
In: DoPEHdl DoPE link handle
Value1 Character string for first value
Value2 Character string for second value
Dim1 Character string for first dimension
Dim2 Character string for second dimension
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
7.3.5 DoPEDspBeamScreen(Sync)
DoPE_HANDLE DP
short Value
WORD FAR                            *lpusTAN          (not for Sync. version)
Display frame and beam on LCD-display at EDC front panel.
In: DoPEHdl DoPE link handle
Value Value of the beam in %
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 93 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 93 of 145DoPE
7.3.6 DoPEDspBeam Value(Sync)
DoPE_HANDLE DP
short Value
WORD FAR                            *lpusTAN          (not for Sync. version)
Display beam on LCD-display at EDC front panel.
In: DoPEHdl DoPE link handle
Value Value of the beam in %
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 94 ---

Page 94 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
8 Movement commands
8.1 Halt commands
HALT is understood as a deceleration from current sp eed to speed zero. This is done by the build in
position generator. If not specified by the halt comm and default deceleration will be used. The final
destination position cannot be specified, it depends on current speed and deceleration.
In case nominal speed is not correctly defined and the controller error is set to high values or its action
is set to state, there might be a remarkable difference between command value and actual position.
After a halt command the machine will still move  until the actual value reaches the command value.
t Halt command
SHalt commandActual
positionCommand
position
Actual
positionCommand
position
Halt commandfinal position
after SHaltfinal position
after Halts
F
∆lCorrect nominal speed Nominal speed too high
8.1.1 DoPEHalt(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl

--- Page 95 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 95 of 145DoPE
WORD  FAR *lpusTAN
Halt movement of cross-head in the specified control mode. Default deceleration will be used.
After cross-head is halted, message will be transmitted. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for halt 
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 96 ---

Page 96 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
8.1.2 DoPEHalt_A(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Dec
WORD  FAR *lpusTAN
Halt movement of cross-head in the specified co ntrol mode. Deceleration is a parameter of the
command. After cross-head is halted, message will be transmitted. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for halt 
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Dec Deceleration
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
8.1.3 DoPEHaltW(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Delay
WORD  FAR *lpusTAN
Halt movement of cross-head in the specified control mode. Default deceleration will be used.
After cross-head is halted and the specified delay time is over a message will be transmitted. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for halt
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Delay Delay time
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 97 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 97 of 145DoPE
8.1.4 DoPEHaltW_A(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Dec
double Delay
WORD  FAR *lpusTAN
Halt movement of cross-head in the specified co ntrol mode. Deceleration is a parameter of the
command. After cross-head is halted and the sp ecified delay time is over a message will be
transmitted. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for halt
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Dec Deceleration
Delay Delay time
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
8.1.5 DoPESHalt(Sync)
DoPE_HANDLE DP
WORD  FAR *lpusTAN
Halt movement of cross-head in position contro l mode. Instant start of deceleration (command
value = measured value). Default deceleration wi ll be used. After cross-head is halted, message
will be transmitted.
In: DoPEHdl DoPE link handle
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 98 ---

Page 98 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
8.2 Simple position commands
Simple positioning commands move e.g. in cross he ad position control to a new cross head position.
The Movement Control Type is equal to the destination type.
tCommand
position
Actual
position
AccelerationDeceleration
Constant s peedDestinations
F
∆l
8.2.1 DoPEPos(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Speed
double Destination
WORD  FAR *lpusTAN
Move cross-head in the specified control mode  and speed to the given destination. Default
acceleration and deceleration will be used. After destination has been reached, a message will be
transmitted. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for positioning
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Speed Speed for positioning
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 99 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 99 of 145DoPE
8.2.2 DoPEPos_A(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Acc
double Speed
double Dec
double Destination
WORD  FAR *lpusTAN
Move cross-head in the specified control mode a nd speed to the given destination. Acceleration and
deceleration are parameters of the command. Afte r destination has been reached, a message will be
transmitted. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for positioning
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Acc Acceleration
Speed Speed for positioning
Dec Deceleration
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 100 ---

Page 100 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
8.3 Approach of an external destination position
This commands move e.g. in cross-head position c ontrol to a certain load or extension (destination).
Control mode in not changed after reaching the destination. That is why it is not possible to position
exactly to the destination position.
tCommand
position
“s”
Actual
position
“s”Destination “F”s
F
∆l
8.3.1 DoPEPosG1(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Speed
double Limit
unsigned short DestCtrl
double Destination
WORD  FAR *lpusTAN
Move cross-head in the specified control mode a nd speed to the given destination. Destination must
be different to move control. Default accelerati on and deceleration will be  used. After destination
or the absolute limit position has been reached a message will be transmitted. This command will
not change control mode after the destination is reached. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for positioning
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Speed Speed for positioning
Limit absolute limit position
DestCtrl Channel definition for destination
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 101 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 101 of 145DoPE
8.3.2 DoPEPosG1_A(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Acc
double Speed
double DecLimit
double Limit
double DecDest
unsigned short DestCtrl
double Destination
WORD  FAR *lpusTAN
Move cross-head in the specified control mode a nd speed to the given destination. Destination may
be different to move control. Acceleration and de celeration are parameters of the command. After
destination or the absolute limit position has be en reached a message will be transmitted. This
command will not change control mode after the destination is reached. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for positioning (position, load or extension) 
Acc Acceleration
Speed Speed for positioning
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
DecLimit Decelerati on for limit position
Limit absolute limit position
DecDest Deceleration fo r final destination
DestCtrl Channel definition for destination
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 102 ---

Page 102 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
8.3.3 DoPEPosD1(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Speed
double Limit
unsigned short DestCtrl, 
double Destination
WORD  FAR *lpusTAN
Move cross-head in the specified control mode a nd speed to the given destination. Destination may
be different to move control. Default accelerati on and deceleration will be  used. After destination
or the relative limit position has been reached a message will be transmitted. This command will
not change control mode after the destination is reached. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for positioning
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Speed Speed for positioning
Limit relative limit position (e.g. current position + 10) 
DestCtrl Channel definition for destination
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 103 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 103 of 145DoPE
8.3.4 DoPEPosD1_A(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Acc
double Speed
double DecLimit
double Limit
double DecDest
unsigned short DestCtrl
double Destination
WORD  FAR *lpusTAN
Move cross-head in the specified control mode a nd speed to the given destination. Destination may
be different to move control. Acceleration and de celeration are parameters of the command. After
destination or the relative limit position has been reached a message will be transmitted. This
command will not change control mode after the destination is reached. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for positioning
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Acc Acceleration
Speed Speed for positioning
DecLimit Decelerati on for limit position
Limit relative limit position (e.g. current position + 10) 
DecDest Deceleration fo r final destination
DestCtrl Channel definition for destination
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 104 ---

Page 104 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
8.4 Positioning to an external destination position
This commands move e.g. in cross-head position c ontrol to a certain load or extension (destination).
Control mode in changed in time to be able to  decelerate exactly to th e destination position. 
tCommand
position
“s”
Actual
position
“s”Destination “F”s
F
∆l Change to “F”-
control
8.4.1 DoPEPosG2(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Speed
double Limit
unsigned short DestCtrl
double Destination
WORD  FAR *lpusTAN
Move cross-head in the specified control mode a nd speed to the given destination. Destination may
be different to move control. Default accelerati on and deceleration will be  used. After destination
or the absolute limit position has been reached a message will be transmitted. This command will
change control mode before the destination is reached and positions exactly. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for positioning (position, load or extension) 
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Speed Speed for positioning
Limit absolute limit position
DestCtrl Channel definition for destination
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 105 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 105 of 145DoPE
8.4.2 DoPEPosG2_A(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Acc
double Speed
double DecLimit
double Limit
unsigned short DestCtrl
double DecDest
double Destination
WORD  FAR *lpusTAN
Move cross-head in the specified control mode a nd speed to the given destination. Destination may
be different to move control. Acceleration and deceleration are parameters  of the command. After
destination or the absolute limit position has been reached a message will be transmitted. Thiscommand will change control mode before the de stination is reached and positions exactly. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for positioning
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Acc Acceleration
Speed Speed for positioning
DecLimit Decelerati on for limit position
Limit absolute limit position
DecDest Deceleration fo r final destination
DestCtrl Channel definition for destination
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 106 ---

Page 106 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
8.4.3 DoPEPosD2(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Speed
double Limit
unsigned short DestCtrl
double Destination
WORD  FAR *lpusTAN
Move cross-head in the specified control mode a nd speed to the given destination. Destination may
be different to move control. Default accelerati on and deceleration will be  used. After destination
or the relative limit position has been reached a message will be transmitted. This command will
change control mode before the destination is reached and positions exactly. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for positioning
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Speed Speed for positioning
Limit relative limit position (e.g. current position + 10) 
DestCtrl Channel definition for destination
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 107 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 107 of 145DoPE
8.4.4 DoPEPosD2_A(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Acc
double Speed
double DecLimit
double Limit
unsigned short DestCtrl
double DecDest
double Destination
WORD  FAR *lpusTAN
Move cross-head in the specified control mode a nd speed to the given destination. Destination may
be different to move control. Acceleration and de celeration are parameters of the command. After
destination or the relative limit position has been reached a message will be transmitted. This
command will change control mode before the de stination is reached and positions exactly. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for positioning (position, load or extension) 
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Acc Acceleration
Speed Speed for positioning
DecLimit Decelerati on for limit position
Limit relative limit position (e.g. current position + 10) 
DecDest Deceleration fo r final destination
DestCtrl Channel definition for destination
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 108 ---

Page 108 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
8.5 General position command to a external destination position
This commands move e.g. in cross-head position c ontrol to a certain load or extension (destination).
At destination, three di fferent modes are possible:
1. DEST_APPROACH: Halt in ‘MoveCtrl’ after destination is reached.
(like DoPEPosG1 and DoPEPosD1) 
tCommand
position
“s”
Actual
position
“s”Destination “F”s
F
∆l
2. DEST_POSITION: Change control mode to ‘DestCtrl’ and position to destination
(like DoPEPosG2, DoPEPosD2) 
tCommand
position
“s”
Actual
position
“s”Destination “F”s
F
∆l Change to “F”-
control
3. DEST_MAINTAIN: Maintain destination in ‘MoveCtr l’ e.g. keep a load constant in position
control. 
tCommand
position
“s”
Actual
position
“s”Destination “F”s
F
∆l

--- Page 109 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 109 of 145DoPE
8.5.1 DoPEPosExt(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Speed
unsigned short LimitMode
double Limit
unsigned short DestinationCtrl
double Destination
unsigned short DestinationMode
WORD  FAR *lpusTAN
Move cross-head in the specified control mode  ‘MoveCtrl’ and speed to the given destination.
‘DestinationCtrl’ may be different to ‘MoveCtrl ’. Default acceleration and deceleration will be
used.The Parameter ‘DestinationMode’ specifies how to reach destination positi on and the action after
reaching it. In case the limit positi on is reached before destination position, cross-head will be
halted in ‘MoveCtrl’ at limit position.
After destination or the limit position has been reached a message will be transmitted.
This command is not available for EDC5/25 and EDC100 !!!
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for positioning
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Speed Speed for positioning
LimitMode LIMIT_ABSOLUTE: Limit is absolute.
LIMIT_RELATIVE: Limit is a distance from the actual position.
Limit Limit position
DestinationCtrl Channel de finition for destination
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Destination Final destination
DestinationMode DEST_APPROACH: Halt in  ‘MoveCtrl’ after destination is
reached. (like DoPEPosG1, DoPEPosD1)
DEST_POSITION: Change control mode to ‘DestCtrl’ and
position to destination(like DoPEPosG2, DoPEPosD2)
DEST_MAINTAIN: Maintain destination in ‘MoveCtrl’
e.g. keep a load constant in position control.
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 110 ---

Page 110 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
8.5.2 DoPEPosExt_A(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Acc
double Speed
double DecLimit
unsigned short LimitMode
double Limit
unsigned short DestinationCtrl
double DecDestination
double Destination
unsigned short DestinationMode
WORD  FAR *lpusTAN
Move cross-head in the specified control mode  ‘MoveCtrl’ and speed to the given destination.
‘DestinationCtrl’ may be different to ‘MoveCtrl’.  The specified accelera tion and deceleration will
be used.
The Parameter ‘DestinationMode’ specifies how to reach destination positi on and the action after
reaching it. In case the limit positi on is reached before destination position, cross-head will be
halted in ‘MoveCtrl’ at limit position.After destination or the limit position has been reached a message will be transmitted.
This command is not available for EDC5/25 and EDC100 !!!
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for positioning (position, load or extension) 
Acc Acceleration
Speed Speed for positioning
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
DecLimit Decelerati on for limit position
LimitMode LIMIT_ABSOLUTE: Limit is absolute.
LIMIT_RELATIVE: Limit is a distance from the actual position.
Limit Limit position
DestinationCtrl Channel de finition for destination
DecDestination Deceleration for final destination
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Destination Final destination
DestinationMode DEST_APPROACH: Halt in  ‘MoveCtrl’ after destination is
reached.(like DoPEPosG1_A, DoPEPosD1_A)
DEST_POSITION: Change control mode to ‘DestCtrl’ and
position to destination(like DoPEPosG2_A, DoPEPosD2_A)
DEST_MAINTAIN: Maintain destination in ‘MoveCtrl’
e.g. keep a load constant in position control.
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 111 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 111 of 145DoPE
8.5.3 DoPEFMove(Sync)
DoPE_HANDLE DP
unsigned short Direction
unsigned short MoveCtrl
double Speed
WORD  FAR *lpusTAN
Move cross-head in the specified control mode  and speed UP or DOWN. As an implicit limit of
this command, softend's are used. 
In: DoPEHdl DoPE link handle
Direction Direction of movement
(MOVE_UP, MOVE_DOWN, MOVE_HALT)
MoveCtrl Control mode of movement
Speed Speed for movement
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
8.5.4 DoPEXpCont(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Limit
WORD  FAR *lpusTAN
Change control mode and continue movement in  the new control mode with the actual speed. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for movement
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Limit Limit position for movement
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 112 ---

Page 112 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
8.6 Trigger
8.6.1 DoPETrig(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Speed
double Limit
unsigned short TriggerCtrl
double Trigger
WORD  FAR *lpusTAN
Move cross-head with the specified speed to the limit position. Default acceleration and
deceleration will be used. If the trigger positi on is reached a message will be transmitted and if
used inside a combined moving sequence, the next command is activated.
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for moving
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Speed Speed for moving
Limit Absolute limit position for movement
TriggerCtrl Sensor number of trigger channel
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Trigger Position
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 113 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 113 of 145DoPE
8.6.2 DoPETrig_A(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Acc
double Speed
double Dec
double Limit
unsigned short TriggerCtrl
double Trigger
WORD  FAR *lpusTAN
Move cross-head with the specified speed to th e limit position. Acceleration and deceleration are
parameters of the command. If the trigger position is reached a message will be transmitted and ifused inside a combined moving sequence, the next command is activated.
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for moving
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Acc Acceleration
Speed Speed for moving
Dec Deceleration
Limit Absolute limit position for movement
TriggerCtrl Sensor number of trigger channel
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Trigger Position
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 114 ---

Page 114 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
8.7 Combined movement commands
8.7.1 DoPEStartCMD(Sync)
DoPE_HANDLE DP
unsigned long Cycles
unsigned short ModeFlags
WORD  FAR *lpusTAN
Start of a combined movement command. Up to  10 simple moving commands may be send after
this command to specify a complex moving sequence. 
In: DoPEHdl DoPE link handle
Cycles Repeat combined moving command this number of cycles
ModeFlags Flags (see below). Both flags may be ored.
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
Definition of ModeFlags:
CMD_DWND Supervise destination window. Next command is started after the 
actual value reaches destinati on window. Otherwise the next 
command is started, after the command value reaches it’s destination. 
CMD_MESSAGE Report intermediate destinations. For each single command a 
message is send after it was finished. Otherwise a message is send after the last command in the sequence is finished.
8.7.2 DoPEEndCMD(Sync)
DoPE_HANDLE DP
unsigned short Operation
WORD  FAR *lpusTAN
End of combined moving command. With this  command the first moving command inside this
sequence will be started. 
In: DoPEHdl DoPE link handle
Operation Start (CMD_START) or di scard (CMD_DISCARD)  the sequence
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 115 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 115 of 145DoPE
9 Complex moving commands
9.1 DoPEExt2Ctrl(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double OffsetCtrl
unsigned short SensorNo
double OffsetSensor
unsigned short Mode
double Scale
WORD  FAR *lpusTAN
Move cross-head according to an external co mmand signal. You may supply a random function to
a A/D converter and specify movement accordi ng to this random function. Scaling of the
command- and sensor-system is done by offset s and scale. Following formula is used:
() OffsetCtrl Scale or OffsetSens mmandValue externalCo Output +• − =
In: DP DoPE link handle
MoveCtrl Control mode for positioning
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
OffsetCtrl Offset for position, load or extension
SensorNo Sensor number for the external command signal
OffsetSensor Offset for external command signal
Mode various position or speed control modes (see next page)
Scale Scaling factor for external command signal:
Scale = 1 for POSITION mode:
Nominal value of external command(e.g. 10V, or 1 round of a encoder)represents one unit of the control channel(e.g. 1mm, or 1N, or 1kN)
Scale = 1 for SPEED mode:
Nominal value of external command (e.g. 10V)(e.g. 10V, or 1 round of a encoder)represents nominal speed of the control channel(e.g. 20mm/s, or 100kN/s)
Scale = 1 for OPENLOOP mode:
Nominal value of external command
(e.g. 10V, or 1 round of a encoder)represents 100% output
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 116 ---

Page 116 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
9.2  DoPEFDPoti(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double MaxSpeed
unsigned short SensorNo
unsigned short DxTrigger
unsigned short Mode
double Scale
WORD  FAR *lpusTAN
Move cross-head according to an external command signal generated by a digital encoder
(DigiPoti). This is a special version of the DoP EExt2Ctrl command. Offsets and limits are handled
inside this function.
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for movement
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
MaxSpeed Speed offset for speed controlled modes
SensorNo Sensor Number for the external command input.
Use Sensor number 9 for Digital Encoder (DigiPoti) on EDC 
frontpanel. 
DxTrigger Dead area of encoder. The Encoder has to change
the specified number of digits before the command is active.
For EDC frontpanel DigiPoti 2 or 3 is a good value. 
Mode various position or speed  control modes (see below)
Scale For EXT_POSITION Numb er of Units per revolution
e.g. Scale =  1 -> 1 mm per revolutionScale = 10 -> 10 N per revolution.For EXT_SPEED_xx Number of revolutions to nominalspeede.g. Scale = 2  -> after 2 revolutions to nominal speed.
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
Various position or speed control modes: 
The first four modes refer to measuring values . E.g. EXT_SPEED_POSITIVE moves to increasing
measuring values.
EXT_POSITION 0 Position, moves to  increasing and decreasing positions
EXT_SPEED_BIPOLAR 1 Speed bipolar  (positive and negative speed)
EXT_SPEED_POSITIVE 2 Speed positive direction
EXT_SPEED_NEGATIVE 3 Speed negative direction
The next four modes refer to movement UP/DOW N. E.g. EXT_SPEED_UP moves Cross-head UP.
The relation between measured values and move ment Up/Down is defined in the set-up data.
EXT_POS_UP_DOWN 4 Position Up / Down
EXT_SPEED_UP_DOWN 5 Speed bipolar (Up and Down)
EXT_SPEED_UP 6 Speed UP
EXT_SPEED_DOWN 7 Speed DOWN
EXT_POS_OPENLOOP 8 Position mode  for openloop configurations.

--- Page 117 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 117 of 145DoPE
9.3 DoPECycle(Sync)
s,F,dl
tDest2
Dest1
DestinationSpeed1
Speed2 Halt1Halt2
Speed
DoPE_HANDLE DP
unsigned short MoveCtrl
double Speed1
double Dest1
double Halt1
double Speed2
double Dest2
double Halt2
unsigned long Cycles
double Speed
double Destination
WORD  FAR *lpusTAN
General cycle movement. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for movement
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Speed1 Maximum speed to reach destination 1
Dest1 Destination 1
Halt1 Halt time at destination 1
Speed2 Maximum speed to reach destination 2
Dest2 Destination 2
Halt2 Halt time at destination 2
Cycles Number of cycles
Speed Speed to final destination
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 118 ---

Page 118 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
9.4 DoPECosine(Sync)
s,F,dl
tDest1
Dest2
Dest inati onSpeed1
Speed
DoPE_HANDLE DP
unsigned short MoveCtrl
double Speed1
double Dest1
double Dest2
double Frequency
unsigned long HalfCycles
double Speed
double Destination
WORD  FAR *lpusTAN
Cosine movement. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for movement
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Speed1 Maximum speed to reach destination 1
Dest1 Destination 1
Dest2 Destination 2
Frequency Frequency
HalfCycles Number of half cycles
If Zero, and a Cosine cycle is active, only Frequency, Dest1 and
Dest2 are used to modify actve Parameter!
Speed Speed to final destination
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 119 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 119 of 145DoPE
9.5 DoPECosineX(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Speed1
double Dest1
double Halt1
double Dest2
double Halt2
double Frequency
unsigned long HalfCycles
double Speed
double Destination
WORD  FAR *lpusTAN
Extended version of Cosine movement.
With this command it is possible to halt at destination 1 or 2.
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for movement
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Speed1 Maximum speed to reach destination 1
Dest1 Destination 1
Halt1 Halt time at Destination 1
Dest2 Destination 2
Halt2 Halt time at Destination 2
Frequency Frequency
HalfCycles Number of half cycles
If Zero, and a Cosine cycle is active, only Frequency, Dest1 and
Dest2 are used to modify actve Parameter!
Speed Speed to final destination
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
9.6 DoPECosineV(Sync)
DoPE_HANDLE DP
unsigned short Model
double Dest1
double Dest2
unsigned short Cycles
WORD  FAR *lpusTAN
Activate peak value control for currently active Cosine Command. The cosine command value for
the control loop will we varied (p ilot control) to keep the measur ed peaks close to the desired (peak
value control).
Modes for DoPECosineV:

--- Page 120 ---

Page 120 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
COS_PCT_AUTO1 Automatic peak value control with  Start values.
Pilot control is activated with the peak values (Destination 1
and 2). After xx cycles peak values will be automaticallycontrolled.
COS_PCT_AUTO2 Automatic peak value control without  Start offset.
Every xx cycles peak valu es will be automatically
controlled.
COS_PCT_MANUAL Manual pilot control. Dest ination 1 and 2 will be used for the
cosine function generator.
COS_PCT_KEEP Stop pilot contro l, keep the found values.
COS_PCT_CONTINUE Continue pilot cont rol, use the previously values.
COS_PCT_RESET Reset pilot control, zero values .
In: DoPEHdl DoPE link handle
Mode Mode for pilot control (see above)
Dest1 Corrected Destination 1 ( only used for COS_PCT_AUTO1 and
COS_PCT_MANUAL modes)
Dest2 Corrected Destination 2 ( only used for COS_PCT_AUTO1 and
COS_PCT_MANUAL modes)
Cycles pilot control is active every xx Cycles
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 121 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 121 of 145DoPE
9.7 DoPETriangle(Sync)
s,F,dl
tDest2
Dest1
D estinationSpeed1Speed
DoPE_HANDLE DP
unsigned short MoveCtrl
double Speed1
double Dest1
double Dest2
double Frequency
unsigned long HalfCycles
double Speed
double Destination
WORD  FAR *lpusTAN
Triangular cyclic movement. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for movement
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Speed1 Maximum speed to reach destination 1
Dest1 Destination 1
Dest2 Destination 2
Frequency Frequency
HalfCycles Number of half cycles Speed
Speed to final destination
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 122 ---

Page 122 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
9.8 DoPERectangle(Sync)
s,F,dl
tDest2
Dest1
DestinationSpeed1Speed
DoPE_HANDLE DP
unsigned short MoveCtrl
double Speed1
double Dest1
double Dest2
double Frequency
unsigned long HalfCycles
double Speed
double Destination
WORD  FAR *lpusTAN
Rectangular cyclic movement. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode for movement
(CTRL_POS, CTRL_LOAD or CTRL_EXTENSION)
Speed1 Maximum speed to reach destination 1
Dest1 Destination 1
Dest2 Destination 2
Frequency Frequency
HalfCycles Number of half cycles Speed
Speed to final destination
Destination Final destination
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 123 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 123 of 145DoPE
9.9 DoPEOffsC(Sync)
DoPE_HANDLE DP
double Speed
double PosDiff
WORD  FAR *lpusTAN
Special moving command to measure the offset of  an external, analogue speed controller. This
offset will be used for the speed output signal and compensates the offset of the external speed
controller. 
In: DoPEHdl DoPE link handle
Speed Maximum speed
PosDiff Distance to move cross-head
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 124 ---

Page 124 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
10 Synchronized movement
There are two commands to control synchronized  movement of two or more EDC120 systems.
This commands are only useful if the synchroni zation option is installed, and the two or more
EDC120 are correctly connected.
With the first command, you can synchronize time and movement, with the second command you canstart the synchronization.
ATTENTION: This function is only supported in only EDC60/120- systems
Bus-
Terminator
RS232
SlaveSlaveMaster
RS232RS232
Bus-
Terminator
10.1 DoPESynchronizeSystemMode (Sync)
DoPE_HANDLE DoPEHdl
unsigned short Mode
double Time

--- Page 125 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 125 of 145DoPE
WORD FAR                            *lpusTAN          (not for Sync. version)
Set or discard the delay time for synchronized  movement commands, or the system time for
synchronized systems. (only EDC60/120)
If Mode is SSM_SYNCMOVE, the next moving command like DoPEPos, DoPECosine or any
other moving command will be delayed until synchr onization condition is true. The systems will be
synchronized by the DoPESynchronizeSystemStart command.
In: DoPEHdl DoPE link handle
Mode SSM_SYNCMOVE: If Time is ZERO, start movement after
synchonize signal is active.If Time is not ZERO, wait Time aftersynchonize signal is active before startingthe movement.
SSM_SYSTEMTIME: Set EDC-system time to Time, after
synchonize signal is active.
SSM_DISCARD: Discard previous
DoPESynchronizeSystemMode commands.
Time Delay or system time to set with the next
DoPESynchronizeSystemStart command.
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
Example1: Two axis should do synchronized sinusoidal cycles w ith no phase shift.
EDC120 with DoPEHdl_1 is the master EDC.
/* Attention: The return code in this example is not checked!
   A real program must check the return code !!                    */
/* Set system time for both EDC to zero after synchronization started */
Error = DoPESynchronizeSystemMode (DoPEHdl_1, SSM_SYSTEMTIME, 0, &lpusTAN_1);
Error = DoPESynchronizeSystemMode (DoPEHdl_2, SSM_SYSTEMTIME, 0, &lpusTAN_2);
/* Start cosine after synchronization without delay */
Error = DoPESynchronizeSystemMode (DoPEHdl_1, SSM_SYNCMOVE, 0, &lpusTAN_1);
Error = DoPECosine  ( DoPEHdl_1, CTRL_POS, Speed1, Dest1, Dest2, Frequency, HalfCycles, Speed,
                      Destination, &lpusTAN_1);
/* Start cosine after synchronization without delay */
Error = DoPESynchronizeSystemMode (DoPEHdl_2, SSM_SYNCMOVE, 0, &lpusTAN_2);
Error = DoPECosine  ( DoPEHdl_2, CTRL_POS, Speed1, Dest1, Dest2, Frequency, HalfCycles, Speed,                      Destination, &lpusTAN_2);
/* Start synchronization at Master EDC120 */
Error = DoPESynchronizeSystemStart (DoPEHdl_1, &lpusTAN_1);
Example2: Two axis should do synchronized sinusoidal cycles w ith 90° phase shift.
EDC120 with DoPEHdl_1 is the master EDC.
/* Attention: The return code in this example is not checked!
   A real program must check the return code !!                    */
/* Set system time for both EDC to zero after synchronization started */
Error = DoPESynchronizeSystemMode (DoPEHdl_1, SSM_SYSTEMTIME, 0, &lpusTAN_1);
Error = DoPESynchronizeSystemMode (DoPEHdl_2, SSM_SYSTEMTIME, 0, &lpusTAN_2);
/* Start cosine after synchronization without delay */
Error = DoPESynchronizeSystemMode (DoPEHdl_1, SSM_SYNCMOVE, 0, &lpusTAN_1);
Error = DoPECosine  ( DoPEHdl_1, CTRL_POS, Speed1, Dest1, Dest2, Frequency, HalfCycles, Speed,
                      Destination, &lpusTAN_1);
/* Start cosine after synchronization 90° phase shift */
Error = DoPESynchronizeSystemMode (DoPEHdl_2, SSM_SYNCMOVE, 1 / (Frequency * 4), &lpusTAN_2);

--- Page 126 ---

Page 126 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
Error = DoPECosine  ( DoPEHdl_2, CTRL_POS, Speed1, Dest1, Dest2, Frequency, HalfCycles, Speed,
                      Destination, &lpusTAN_2);
/* Start synchronization at Master EDC120 */
Error = DoPESynchronizeSystemStart (DoPEHdl_1, &lpusTAN_1);
10.2 DoPESynchronizeSystemStart (Sync)
DoPE_HANDLE DoPEHdl
WORD FAR                            *lpusTAN          (not for Sync. version)
This function can only be processed on the Master-EDC120.
The digital synchronization signal will be activated, and with the next system clock, all involved
EDC120 will start the previously defined actions, set by DoPESynchronizeSystemMode.
In: DoPEHdl DoPE link handle
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 127 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 127 of 145DoPE
11 Miscellaneous Control Commands
11.1 DoPEOn(Sync)
DoPE_HANDLE DP
WORD FAR                            *lpusTAN          (not for Sync. version)
Activate drive (only for EDC5/25 and EDC60/120). On EDC100 systems the drive is activated by
the "ON" push button at the EDC100. 
In: DoPEHdl DoPE link handle
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
11.2 DoPEDefaultAcc(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Acc
WORD FAR                            *lpusTAN          (not for Sync. version)
Set default acceleration (and dece leration) for all moving commands . After initialisation default
and nominal acceleration are identical. 
In: DoPEHdl DoPE link handle
MoveCtrl Control mode (Position, Load, Extension) 
Acc Acceleration
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
11.3 DoPESpeedLimit(Sync)
DoPE_HANDLE DP
unsigned short MoveCtrl
double Speed
WORD FAR                            *lpusTAN          (not for Sync. version)
Set speed limit.
In: DoPEHdl DoPE link handle
MoveCtrl Control mode (Position, Load, Extension) 
Speed Maximum allowed speed (must be below nominal speed)
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 128 ---

Page 128 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
11.4 DoPEStop(Sync)
DoPE_HANDLE DP
unsigned short State
WORD  FAR *lpusTAN
Activate / deactivate stop state. 
In: DoPEHdl DoPE link handle
Status TRUE:  stop state (reset drive enable)
FALSE: free state (set drive enable) 
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
11.5 DoPEEmergencyMove(Sync)
DoPE_HANDLE DP
unsigned short State
WORD FAR                            *lpusTAN          (not for Sync. version)
Activate / deactivate emergency movement. Emerge ncy movement is used to move cross-head if
the hardware limit switch is act ive. (Not supported on EDC5/25) 
In: DoPEHdl DoPE link handle
State TRUE: on,  FALSE: off
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)
11.6 DoPEEmergencyOff(Sync)
DoPE_HANDLE DP
unsigned short Status
WORD FAR                            *lpusTAN          (not for Sync. version)
Activate / deactivate EmergencyOff state. 
In: DoPEHdl DoPE link handle
Status TRUE:  Activate emergency off
FALSE: Deactivate emergency off
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 129 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 129 of 145DoPE
11.7 DoPESetOpenLoopCommand(Sync)
DoPE_HANDLE DP
double Command
WORD FAR                            *lpusTAN          (not for Sync. version)
Set output value to valve. This command is only allowed in OpenLoop contro ller structure. It is
used for hydraulic machines, that operate without  a position sensor. (typi cally concrete testing
machines) With this command it is possible to move the piston up or down. The command valuewhere the piston is floating (not  moving up or down) must be determined during installation. 
In: DoPEHdl DoPE link handle
Command Output value to valve in %.
lpusTAN Pointer to Transaction-Number
Returns: Error constant (DoPERR_xxxx)

--- Page 130 ---

Page 130 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
12 Sensor EEPROM Handling
Following functions support read a nd write of sensor-EEPROM data.
ATTENTION: Use this functions very carefully.
DoPE cannot check the tota l integrity of the data!
UserScale has no effect on the Sensor EEPROM data!
These function work on initialised and not initia lised sensors. The sens ors are selected by the
connector number.
The data inside the sensor EEPRO M are divided into two sections.
The first section (DoPESen sorHeaderData), is iden tical for all sensors. 
The second section depends of the sensor class.
If you want to change data inside the sensor EEPROM, please follow the pr ocedure described below:
1. Use DoPERdSensorConKey function and check if a sensor is connected.
2. Use DoPERdSensorHeaderData function to read header data.
Analyse the sensor class!
3. For DoPESensorHeaderData.Class =SEN_A NALOGUE use DoPERdSensorAnalogueData,
for DoPESensorHeaderData.Class =S EN_INC use DoPERdSensorIncData,
for DoPESensorHeaderData.Class =SEN_ABS use DoPERdSensorAbsDatato read the sensor class specific data.
4. Modify data.Only the 
bold type  parameter in the sensor data structures are allowed to be changed!
5. Use DoPERdSensorConKey in a loop (not fast er than 100 ms) and wait until the KeyPressed
parameter is 1.
6. Use the appropriate write function to st ore the data into the sensor EEPROM.
It is not absolutely necessary to use the functi on DoPERdSensorConKey before writing data into the
sensor EEPROM.
If you don’t use it, be aware that calibration da ta may be changed, without breaking the seal at
the sensor plug!
12.1 DoPERdSensorConKey
DoPE_HANDLE DoPEHdl
WORD Connector
WORD *Connected
WORD *KeyPressed
Read sensor plug connected and key state.
In: DoPEHdl DoPE link handle
Connector Connector number of sensor
*Connected Pointer to the sensor plug connected state
(0=not connected, 1=connected)
*KeyPressed Pointer to th e sensor plug key state
(0=not pressed, 1=pressed)
Returns: Error constant (DoPERR_xxxx)

--- Page 131 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 131 of 145DoPE
12.2 DoPERdSensorHeaderData
DoPE_HANDLE DoPEHdl
WORD Connector
DoPESensorHeaderData *SenHdrData
Read sensor EEPROM data header.
In: DoPEHdl DoPE link handle
Connector Connector number of sensor
*SenHdrData Pointer to sens or data header structure
Returns: Error constant (DoPERR_xxxx)
DoPESensorHeaderData structure:
typedef struct                         /* Sensor EEPROM header data          */
{                                      /* ---------------------------------- */
  WORD   PartNo;                       /* Part indent number             [No]*/
  BYTE   Version;                      /* Part revision                  [No]*/
  DWORD  SerNo;                        /* Part serial number             [No]*/
  WORD   Class;                        /* Sensor class                   [No]*/
  BYTE   DatVersion;                   /* Version of data                [No]*/
} DoPESensorHeaderData;
/* Sensor classes                     */
                                       /* ---------------------------------- */
#define SEN_UNDEF           0          /* unknown sensor class               */
#define SEN_ANALOGUE        1          /* analogue sensor                    */
#define SEN_INC             2          /* incremental sensor                 */
#define SEN_ABS             3          /* absolute value sensor              */
                                       /* Analogue sensor types              */
                                       /* ---------------------------------- */
#define SIG_STRAINGAUGE     0          /* Strain gauge                       */
#define SIG_LVDT            1          /* LVDT                               */
#define SIG_DC              2          /* DC                                 */
                                       /* Incremental sensor types           */
                                       /* ---------------------------------- */
#define SIG_TTL             0          /* TTL Signal                         */
#define SIG_LINE            1          /* RS422 (line driver)                */
#define SIG_SINE11uA        2          /* Sine 11µA                          */
#define SIG_SINE1V          3          /* Sine 1V                            */
                                       /* Absolute value sensor types        */
                                       /* ---------------------------------- */
#define SIG_UNDEF           0          /* undefined                          */
#define SIG_TR_LT_S         1          /* TR LT-S Sensor                     */
                                       /* Transducer types                   */
                                       /* ---------------------------------- */
#define TRANSDUCER_LINEAR  0           /* Linear transducer                  */
#define TRANSDUCER_ROTARY  1           /* Rotary transducer                  */
                                       /* Reference mark types               */
                                       /* ---------------------------------- */
#define REFMARK_NON        0           /* Transducer has no reference mark   */
#define REFMARK_ONE        1           /* Transducer has one reference mark  */
#define REFMARK_DISTCODE   2           /* Transducer has distance coded      */

--- Page 132 ---

Page 132 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
12.3 DoPERdSensorAnalogueData
DoPE_HANDLE DoPEHdl
WORD Connector
DoPESensorAnalogueData *SenAnalogueData
Read analogue sensor data.
In: DoPEHdl DoPE link handle
Connector Connector number of sensor
*SenAnalogueData Pointer to analogue sensor data structure
Returns: Error constant (DoPERR_xxxx)
12.4 DoPEWrSensorAnalogueData
DoPE_HANDLE DoPEHdl
WORD Connector
DoPESensorAnalogueData *SenAnalogueData
Write analogue sensor data.
In: DoPEHdl DoPE link handle
Connector Connector number of sensor
*SenAnalogueData Pointer to analogue sensor data structure
Returns: Error constant (DoPERR_xxxx)
DoPESensorAnalogueData structure:
typedef struct                         /* Analogue sensor EEPROM data        */
{                                      /* ---------------------------------- */
  float  MaxExcitation;                /* Maximum excitation voltage      [V]*/
  WORD   MinImpedance;                 /* Impedance                     [Ohm]*/
  float  NominalValue;                 /* Nominal value of the sensor  [Unit]*/
  WORD   Unit;                         /* Unit of sensor UNIT_xxx        [No]*/
  float  Offset;                       /* Sensor offset                [Unit]*/
  WORD   NegLimit;                     /* Range limit - min.              [%]*/
  WORD   PosLimit;                     /* Range limit - max.              [%]*/
  float  Reference;                    /* Nominal value of the reference  [*]*/
  double CorrReference;                /* Corr. value of the reference   [No]*/
  WORD   Sensortype;                   /* Sensor type                        */
  double NominalSensitive;             /* Sensitivity at Nominal value    [*]*/
  WORD   Sign;                         /* Invert sign of channel        [1/0]*/
  int    Day;                          /* Date of last change            [No]*/
  int    Month;                        /* Date of last change            [No]*/
  int    Year;                         /* Date of last change            [No]*/
  WORD   LinPoint;                     /* Number of linearization steps  [No]*/
  struct LinVal
  {
    double MeasValue;                  /* Measured value               [Unit]*/
    double RefValue;                   /* Reference                    [Unit]*/
  } LinV[SEN_LIN_DATA_MAX];            /* Linearization table                */
} DoPESensorAnalogueData;

--- Page 133 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 133 of 145DoPE
12.5 DoPERdSensorIncData
DoPE_HANDLE DoPEHdl
WORD Connector
DoPESensorIncData * SenIncData
Read incremental sensor data.
In: DoPEHdl DoPE link handle
Connector Connector number of sensor
*SenIncData Pointer to incremental sensor data structure
Returns: Error constant (DoPERR_xxxx)
12.6 DoPEWrSensorIncData
DoPE_HANDLE DoPEHdl
WORD Connector
DoPESensorIncData *SenIncData
Write incremental sensor data.
In: DoPEHdl DoPE link handle
Connector Connector number of sensor
*SenIncData Pointer to incremental sensor data structure
Returns: Error constant (DoPERR_xxxx)
DoPESensorIncData structure:
typedef struct                         /* Incremental sensor EEPROM data     */
{                                      /* ---------------------------------- */
  float  Voltage1;                     /* Supply voltage 1                [V]*/
  float  Voltage2;                     /* Supply voltage 2                [V]*/
  float  Voltage3;                     /* Supply voltage 3                [V]*/
  float  Current1;                     /* Current for supply voltage 1    [A]*/
  float  Current2;                     /* Current for supply voltage 2    [A]*/
  float  Current3;                     /* Current for supply voltage 3    [A]*/
  WORD   InputSignal;                  /* Signal type at input  SIG_xxx  [No]*/
  WORD   OutputSignal;                 /* Signal type at output SIG_xxx  [No]*/
  WORD   InterpolationFactor;          /* Factor for interpolation       [No]*/
  float  MaxInputFreq;                 /* Maximum input frequency        [Hz]*/
  float  MaxOutputFreq;                /* Maximum output frequency       [Hz]*/
  WORD   TransducerType;               /* Trancducer type TRANSDUCER_xxx [No]*/
  WORD   Unit;                         /* Unit of sensor UNIT_xxx        [No]*/
  double SignalPeriod;                 /* Signal period                [Unit]*/
  double CorrFactor;                   /* Correction factor              [No]*/
  double MeasuringRange;               /* Measuring range              [Unit]*/
  WORD   SignalType;                   /* Tancducer signal type  SIG_xxx  [No]*/
  WORD   ReferenceMark;                /* Reference mark type REFMARK_xxx[No]*/
  double FirstDistance;                /* First distance of the reference[Unit]*/
  double NominalDistance;              /* Nominal distance of the reference[Unit]*/
  double Delta;                        /* Dislocation of the mean reference[Unit]*/
  float  LimitFrequency;               /* Limit frequency of the trancducer[Hz]*/
  WORD   Sign;                         /* Invert sign of channel        [1/0]*/
  BYTE   NegLimit;                     /* Range limit - min.              [%]*/
  BYTE   PosLimit;                     /* Range limit - max.              [%]*/
} DoPESensorIncData;

--- Page 134 ---

Page 134 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
12.7 DoPERdSensorAbsData
DoPE_HANDLE DoPEHdl
WORD Connector
DoPESensorAbsData *SenAbsData
Read absolute sensor data.
In: DoPEHdl DoPE link handle
Connector Connector number of sensor
*SenAbsData Pointer to absolute  value sensor data structure
Returns: Error constant (DoPERR_xxxx)
12.8 DoPEWrSensorAbsData
DoPE_HANDLE DoPEHdl
WORD Connector
DoPESensorAbsData *SenAbsData
Write absolute sensor data.
In: DoPEHdl DoPE link handle
Connector Connector number of sensor
*SenAbsData Pointer to absolute  value sensor data structure
Returns: Error constant (DoPERR_xxxx)
DoPESensorAbsData structure:
typedef struct                         /* Absolute value EEPROM header data  */
{                                      /* ---------------------------------- */
  float  Voltage1;                     /* Supply voltage 1                [V]*/
  float  Voltage2;                     /* Supply voltage 2                [V]*/
  float  Voltage3;                     /* Supply voltage 3                [V]*/
  float  Current1;                     /* Current for supply voltage 1    [A]*/
  float  Current2;                     /* Current for supply voltage 2    [A]*/
  float  Current3;                     /* Current for supply voltage 3    [A]*/
  WORD   InputSignal;                  /* Signal type at input  SIG_xxx  [No]*/
  WORD   OutputSignal;                 /* Signal type at output SIG_xxx  [No]*/
  float  MaxInputFreq;                 /* Maximum input frequency        [Hz]*/
  float  MaxOutputFreq;                /* Maximum output frequency       [Hz]*/
  BYTE   DelayTime;                    /* Sensors signal delay time       [s]*/
  WORD   Unit;                         /* Unit of sensor UNIT_xxx        [No]*/
  double SignalPeriod;                 /* Signal period                [Unit]*/
  float  Offset;                       /* Sensor offset                [Unit]*/
  double CorrFactor;                   /* Correction factor              [No]*/
  double NominalValue;                 /* Nominal value of the sensor  [Unit]*/
  WORD   SignalType;                   /* Tancducer sgnal type  SIG_xxx  [No]*/
  float  LimitFrequency;               /* Limit frequency of the trancducer[Hz]*/
  WORD   Sign;                         /* Invert sign of channel        [1/0]*/
  BYTE   NegLimit;                     /* Range limit - min.              [%]*/
  BYTE   PosLimit;                     /* Range limit - max.              [%]*/
  int    Day;                          /* Date of last change            [No]*/
  int    Month;                        /* Date of last change            [No]*/
  int    Year;                         /* Date of last change            [No]*/
} DoPESensorAbsData;

--- Page 135 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 135 of 145DoPE
13 Default measuring dada record
unsigned long Cycles Cycle counter
double Time Time from subsystem
double Position X-Head position
double Load Load 
double Extension Extension
double SensorD DigiPoti
double Sensor4 Sensor 4 measuring channel
double Sensor5 Sensor 5 measuring channel
double Sensor6 Sensor 6 measuring channel
double Sensor7 Sensor 7 measuring channel
double Sensor8 Sensor 8 measuring channel
double Sensor9 Sensor 9 measuring channel
double Sensor10 Sensor 10 measuring channel
double Sensor11 Sensor 11 measuring channel
double Sensor12 Sensor 12 measuring channel
double Sensor13 Sensor 13 measuring channel
double Sensor14 Sensor 14 measuring channel
double Sensor15 Sensor 15 measuring channel
unsigned short BitIn0 Digital input device 0
unsigned short BitIn1 Digital input device 1
unsigned short BitIn2 Digital input device 2
unsigned short BitIn3 Digital input device 3
unsigned short BitIn4 Digital input device 4
unsigned short BitIn5 Digital input device 5
unsigned short BitIn6 Digital input device 6
unsigned short BitIn7 Digital input device 7
unsigned short BitIn8 Digital input device 8
unsigned short BitIn9 Digital input device 9
unsigned short BitOut0 Digital output device 0
unsigned short BitOut1 Digital output device 1
unsigned short BitOut2 Digital output device 2
unsigned short BitOut3 Digital output device 3
unsigned short BitOut4 Digital output device 4
unsigned short BitOut5 Digital output device 5
unsigned short BitOut6 Digital output device 6
unsigned short BitOut7 Digital output device 7
unsigned short BitOut8 Digital output device 8
unsigned short BitOut9 Digital output device 9
unsigned short InSignals Logical input signals definition see 13.1
unsigned short OutSignals Logical output signals definition see 13.2
unsigned short CtrlState1 Controller status WORD 1 definition see 13.3
unsigned short CtrlState2 Controller status WORD 2 definition see 13.4
unsigned short UpperLimits Upper limits exceeded
unsigned short LowerLimits Lower limits exceeded
unsigned short SysState0 System status WORD 0
unsigned short SysState1 System status WORD 1
unsigned short SysState2 System status WORD 2
unsigned short SysState3 System status WORD 3
unsigned short SysState4 System status WORD 4
unsigned short SysState5 System status WORD 5
double Test1 Configured test value 1
double Test2 Configured test value 2
double Test3 Configured test value 3
unsigned short Keys Actual State of EDC frontpanel keys
unsigned short NewKeys New keys
unsigned short GoneKeys Gone keys

--- Page 136 ---

Page 136 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
13.1 Logical input signals
The logical input signals are safety  relevant digital inputs. They ar e configured duri ng initialisation
and one logical input signal may map to more than  one digital input. The state of the logical input
signals is maintained in the measuring dada record.
15-10  6  5  4  3  2  1  0  
Emergency Stop
Upper Limit Switch
Lower Limit Switch
Drive not Ready
Internal useS-Halt
Shield test modeEmergency Stop, driving free possible7  
8  9  
Reference switch at X-Head
Shield LockedShield Closed
Reserve10  
Emergency stop (IN_SIG_EMERGENCY_STOP):
If this signal is active, the m achine control remains in the emerge ncy stop state. Possible sources
are Limit switches, Range limit active, emer gency stop button pressed or similar safety
equipment.
Emergency stop, driving free possible (IN_SIG_EMERGENCY_STOP_FREE_POSSIBILE):
This signal also forces the machine control in to the emergency stop state, but can be masked
during an driving free movement. 
Limit switches, (IN_SIG_UPPER_LIMIT_ SWITCH IN_SIG_LOWER_LIMIT_SWITCH):
These signals also force the machine control in to the emergency stop state and can be masked
during an driving free movement. 
Drive not ready (IN_SIG_DRIVE_NOT_READY):
This signal reports the state of  the connected drive unit. If set, the drive is not ready. 
S-Halt (IN_SIG_SHALT):
The signal is especially suitable for the connection of a HALT key, the cross-head can be halted
with independently of the actual operating state.
Drive not ready (IN_SIG_REFERENCE):
This signal reports the state a re ference switch at the X-Head.
Drive not ready (IN_SIG_SHIELD_CLOSED):
This signal is set when a connect ed protective shield is closed.
Drive not ready (IN_SIG_SHIELD_LOCKED):
This signal is set when a connect ed protective shield is locked.
Drive not ready (IN_SIG_SHIELD_TEST):
This signal is set when the conne cted protective shield is in test mode. All protective shield
functions are disabled.

--- Page 137 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 137 of 145DoPE
13.2 Logical output signals
The logical output signals are digita l outputs to control the drive a nd associated devices. They are
configured during initialisation. The state of the logical output signals is maintained in the measuring
dada record.
15  14  13  12  11  10  9  8  7  6  5  4  3  2  1  0  
Internal Drive enableSoftware ready
Drive enable
Brake release
Emergency movement
Bypass
MC-Limit reachedLock Screen
OnRelay
Direction Output
reserved
reservedreservedreservedreservedreserved
Drive ON (O_SIG_DRIVE_ON):
Being in the inactive  state, this output signal should forc e the drive into its defined emergency
stop state. If the signal is active , the drive should change  after an arbitrary period of Time into
the 'Operational' state. 'Operatio nal' means, that the drive can  react upon the output signal 'Drive
Enable' (see below) without delay.
Drive enable (O_SIG_DRIVE_ENABLE):
The signal 'Drive enable' locks in the inactive stat e, or enables in the act ive state, the reaction of
the drive to changes in the cont rol variable. The change of stat e in the drive must be without
delay, that is, it must be executed within 2.5 ms. 
Brake release (O_SIG_BRAKE):
The signal 'Brake Release' is linked with the signal  'Drive Free' because of their fault levels, but
will be operated with a time shif t due to their corresponding cha nge of states. The time shift
should enable systems with mechanical brakes  to achieve a contro lled transition between
braking and position control.
Emergency movement (O_SIG_E_MOVE):
The signal 'Emergency Movement' is only act ive, as long as the Subsystem executes an
emergency movement. It can be used to deacti vate the function of the machine limit switches on
the drive system.
MC-Limit reached (O_SIG_LIMIT):
The signal ‘MC-Limit’ is used by the m easuring channel supervision activated by
DoPESetCheckLimit command.
Lock Screen (O_SIG_SH_LOCK):
The signal ‘Lock Screen’ is used by the screen (shield) supervisi on functions to lock the shield.

--- Page 138 ---

Page 138 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
13.3 Controller status WORD 1
15  14  13  12  11  10  9  8  7  6  5  4  3  2  1  0  
CTRL_FREECTRL_STATE_POS
CTRL_STATE_LOAD
CTRL_STATE_EXT
reserved
CTRL_HALT
CTRL_DOWNCTRL_UP
CTRL_MOVE (not halted)
CTRL_READY
CTRL_INIT_E
CTRL_SFTSET
reserved
SYNCH_STATEMASTER/SLAVE
CTRL_E_ACTIVE
CTRL_STATE_POS:
X-Head closed loop control is active.
CTRL_STATE_LOAD:
Load closed loop control is active.
CTRL_STATE_EXT:
Extension closed loop control is active.
CTRL_HALT:
Command value generator halts (controlled halt in S/F/E). If the set speed 0 is temporary
unstable, as for example by moving with the ex ternal command value of  0, then the status
bits CTRL_DOWN and CTRL_UP are both set instead of this bit.
CTRL_DOWN:
Command value generator moves down (in S/ F/ E).
CTRL_UP:
Command value generator moves up (in S/F/E).
CTRL_MOVE:
This bit is always set when the cross-head is not securely halted. The bit is not set with a
switched off machine and with S controlled hold ing of a position. In all other cases the bit
is set. 
CTRL_READY:
The bit is set, when the EDC accepts movement  instructions from the DoPE. It is also
particularly set, when the EDC is in the drive ready state, waiting for the start of the drive
through the first movement instruction. 
CTRL_FREE:
The EDC waits for the drive enable through the Host software or from the user.

--- Page 139 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 139 of 145DoPE
CTRL_INIT_E:
The EDC awaits the initiation of an emergency movement through the Host.
CTRL_SFTSET:
Change of softends allowed.
CTRL_E_ACTIVE:
Emergency movement is active.
13.4 Controller status WORD 2
15  14  13  12  11  10  9  8  7  6  5  4  3  2  1  0  
reservedCTRL_LOWER_SFT_S
CTRL_LOWER_SFT_F
CTRL_LOWER_SFT_E
reserved
CTRL UPPER SFT S
CTRL UPPER SFT F
CTRL_UPPER_SFT_E
reserved
reserved
reserved
reserved
CTRL_CALIBRATION
CTRL_LOWER_LIMIT
CTRL_UPPER_LIMIT
CTRL_ERROR
CTRL_LOWER_SFT_S:
Lower X-Head position softend is active.
CTRL_LOWER_SFT_F:
Lower load position softend is active.
CTRL_LOWER_SFT_E:
Lower extension positi on softend is active.
CTRL_UPPER_SFT_S:
Upper X-Head position softend is active.
CTRL_UPPER_SFT_F:
Upper load position softend is active.
CTRL_UPPER_SFT_E:
Upper extension position softend is active.
CTRL_LOWER_LIMIT, CTRL_UPPER_LIMIT:
A lower or upper range limit in X-head pos ition, load or extension is active.
CTRL_CALIBRATION:
Calibration of analogue channels is currently active.

--- Page 140 ---

Page 140 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
13.5 Definitions of EDC-front panel keys
The EDC-front panel keys are coded and transmitted in DoPE data record within three WORD's.
One WORD represents the active state of the keys, one WORD all new keys and one WORD all gone
keys. The "0"-"9", "F1" - "F3", "." and "± " keys are coded in the low BYTE in ASCII.
The "Up", "Down", "Halt" and "Dig iPoti" keys are represented as  single bits in the upper BYTE.
#define PE_KEY_HALT          0x0100    /* Bit mask for Key 'HALT'           */
#define PE_KEY_UP            0x0200    /* Bit mask for Key 'UP'             */
#define PE_KEY_DOWN          0x0400    /* Bit mask for Key 'DOWN'           */
#define PE_KEY_DPOTI         0x0800    /* Bit mask for Key 'DigiPoti'       */
#define PE_KEY_0             0x0030    /* Code for Key '0'                  */
#define PE_KEY_1             0x0031    /* Code for Key '1'                  */
#define PE_KEY_2             0x0032    /* Code for Key '2'                  */
#define PE_KEY_3             0x0033    /* Code for Key '3'                  */
#define PE_KEY_4             0x0034    /* Code for Key '4'                  */
#define PE_KEY_5             0x0035    /* Code for Key '5'                  */
#define PE_KEY_6             0x0036    /* Code for Key '6'                  */
#define PE_KEY_7             0x0037    /* Code for Key '7'                  */
#define PE_KEY_8             0x0038    /* Code for Key '8'                  */
#define PE_KEY_9             0x0039    /* Code for Key '9'                  */
#define PE_KEY_DP            0x002E    /* Code for Key '.'                  */
#define PE_KEY_SIGN          0x00F1    /* Code for Key '±'                  */
#define PE_KEY_F1            0x0041    /* Code for Key 'F1'                 */
#define PE_KEY_F2            0x0042    /* Code for Key 'F2'                 */
#define PE_KEY_F3            0x0043    /* Code for Key 'F3'                 */

--- Page 141 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 141 of 145DoPE
14 DoPE Error constants
DoPERR_NOERROR (0) No error
DoPERR_NOFLOAT (1) No float in WIN16 callback
DoPERR_SYNC (2) Synchronization to callback     failed
DoPERR_TIMEOUT (3) Timeout at await answer
DoPERR_NOFNC (4) Function not implemented
DoPERR_VERSION (5) No compatible Version EDC-DoPE
DoPERR_INIT (6) Initialisation Error Subsystem
DoPERR_PARAMETER (7) Invalid parameter
DoPERR_SETUPOPEN (8) Set-up open error
DoPERR_RTE_UNHANDLED (9) Unhandled runtime error
Command errors
DoPERR_CMD_PARCORR (1001) rror in parameter (corrected)
DoPERR_CMD_PAR (1003) Error in parm. not correctable
DoPERR_CMD_XMOVE (1004) X-Head is not halted
DoPERR_CMD_INITSEQ (1005) Sequence in init. not observed
DoPERR_CMD_NOTINIT (1006) Controller part not initialised
DoPERR_CMD_DIR (1007) Movement direction not possible
DoPERR_CMD_TMP (1008) Required resource not available
DoPERR_CMD_RUNTIME (1009) Run time error active
DoPERR_CMD_INTERN (1010) Internal error in subsystem
DoPERR_CMD_MEM (1011) Insufficient memory
DoPERR_CMD_CST (1012) Wrong controller Structure
DoPERR_CMD_MSGNO (2001) Unknown message number
DoPERR_CMD_VERSION (2003) Wrong PE interface version
DoPERR_CMD_OPEN (2004) Set-up not opened
DoPERR_CMD_MEMORY (2005) Not enough memory
Machine normalisation errors
DoPERR_PARMS (0x4001) Parameter Error 
DoPERR_ZERODIV (0x4002) Division by ZERO
DoPERR_OVFLOW (0x4003) Overflow
DoPERR_NIN (0x4004) Not Initialised
Low level communication errors
DoPERR_NODATA (0x8001) No receiver data available
DoPERR_NOBUFFER (0x8002) No transmitter buffer available
DoPERR_OFFLINE (0x8003) Connection is offline
DoPERR_HANDLE (0x8004) Invalid DoPE handle
DoPERR_MSGSIZE (0x8005) Message to long
DoPERR_NOMEM (0x8007) Not enough heap memory
DoPERR_BADPORT (0x8008) Invalid device ID
DoPERR_BAUDRATE (0x8009) Invalid baudrate
DoPERR_OPEN (0x800A) Device already in use
DoPERR_HARDWARE (0x800B) Device not present
DoPERR_NOTOPEN (0x800C) Connection not open
DoPERR_PORTLIMIT (0x800D Unused
DoPERR_NOTIMER (0x800E) No timer for timeout check
DoPERR_NODRIVER (0x800F) No driver available
DoPERR_NOTHREAD (0x8010) Win32: Thread creation failed
DoPERR_BADOS (0x8011) Not supported operating system
DoPERR_THUNK (0x8012) Win32: Thread creation failed
DoPERR_INTERNAL (-1) Internal driver error

--- Page 142 ---

Page 142 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
15 Changes Version 1 Æ 2
• New sensor unit UNIT_INC_RE V [Increments/Revolution].
• 16 measuring channels. New 'SEN SOR_xx', 'MCBIT _xx' constants.
• 16 analogue output channels . New 'OUT_xx' constants.
• 10 channel supervisions.
• New 'BIN_xx' 'BOU T_xx' constants.
• Changed 'MAX_MC', 'MAX_OC' constants.
• New constant 'SENSOR_D' for digipo ti (old digipoti was 'SENSOR_O7').
• New parameters in struct DoPESenDef: 'CtrlChannel', 'UseEeprom', Correction'.
• New parameters in struct DoPECtrlSenDef: 'Pos Td', 'PosGenTd', 'SpeedTd', 'SpeedGenTd' and
'AccK'.
• 'UpperSoftLimit', 'LowerSoftLimit'  and 'SoftLimitReaction' removed.
• New type double in struct DoPEOutChaDef for 'MaxValue','MinValue','InitValue'
• PaType removed
• Parameters removed from struct DoPE BitOutDef: 'FlashMask', 'SetMask'.
• New parameters in struct DoPEBitInDef: 'S topMask', 'StopLevel'. 'SetMask' removed.
• New parameters in struct DoPEMachineDef: 'Clampxx', 'Shieldxx'. MachineType' removed
• New parameters in struct DoPEVersion: 'PeInterfacePC', 'DpxVer'.
• Struct DoPEDPotiDef and function DoPERdDPotiDef () deleted. The digipoti has to be handled as
normal sensor. Valid parameters are: 'Connector', 'Sign', Offset', 'Scale'.
• New struct DoPEGeneralData.
• New struct DoPESetup.
• New constants for 'Mode' in DoPECosineV.
• New constants for 'CtrlState2': CT RL_UPPER_LIMIT, CTRL_LOWER_LIMIT,
• CTRL_CALIBRATION'
• Constants for 'McState' removed.
• New interface function DoPEWrSensorDef, Do PEWrCtrlSensorDef, DoPEWrOutChannelDef,
DoPEWrBitOutDef, DoPEWrBitInDef and DoPEWrMachineDef.
• New interface function DoPESetupOpen, DoPESetupClose, DoPERdSetupNumber
• New interface function DoPERdSetupAll, DopeWrSetupAll
• New interface function DoPERdLinTbl, DopeWrLinTbl
• New interface function DoPERdSysUserData, DoPEWrSysUserData
• New interface function DoPERdGeneralData, DoPEWrGeneralData
• New interface function DoPERdBitInput, DoPEWrBitOutput
• New interface function DoPECosineX, DoPECosineV
• New interface function DoPECtrlP_Xpp
• New interface function DoPEMTSpecial
• New interface function DoPECtrlPGKTd
• New interface function DoPEDspBeamScreen, DoPEDspBeamValue
• New interface function DoPESetCheckLimit, DoPEClrCheckLimit
• New interface function DoPEShieldLimit, DoPEShieldDisable, DoPEShieldLock
• New interface function DoPESpeedLimit

--- Page 143 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 143 of 145DoPE
• New error code DoPERR_SETUPOPEN
• New command error codes DoPERR_CMD_...
• New command ErrorNumber definitions CMD_ERROR_...
• New connector constants.
• DoPECtrl... K/Ti parameters change d from double to unsigned long/short
• New default measuring dada record:
• New SysStateN and additional measuri ng channels and bit input devices.
• OutChanN, BitOutN, McState, McCal, Fata lError, ErrorLevel and CtrlState removed.
• McOption1..11 renamed to SensorD, Sensor4..15
• New Events DoPEEVT_DATAOVERFLOW , DoPEEVT_ACK, DoPEEVT_NAK and
DoPEEVT_ALL
• New struct DoPECommandError and DoPEEPError definitions
• Application version string in DoPEVersi on struct changed to 13 char length.
• DoPEOffsK renamed to DoPEOffsC
• Definitions CHK_BELOW and CHK_ABOVE corrected
• New typedefinitions for messages not fitting the DoPEMCM sctructure: DoPESftM for 'Softend'
Message
• DoPEOffsCM for 'Offset-Correction' Message
• DoPECheckM for 'Measuring Channel Supervision' Message

--- Page 144 ---

Page 144 of 145 Version 2.24  (P:\DOC\DoPE\DOPE.DOC)DoPE
16 Important Changes to Version 2.21, 2.22
New function DoPEOpenLink replaces th e old function DoPEOpenConnection.
New function DoPECloseLink replaces the old function DoPECloseConnection.
It is necessary to recompile the applicatio n program before using this DoPE version.
New moving command DoPEPosExt (Sync) and DoPEPosExt_A(Sync)

--- Page 145 ---

Version 2.24  (P:\DOC\DoPE\DOPE.DOC) Page 145 of 145DoPE
17 Important Changes to Version 2.23, 2.24
• WIN16 support removed
• New constant definitions for 'MsgId ' in MOVE_CTRL_MSG: CMSG_SHIELD_ERR
• Support of serial Sensors
• New connector definitions CON_X 62A, CON_X62B, CON_X62C, CON_X62D
• DoPEWrSensorMsg(Sync)
• New message type definiti on SENSOR_MSG: DoPESensorM
• Functions to read and write Sensor EEPROM’s
• DoPERdSensorHeaderData
• DoPERdSensorAnalogueData
• DoPEWrSensorAnalogueData
• DoPERdSensorIncData
• DoPEWrSensorIncData
• DoPERdSensorAbsData
• DoPEWrSensorAbsData
• DoPERdSensorUserData
• DoPEWrSensorUserData
• DoPERdSensorConKey
• Support of reference signal of a incremental sensor
• DoPESetRefSignalMode
• DoPESetRefSignalTare
• New MOVE_CTRL_MSG message  definition CMSG_REFSIGNAL
• New MOVE_CTRL_MSG message t ype definition DoPERefSignalM
• Support of synchronized data acquisition and control
• DoPESynchronizeSystemMode(Sync)
• DoPESynchronizeSystemStart(Sync)
• New functions for controller parameter
• DoPEPosPID(Sync)
• DoPESpeedPID(Sync)
• DoPEPosFeedForward(Sync)
New DoPE functions:
• DoPECtrlTestValues
• DoPESetOutChannelOffset(Sync)
• New set-up Offset parameter in DoPEOutChaDef